

----QUIT----(28 January 2022 19:29:29) CuisUniversity-5053.image priorSource: 104232!

----STARTUP---- (28 January 2022 19:29:30) as /Users/hernan/Documents/Cuis/5.0-64Bits/Cuis-University-Installer/CuisUniversity-5053.image!


----QUIT----(28 January 2022 19:29:30) CuisUniversity-5053.image priorSource: 4200777!

----STARTUP---- (28 March 2022 17:04:54) as /home/clinux01/Cuis_University/linux64/CuisUniversity-5053.image!


ObjectBuilder create: #Verdadero
	collaboratorNames: ''
	in: 'Act1'
	!

!classDefinition: #Verdadero category: 'Act1' stamp: 'AF 3/28/2022 20:35:06'!
DenotativeObject subclass: #Verdadero
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Act1'!

!classDefinition: 'Verdadero class' category: 'Act1' stamp: 'AF 3/28/2022 20:35:06'!
Verdadero class
	instanceVariableNames: ''!

ObjectBuilder create: #VerdaderoFalsoTest
	collaboratorNames: ''
	in: 'Act1'
	!

!classDefinition: #VerdaderoFalsoTest category: 'Act1' stamp: 'AF 3/28/2022 20:35:44'!
DenotativeObject subclass: #VerdaderoFalsoTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Act1'!

!classDefinition: 'VerdaderoFalsoTest class' category: 'Act1' stamp: 'AF 3/28/2022 20:35:44'!
VerdaderoFalsoTest class
	instanceVariableNames: ''!
!VerdaderoFalsoTest class methodsFor: 'nil' stamp: 'AF 3/28/2022 20:37:19'!
test01VerdaderoNegadoEsFalso! !

!classDefinition: #Falso category: 'Act1' stamp: 'AF 3/28/2022 20:39:23'!
DenotativeObject subclass: #Falso
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Act1'!
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 20:39:21' prior: 50462966!
test01VerdaderoNegadoEsFalso
Assert that: Verdadero no isEqualTo: Falso! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:40:12'!
ERROR!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:40:12'!
ERROR!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:42:03'!
ERROR!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:42:03'!
ERROR!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:42:09'!
ERROR!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:42:09'!
ERROR!
!Verdadero class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 20:42:18'!
no
	self shouldBeImplemented.! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:42:24'!
ERROR!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:42:24'!
ERROR!

!methodRemoval: Verdadero class #no stamp: 'AF 3/28/2022 20:44:00'!
no
	self shouldBeImplemented.!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:44:07'!
ERROR!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:44:07'!
ERROR!
!Verdadero class methodsFor: 'protocol' stamp: 'AF 3/28/2022 20:44:27'!
no
	self shouldBeImplemented.! !
!Verdadero class methodsFor: 'protocol' stamp: 'AF 3/28/2022 20:47:22' prior: 50463019!
no
	^Falso.! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:47:33'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:47:40'!
PASSED!
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 20:49:24'!
test02FalsoNegadoEsVerdadero
Assert that: Falso no isEqualTo: Verdadero! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:49:26'!
ERROR!
!Falso class methodsFor: 'protocol' stamp: 'AF 3/28/2022 20:49:38'!
no
	self shouldBeImplemented.! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:49:51'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:49:51'!
ERROR!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:49:51'!
ERROR!

!methodRemoval: Falso class #no stamp: 'AF 3/28/2022 20:50:16'!
no
	self shouldBeImplemented.!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:50:22'!
ERROR!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:50:22'!
ERROR!
!Falso class methodsFor: 'protocol' stamp: 'AF 3/28/2022 20:50:30'!
no
	self shouldBeImplemented.! !
!Falso class methodsFor: 'protocol' stamp: 'AF 3/28/2022 20:50:38' prior: 50463062!
no
	^Verdadero.! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:50:40'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:50:42'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:50:42'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:50:42'!
PASSED!
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 20:53:17'!
test03VerdaderoYFalso
Assert that: Verdadero Y Falso isEqualTo: Falso! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:53:20'!
ERROR!
!Verdadero class methodsFor: 'protocol' stamp: 'AF 3/28/2022 20:53:35'!
Y
	self shouldBeImplemented.! !
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 20:55:01' prior: 50463082!
test03VerdaderoYFalso
Assert that: (Verdadero Y:Falso) isEqualTo: Falso! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:55:06'!
ERROR!
!Verdadero class methodsFor: 'protocol' stamp: 'AF 3/28/2022 20:55:11'!
Y: aFalso 
	self shouldBeImplemented.! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:55:44'!
ERROR!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:58:48'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:58:48'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:58:48'!
ERROR!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:58:48'!
ERROR!
!Verdadero class methodsFor: 'protocol' stamp: 'AF 3/28/2022 20:59:02' prior: 50463103!
Y: unBool
	^Falso.! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:59:04'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:59:06'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:59:06'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:59:06'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 20:59:06'!
PASSED!
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 20:59:33'!
test03VerdaderoYFalsoEsFalso
Assert that: (Verdadero Y:Falso) isEqualTo: Falso! !

!methodRemoval: VerdaderoFalsoTest class #test03VerdaderoYFalso stamp: 'AF 3/28/2022 20:59:33'!
test03VerdaderoYFalso
Assert that: (Verdadero Y:Falso) isEqualTo: Falso!
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:00:12'!
test04VerdaderoYVerdaderEsVerdadero
Assert that: (Verdadero Y:Verdadero) isEqualTo: Verdadero! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:00:14'!
ERROR!
!Verdadero class methodsFor: 'protocol' stamp: 'AF 3/28/2022 21:01:27' prior: 50463122!
Y: unBool
	^unBool.! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:01:29'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:01:29'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:01:29'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:01:29'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:01:29'!
PASSED!
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:04:08'!
test05FalsoYFalsoEsFalso
Assert that: (Falso Y: Falso) isEqualTo: Falso! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:04:09'!
ERROR!
!Falso class methodsFor: 'protocol' stamp: 'AF 3/28/2022 21:04:13'!
Y: aFalso 
	self shouldBeImplemented.! !
!Falso class methodsFor: 'protocol' stamp: 'AF 3/28/2022 21:04:29' prior: 50463188!
Y: unBool 
	^Falso.! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:04:30'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:04:30'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:04:30'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:04:30'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:04:30'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:04:30'!
PASSED!
!Falso class methodsFor: 'protocol' stamp: 'AF 3/28/2022 21:05:16' prior: 50463192!
Y: unBool 
	^self.! !
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:11:37'!
test06FalsoYVerdaderoEsFalso
Assert that: (Falso Y:Verdadero) isEqualTo: Falso! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:11:39'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:11:39'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:11:39'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:11:39'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:11:39'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:11:39'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:11:39'!
PASSED!
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:12:25'!
test07VerdaderoOFalsoEsVerdadero
Assert that: (Verdadero O:Falso) isEqualTo: Verdadero! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:12:29'!
ERROR!
!Verdadero class methodsFor: 'protocol' stamp: 'AF 3/28/2022 21:12:36'!
O: aFalso 
	self shouldBeImplemented.! !
!Verdadero class methodsFor: 'protocol' stamp: 'AF 3/28/2022 21:12:52' prior: 50463251!
O: unBool 
	^self.! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:12:54'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:12:54'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:12:54'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:12:54'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:12:54'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:12:54'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:12:54'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:12:54'!
PASSED!
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:14:19'!
test07VerdaderoOVerdaderoEsVerdadero
Assert that: (Verdadero O:Verdadero) isEqualTo: Verdadero! !
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:14:32'!
test08VerdaderoOVerdaderoEsVerdadero
Assert that: (Verdadero O:Verdadero) isEqualTo: Verdadero! !

!methodRemoval: VerdaderoFalsoTest class #test07VerdaderoOVerdaderoEsVerdadero stamp: 'AF 3/28/2022 21:14:32'!
test07VerdaderoOVerdaderoEsVerdadero
Assert that: (Verdadero O:Verdadero) isEqualTo: Verdadero!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:14:34'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:14:34'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:14:34'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:14:34'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:14:34'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:14:34'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:14:34'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:14:34'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:14:34'!
PASSED!
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:15:26'!
test09FalsoOFalsoEsFalso
Assert that: (Falso O: Falso) isEqualTo: Falso! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:15:27'!
ERROR!
!Falso class methodsFor: 'protocol' stamp: 'AF 3/28/2022 21:15:33'!
O: aFalso 
	self shouldBeImplemented.! !
!Falso class methodsFor: 'protocol' stamp: 'AF 3/28/2022 21:15:47' prior: 50463337!
O: unBool
	^unBool.! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:15:49'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:15:49'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:15:49'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:15:49'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:15:49'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:15:49'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:15:49'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:15:49'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:15:49'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:15:49'!
PASSED!
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:16:08'!
test10FalsoOVerdaderoEsVerdadero
Assert that: (Falso O: Falso) isEqualTo: Falso! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:16:10'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:16:10'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:16:10'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:16:10'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:16:10'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:16:10'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:16:10'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:16:10'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:16:10'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:16:10'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:16:10'!
PASSED!

!methodRemoval: Verdadero class #Y stamp: 'AF 3/28/2022 21:17:43'!
Y
	self shouldBeImplemented.!
!Falso class methodsFor: 'protocol' stamp: 'AF 3/28/2022 21:18:11'!
o: unBool
	^unBool.! !
!Verdadero class methodsFor: 'protocol' stamp: 'AF 3/28/2022 21:18:11'!
o: unBool 
	^self.! !
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:18:11' prior: 50463329!
test09FalsoOFalsoEsFalso
Assert that: (Falso o: Falso) isEqualTo: Falso! !
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:18:11' prior: 50463243!
test07VerdaderoOFalsoEsVerdadero
Assert that: (Verdadero o:Falso) isEqualTo: Verdadero! !
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:18:11' prior: 50463290!
test08VerdaderoOVerdaderoEsVerdadero
Assert that: (Verdadero o:Verdadero) isEqualTo: Verdadero! !

!methodRemoval: Falso class #O: stamp: 'AF 3/28/2022 21:18:11'!
O: unBool
	^unBool.!

!methodRemoval: Verdadero class #O: stamp: 'AF 3/28/2022 21:18:11'!
O: unBool 
	^self.!
!Falso class methodsFor: 'protocol' stamp: 'AF 3/28/2022 21:18:32'!
y: unBool 
	^self.! !
!Verdadero class methodsFor: 'protocol' stamp: 'AF 3/28/2022 21:18:32'!
y: unBool
	^unBool.! !
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:18:32' prior: 50463180!
test05FalsoYFalsoEsFalso
Assert that: (Falso y: Falso) isEqualTo: Falso! !
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:18:32' prior: 50463152!
test04VerdaderoYVerdaderEsVerdadero
Assert that: (Verdadero y:Verdadero) isEqualTo: Verdadero! !
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:18:32' prior: 50463217!
test06FalsoYVerdaderoEsFalso
Assert that: (Falso y:Verdadero) isEqualTo: Falso! !
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:18:32' prior: 50463141!
test03VerdaderoYFalsoEsFalso
Assert that: (Verdadero y:Falso) isEqualTo: Falso! !

!methodRemoval: Falso class #Y: stamp: 'AF 3/28/2022 21:18:32'!
Y: unBool 
	^self.!

!methodRemoval: Verdadero class #Y: stamp: 'AF 3/28/2022 21:18:32'!
Y: unBool
	^unBool.!
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:32:11'!
test11siVerdaderoConVerdaderoEjecutaClosure
	|a|
	a := 17! !
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:45:08' prior: 50463485!
test11siVerdaderoConVerdaderoEjecutaClosure
	|a  closure|
	a := 15.
	closure := [a := a + 2].
	(Verdadero isVerdadero:closure).
	Assert that: a isEqualTo: 17! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:45:15'!
ERROR!
!Verdadero class methodsFor: 'protocol' stamp: 'AF 3/28/2022 21:45:21'!
isVerdadero: aBlockClosure 
	self shouldBeImplemented.! !
!Verdadero class methodsFor: 'protocol' stamp: 'AF 3/28/2022 21:45:50' prior: 50463502!
isVerdadero: aClosure 
	aClosure value.! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:45:52'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:45:52'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:45:52'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:45:52'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:45:52'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:45:52'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:45:52'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:45:52'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:45:52'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:45:52'!
ERROR!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:45:52'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:45:52'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:45:52'!
ERROR!
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:47:31' prior: 50463491!
test11siVerdaderoConVerdaderoEjecutaClosure
	|ejecuteClosure  closure|
	ejecuteClosure := 'no'.
	closure := [ejecuteClosure := 'si'].
	(Verdadero isVerdadero:closure).
	Assert that: ejecuteClosure isEqualTo: 17! !
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:47:42' prior: 50463374!
test10FalsoOVerdaderoEsVerdadero
Assert that: (Falso o: Falso) isEqualTo: Falso! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:47:51'!
ERROR!
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:48:00' prior: 50463550!
test11siVerdaderoConVerdaderoEjecutaClosure
	|ejecuteClosure  closure|
	ejecuteClosure := 'no'.
	closure := [ejecuteClosure := 'si'].
	(Verdadero isVerdadero:closure).
	Assert that: ejecuteClosure isEqualTo: 'si'! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:48:02'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:48:02'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:48:02'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:48:02'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:48:02'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:48:02'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:48:02'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:48:02'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:48:02'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:48:02'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:48:02'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:48:02'!
PASSED!
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:49:17'!
test12siVerdaderoConFalsoEjecutaClosure
	|ejecuteClosure  closure|
	ejecuteClosure := 'no'.
	closure := [ejecuteClosure := 'si'].
	(Falso isVerdadero:closure).
	Assert that: ejecuteClosure isEqualTo: 'si'! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:49:19'!
ERROR!
!Falso class methodsFor: 'protocol' stamp: 'AF 3/28/2022 21:49:22'!
isVerdadero: aBlockClosure 
	self shouldBeImplemented.! !
!Falso class methodsFor: 'protocol' stamp: 'AF 3/28/2022 21:50:17' prior: 50463627!
isVerdadero: aClosure 
	.! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:50:19'!
ERROR!
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:50:30' prior: 50463615!
test12siVerdaderoConFalsoEjecutaClosure
	|ejecuteClosure  closure|
	ejecuteClosure := 'no'.
	closure := [ejecuteClosure := 'si'].
	(Falso isVerdadero:closure).
	Assert that: ejecuteClosure isEqualTo: 'no'! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:50:31'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:50:31'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:50:31'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:50:31'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:50:31'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:50:31'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:50:31'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:50:31'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:50:31'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:50:31'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:50:31'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:50:31'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:50:31'!
PASSED!
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:51:35'!
test13siFalsoConFalsoEjecutaClosure
	|ejecuteClosure  closure|
	ejecuteClosure := 'no'.
	closure := [ejecuteClosure := 'si'].
	(Falso isVerdadero:closure).
	Assert that: ejecuteClosure isEqualTo: 'si'! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:51:37'!
ERROR!
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:51:52' prior: 50463688!
test13siFalsoConFalsoEjecutaClosure
	|ejecuteClosure  closure|
	ejecuteClosure := 'no'.
	closure := [ejecuteClosure := 'si'].
	(Falso isFalso:closure).
	Assert that: ejecuteClosure isEqualTo: 'si'! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:51:54'!
ERROR!
!Falso class methodsFor: 'protocol' stamp: 'AF 3/28/2022 21:51:57'!
isFalso: aBlockClosure 
	self shouldBeImplemented.! !
!Falso class methodsFor: 'protocol' stamp: 'AF 3/28/2022 21:52:08' prior: 50463713!
isFalso: aClosure
	aClosure value.! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:09'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:09'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:09'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:09'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:09'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:09'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:09'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:09'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:09'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:09'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:09'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:09'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:09'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:09'!
PASSED!
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:52:28'!
test14siFalsoConVerdaderoEjecutaClosure
	|ejecuteClosure  closure|
	ejecuteClosure := 'no'.
	closure := [ejecuteClosure := 'si'].
	(Verdadero isFalso:closure).
	Assert that: ejecuteClosure isEqualTo: 'no'! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:30'!
ERROR!
!Verdadero class methodsFor: 'protocol' stamp: 'AF 3/28/2022 21:52:33'!
isFalso: aBlockClosure 
	self shouldBeImplemented.! !
!Verdadero class methodsFor: 'protocol' stamp: 'AF 3/28/2022 21:52:37' prior: 50463776!
isFalso: aBlockClosure 
	.! !

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:38'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:38'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:38'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:38'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:38'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:38'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:38'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:38'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:38'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:38'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:38'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:38'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:38'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:38'!
PASSED!

!testRun: #DenotativeObjectTestCase #performRealTest stamp: 'AF 3/28/2022 21:52:38'!
PASSED!
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:52:50'!
test14siFalsoConVerdaderoNoEjecutaClosure
	|ejecuteClosure  closure|
	ejecuteClosure := 'no'.
	closure := [ejecuteClosure := 'si'].
	(Verdadero isFalso:closure).
	Assert that: ejecuteClosure isEqualTo: 'no'! !

!methodRemoval: VerdaderoFalsoTest class #test14siFalsoConVerdaderoEjecutaClosure stamp: 'AF 3/28/2022 21:52:50'!
test14siFalsoConVerdaderoEjecutaClosure
	|ejecuteClosure  closure|
	ejecuteClosure := 'no'.
	closure := [ejecuteClosure := 'si'].
	(Verdadero isFalso:closure).
	Assert that: ejecuteClosure isEqualTo: 'no'!
!VerdaderoFalsoTest class methodsFor: 'as yet unclassified' stamp: 'AF 3/28/2022 21:53:00'!
test12siVerdaderoConFalsoNoEjecutaClosure
	|ejecuteClosure  closure|
	ejecuteClosure := 'no'.
	closure := [ejecuteClosure := 'si'].
	(Falso isVerdadero:closure).
	Assert that: ejecuteClosure isEqualTo: 'no'! !

!methodRemoval: VerdaderoFalsoTest class #test12siVerdaderoConFalsoEjecutaClosure stamp: 'AF 3/28/2022 21:53:00'!
test12siVerdaderoConFalsoEjecutaClosure
	|ejecuteClosure  closure|
	ejecuteClosure := 'no'.
	closure := [ejecuteClosure := 'si'].
	(Falso isVerdadero:closure).
	Assert that: ejecuteClosure isEqualTo: 'no'!

----STARTUP---- (31 March 2022 20:17:00) as /home/clinux01/Cuis_University/linux64/CuisUniversity-5053.image!


integer := 5!

integer := 5!


integer := 5!

integer := 5!

ObjectBuilder create: #I
	collaboratorNames: ''
	in: 'NumerosNaturales'
	!

!classDefinition: #I category: 'NumerosNaturales' stamp: 'LDM 3/31/2022 20:51:44'!
DenotativeObject subclass: #I
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'NumerosNaturales'!

!classDefinition: 'I class' category: 'NumerosNaturales' stamp: 'LDM 3/31/2022 20:51:44'!
I class
	instanceVariableNames: ''!

!classDefinition: #II category: 'NumerosNaturales' stamp: 'LDM 3/31/2022 20:53:47'!
DenotativeObject subclass: #II
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'NumerosNaturales'!
!I class methodsFor: 'nil' stamp: 'LDM 3/31/2022 20:53:41'!
next
	^II! !
!I class methodsFor: 'nil' stamp: 'LDM 3/31/2022 20:57:11'!
+ unNumeroNatural
	^unNumeroNatural next.! !

I + I!

II + I!
!II class methodsFor: 'Operaciones' stamp: 'LDM 3/31/2022 20:58:08'!
+ anI 
	self shouldBeImplemented.! !

II next!
!II class methodsFor: 'Operaciones' stamp: 'LDM 3/31/2022 20:59:02'!
next
	self shouldBeImplemented.! !

!classDefinition: 'II class' category: 'NumerosNaturales' stamp: 'LDM 3/31/2022 20:59:42'!
II class
	instanceVariableNames: 'next'!
!II class methodsFor: 'Operaciones' stamp: 'LDM 3/31/2022 20:59:38' prior: 50462972!
next
	next! !

 (self name) + 'I'!

(self name , 'I')!
!II class methodsFor: 'Operaciones' stamp: 'LDM 3/31/2022 21:04:32' prior: 50462980!
next
	next ifNotNil:[^next].
	next := II createChildNamed: (self name , 'I').
	next previous: self.
	^next.! !
!II class methodsFor: 'nil' stamp: 'LDM 3/31/2022 21:05:29' prior: 50462985!
next
! !

II next!

II next!

II next!

!methodRemoval: II class #next stamp: 'LDM 3/31/2022 21:07:29'!
next
!

II next!
!II class methodsFor: 'Operaciones' stamp: 'LDM 3/31/2022 21:07:37'!
next
	self shouldBeImplemented.
	^next! !
!II class methodsFor: 'Operaciones' stamp: 'LDM 3/31/2022 21:10:24' prior: 50462997!
next
	next ifNotNIl:[^next].
	next _ II createChildNamed: (self name, 'I')
	next previous: self.
	^next! !
!II class methodsFor: 'Operaciones' stamp: 'LDM 3/31/2022 21:10:47' prior: 50463001!
next
	next ifNotNIl:[^next].
	next _ II createChildNamed: (self name, 'I').
	next previous: self.
	^next! !
!II class methodsFor: 'Operaciones' stamp: 'LDM 3/31/2022 21:10:55' prior: 50463007!
next
	next ifNotNil:[^next].
	next _ II createChildNamed: (self name, 'I').
	next previous: self.
	^next! !
!II class methodsFor: 'nil' stamp: 'LDM 3/31/2022 21:12:11'!
previous
	^I! !

II previous!

II next!

!classDefinition: #III category: 'NumerosNaturales' stamp: 'LDM 3/31/2022 21:12:50'!
II subclass: #III
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'NumerosNaturales'!

!classDefinition: 'III class' category: 'NumerosNaturales' stamp: 'LDM 3/31/2022 21:12:50'!
III class
	instanceVariableNames: ''!

!classRemoval: #III stamp: 'LDM 3/31/2022 21:13:30'!
II subclass: #III
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'NumerosNaturales'!

II next!

II next!

!classDefinition: #III category: 'NumerosNaturales' stamp: 'LDM 3/31/2022 21:16:13'!
II subclass: #III
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'NumerosNaturales'!

!classDefinition: 'III class' category: 'NumerosNaturales' stamp: 'LDM 3/31/2022 21:16:13'!
III class
	instanceVariableNames: ''!

!classRemoval: #III stamp: 'LDM 3/31/2022 21:17:22'!
II subclass: #III
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'NumerosNaturales'!

II next!

!classDefinition: #III category: 'NumerosNaturales' stamp: 'LDM 3/31/2022 21:18:35'!
II subclass: #III
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'NumerosNaturales'!

!classDefinition: 'III class' category: 'NumerosNaturales' stamp: 'LDM 3/31/2022 21:18:35'!
III class
	instanceVariableNames: ''!
!II class methodsFor: 'Operaciones' stamp: 'LDM 3/31/2022 21:18:43'!
previous: anII 
	self shouldBeImplemented.! !
!II class methodsFor: 'Operaciones' stamp: 'LDM 3/31/2022 21:21:27' prior: 50463068!
previous: unNatural 
	^unNatural.! !

II next!

III previous!

III previous !

III previous: II.!

III previous!

!methodRemoval: II class #previous stamp: 'LDM 3/31/2022 21:26:33'!
previous
	^I!

!classRemoval: #III stamp: 'LDM 3/31/2022 21:27:19'!
II subclass: #III
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'NumerosNaturales'!

!methodRemoval: II class #previous: stamp: 'LDM 3/31/2022 21:28:21'!
previous: unNatural 
	^unNatural.!

II
	collaboratorNames: 'next'
	in: 'NumerosNaturales'!

!classDefinition: #II category: 'NumerosNaturales' stamp: 'LDM 3/31/2022 21:40:00'!
DenotativeObject subclass: #II
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'NumerosNaturales'!

!classDefinition: 'II class' category: 'NumerosNaturales' stamp: 'LDM 3/31/2022 21:40:00'!
II class
	instanceVariableNames: 'next'!
!II class methodsFor: 'Operaciones' stamp: 'LDM 3/31/2022 21:40:43' prior: 50462968!
+ unNatural 
	^self previous + unNatural next ! !
!II class methodsFor: 'Operaciones' stamp: 'LDM 3/31/2022 21:43:03' prior: 50463104!
+ unNatural 
	"^self previous + unNatural next"
	^self ! !

	^self !
!II class methodsFor: 'Operaciones' stamp: 'LDM 3/31/2022 21:43:07' prior: 50463109!
+ unNatural 
	"^self previous + unNatural next"
	^self ! !
!II class methodsFor: 'Operaciones' stamp: 'LDM 3/31/2022 21:45:50'!
- unNatural
	"previous - (unNatural previous)"
	^self
	! !
!II class methodsFor: '--** private fileout/in **--' stamp: 'LDM 3/31/2022 21:54:37' overrides: 50443097!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := nil.! !

!methodRemoval: II class #initializeCollaboratorsFromFile stamp: 'LDM 3/31/2022 21:54:37'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := nil.!

----STARTUP---- (4 April 2022 20:18:04) as /home/clinux01/Cuis_University/linux64/CuisUniversity-5053.image!


----End fileIn of /home/clinux01/Cuis_University/linux64/Numeros-Naturales.st----!

I - II!

'SKERE'!

 'SKERE' !

 'SKERE' !

 'SKERE' !

 'SKERE' !

 'SKERE' !

 'SKERE' !
!I class methodsFor: 'operations' stamp: 'LDMAF 4/4/2022 20:39:46'!
* multiplicando
	^multiplicando! !

I * IIIII!
!I class methodsFor: 'operations' stamp: 'LDMAF 4/4/2022 20:46:09'!
/ divisor
	self = divisor ifTrue: [^self].
	self error: 'Uno no se puede dividir por un numero mayor'.! !
!I class methodsFor: 'operations' stamp: 'LDMAF 4/4/2022 20:46:44' prior: 50463720!
/ divisor
	self = divisor ifTrue: [^self].
	self error: 'Uno no se puede dividir por un numero mayor'.! !

ObjectBuilder create: #anObject
	collaboratorNames: ''
	in: 'Numeros-Naturales-Ejemplares'
	!

!classDefinition: #anObject category: 'Numeros-Naturales-Ejemplares' stamp: 'LDMAF 4/4/2022 20:49:41'!
DenotativeObject subclass: #anObject
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales-Ejemplares'!

!classDefinition: 'anObject class' category: 'Numeros-Naturales-Ejemplares' stamp: 'LDMAF 4/4/2022 20:49:41'!
anObject class
	instanceVariableNames: ''!

!classRemoval: #anObject stamp: 'LDMAF 4/4/2022 20:49:57'!
DenotativeObject subclass: #anObject
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales-Ejemplares'!
!II class methodsFor: 'next & previous' stamp: 'LDMAF 4/4/2022 20:52:15'!
nameOfNext

	^ 'I'! !
!II class methodsFor: 'next & previous' stamp: 'LDMAF 4/4/2022 20:52:15' prior: 50463016!
next
	next ifNotNil:[^next].
	next _ II createChildNamed: (self name , self nameOfNext).
	next previous: self.
	^next! !
!II class methodsFor: 'next & previous' stamp: 'LDMAF 4/4/2022 20:52:56' prior: 50463759!
next
	next ifNotNil:[^next].
	next _ II createChildNamed: (self nameOfNext).
	next previous: self.
	^next! !
!II class methodsFor: 'next & previous' stamp: 'LDMAF 4/4/2022 20:53:41' prior: 50463755!
nameOfNext

	^ self name , 'I'.! !
!II class methodsFor: 'next & previous' stamp: 'LDMAF 4/4/2022 20:56:16' prior: 50463773!
nameOfNext
	(self name endsWith: 'III') ifTrue: [^(self name withoutSuffix: 'III') , 'IV']
	^ self name , 'I'.! !

!classRemoval: #IIII stamp: 'LDMAF 4/4/2022 20:56:39'!
II subclass: #IIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classRemoval: #IIIII stamp: 'LDMAF 4/4/2022 20:56:42'!
II subclass: #IIIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classRemoval: #IIIIII stamp: 'LDMAF 4/4/2022 20:56:44'!
II subclass: #IIIIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classRemoval: #IIIIIII stamp: 'LDMAF 4/4/2022 20:56:46'!
II subclass: #IIIIIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classRemoval: #IIIIIIII stamp: 'LDMAF 4/4/2022 20:56:47'!
II subclass: #IIIIIIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classRemoval: #IIIIIIIII stamp: 'LDMAF 4/4/2022 20:56:48'!
II subclass: #IIIIIIIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classRemoval: #IIIIIIIIII stamp: 'LDMAF 4/4/2022 20:56:50'!
II subclass: #IIIIIIIIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classRemoval: #IIIIIIIIIII stamp: 'LDMAF 4/4/2022 20:56:51'!
II subclass: #IIIIIIIIIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classRemoval: #IIIIIIIIIIII stamp: 'LDMAF 4/4/2022 20:56:52'!
II subclass: #IIIIIIIIIIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classRemoval: #IIIIIIIIIIIII stamp: 'LDMAF 4/4/2022 20:56:53'!
II subclass: #IIIIIIIIIIIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classRemoval: #IIIIIIIIIIIIII stamp: 'LDMAF 4/4/2022 20:56:54'!
II subclass: #IIIIIIIIIIIIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classRemoval: #IIIIIIIIIIIIIII stamp: 'LDMAF 4/4/2022 20:56:55'!
II subclass: #IIIIIIIIIIIIIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classRemoval: #IIIIIIIIIIIIIIII stamp: 'LDMAF 4/4/2022 20:56:57'!
II subclass: #IIIIIIIIIIIIIIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classRemoval: #IIIIIIIIIIIIIIIII stamp: 'LDMAF 4/4/2022 20:56:58'!
II subclass: #IIIIIIIIIIIIIIIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classRemoval: #IIIIIIIIIIIIIIIIII stamp: 'LDMAF 4/4/2022 20:56:59'!
II subclass: #IIIIIIIIIIIIIIIIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classRemoval: #IIIIIIIIIIIIIIIIIII stamp: 'LDMAF 4/4/2022 20:57:00'!
II subclass: #IIIIIIIIIIIIIIIIIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classRemoval: #IIIIIIIIIIIIIIIIIIII stamp: 'LDMAF 4/4/2022 20:57:02'!
II subclass: #IIIIIIIIIIIIIIIIIIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classRemoval: #III stamp: 'LDMAF 4/4/2022 20:57:04'!
II subclass: #III
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

----SNAPSHOT----(4 April 2022 20:59:48) CuisUniversity-5053.image priorSource: 4201005!

----SNAPSHOT----(4 April 2022 20:59:51) CuisUniversity-5053.image priorSource: 4231751!
!II class methodsFor: 'operaciones' stamp: 'LDMAF 4/4/2022 21:01:00' prior: 50462999!
/ unNatural
	|continuaDividiendo|
	unNatural = I ifTrue: [^self].
	unNatural = self ifTrue: [^I].
	continuaDividiendo := unNatural > (self - unNatural).
	continuaDividiendo = True ifTrue: [^self + I + self].
	^I +  ((self - unNatural) / unNatural)! !
!II class methodsFor: 'operaciones' stamp: 'LDMAF 4/4/2022 21:01:04' prior: 50463899!
/ unNatural
	|continuaDividiendo|
	unNatural = I ifTrue: [^self].
	unNatural = self ifTrue: [^I].
	continuaDividiendo := unNatural > (self - unNatural).
	continuaDividiendo = True ifTrue: [^self + I - self].
	^I +  ((self - unNatural) / unNatural)! !

----SNAPSHOT----(4 April 2022 21:01:15) CuisUniversity-5053.image priorSource: 4231840!
!II class methodsFor: 'next & previous' stamp: 'LDMAF 4/4/2022 21:05:08' prior: 50463777!
nameOfNext
	(self name endsWith: 'III') ifTrue: [^(self name withoutSuffix: 'III') , 'IV'].
	^ self name , 'I'.! !

II + II!

!classDefinition: #AnObsoleteIV category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:05:13'!
II subclass: #AnObsoleteIV
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'AnObsoleteIV class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:05:13'!
AnObsoleteIV class
	instanceVariableNames: ''!

!classRemoval: #AnObsoleteIV stamp: 'LDMAF 4/4/2022 21:05:48'!
II subclass: #AnObsoleteIV
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

II + II !

!classDefinition: #III category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:05:54'!
II subclass: #III
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'III class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:05:54'!
III class
	instanceVariableNames: ''!

!classDefinition: #IV category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:05:54'!
II subclass: #IV
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'IV class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:05:54'!
IV class
	instanceVariableNames: ''!
!II class methodsFor: 'next & previous' stamp: 'LDMAF 4/4/2022 21:10:34' prior: 50463924!
nameOfNext
	(self name endsWith: 'III') ifTrue: [^(self name withoutSuffix: 'III') , 'IV'].
	(self name endsWith: 'IV') ifTrue: [^(self name withoutSuffix: 'IV') , 'V'].
	^ self name , 'I'.! !

II + III!

!classDefinition: #V category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:10:40'!
II subclass: #V
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'V class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:10:40'!
V class
	instanceVariableNames: ''!

V + I!

!classDefinition: #VI category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:10:48'!
II subclass: #VI
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'VI class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:10:48'!
VI class
	instanceVariableNames: ''!

III + V !

!classDefinition: #VII category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:10:57'!
II subclass: #VII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'VII class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:10:57'!
VII class
	instanceVariableNames: ''!

!classDefinition: #VIII category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:10:57'!
II subclass: #VIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'VIII class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:10:57'!
VIII class
	instanceVariableNames: ''!
!II class methodsFor: 'next & previous' stamp: 'LDMAF 4/4/2022 21:12:22' prior: 50463971!
nameOfNext
	(self name endsWith: 'III') ifTrue: [^(self name withoutSuffix: 'III') , 'IV'].
	(self name endsWith: 'IV') ifTrue: [^(self name withoutSuffix: 'IV') , 'V'].
	(self name endsWith: 'VIII') ifTrue: [^(self name withoutSuffix: 'VIII') , 'IX'].
	^ self name , 'I'.! !

V + I!

VI + I!

VII + I!

VIII + I !

!classDefinition: #VIV category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:13:24'!
II subclass: #VIV
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'VIV class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:13:24'!
VIV class
	instanceVariableNames: ''!

!classRemoval: #VIV stamp: 'LDMAF 4/4/2022 21:14:46'!
II subclass: #VIV
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

VIII!

!classDefinition: #VIV category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:16:26'!
II subclass: #VIV
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'VIV class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:16:27'!
VIV class
	instanceVariableNames: ''!

!classRemoval: #VIV stamp: 'LDMAF 4/4/2022 21:16:34'!
II subclass: #VIV
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

VIII + I!

!classDefinition: #VIV category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:17:29'!
II subclass: #VIV
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'VIV class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:17:29'!
VIV class
	instanceVariableNames: ''!

!classRemoval: #VIV stamp: 'LDMAF 4/4/2022 21:17:59'!
II subclass: #VIV
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: #VIV category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:19:05'!
II subclass: #VIV
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'VIV class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:19:05'!
VIV class
	instanceVariableNames: ''!

!classRemoval: #VIV stamp: 'LDMAF 4/4/2022 21:19:19'!
II subclass: #VIV
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

VIII next!

!classDefinition: #VIV category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:25:11'!
II subclass: #VIV
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'VIV class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:25:11'!
VIV class
	instanceVariableNames: ''!

!classRemoval: #VIV stamp: 'LDMAF 4/4/2022 21:25:20'!
II subclass: #VIV
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!
!II class methodsFor: 'operaciones' stamp: 'LDMAF 4/4/2022 21:27:55' prior: 50462990!
+ unNatural
	^self next + unNatural previous.! !

VIII next!

!classDefinition: #VIV category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:28:00'!
II subclass: #VIV
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'VIV class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:28:00'!
VIV class
	instanceVariableNames: ''!

!classRemoval: #VIV stamp: 'LDMAF 4/4/2022 21:28:07'!
II subclass: #VIV
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!
!II class methodsFor: 'next & previous' stamp: 'LDMAF 4/4/2022 21:29:11' prior: 50464024!
nameOfNext
	(self name endsWith: 'VIII') ifTrue: [^(self name withoutSuffix: 'VIII') , 'IX'].
	(self name endsWith: 'III') ifTrue: [^(self name withoutSuffix: 'III') , 'IV'].
	(self name endsWith: 'IV') ifTrue: [^(self name withoutSuffix: 'IV') , 'V'].
	^ self name , 'I'.! !

VIII next!

!classDefinition: #IX category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:29:16'!
II subclass: #IX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'IX class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:29:16'!
IX class
	instanceVariableNames: ''!
!II class methodsFor: 'next & previous' stamp: 'LDMAF 4/4/2022 21:30:46' prior: 50464142!
nameOfNext
	(self name endsWith: 'IX') ifTrue: [^(self name withoutSuffix: 'IX') , 'X'].
	(self name endsWith: 'VIII') ifTrue: [^(self name withoutSuffix: 'VIII') , 'IX'].
	(self name endsWith: 'III') ifTrue: [^(self name withoutSuffix: 'III') , 'IV'].
	(self name endsWith: 'IV') ifTrue: [^(self name withoutSuffix: 'IV') , 'V'].
	^ self name , 'I'.! !

VII + VII!

!classDefinition: #X category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:35:59'!
II subclass: #X
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'X class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:35:59'!
X class
	instanceVariableNames: ''!

!classDefinition: #XI category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:35:59'!
II subclass: #XI
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XI class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:35:59'!
XI class
	instanceVariableNames: ''!

!classDefinition: #XII category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:35:59'!
II subclass: #XII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XII class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:35:59'!
XII class
	instanceVariableNames: ''!

!classDefinition: #XIII category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:35:59'!
II subclass: #XIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XIII class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:35:59'!
XIII class
	instanceVariableNames: ''!

!classDefinition: #XIV category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:35:59'!
II subclass: #XIV
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XIV class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:35:59'!
XIV class
	instanceVariableNames: ''!

XIV next!

!classDefinition: #XV category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:36:16'!
II subclass: #XV
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XV class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:36:16'!
XV class
	instanceVariableNames: ''!

XV next!

!classDefinition: #XVI category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:36:30'!
II subclass: #XVI
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XVI class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:36:30'!
XVI class
	instanceVariableNames: ''!

XV next XVI next!

XVI !

XVI!

XVI next!

!classDefinition: #XVII category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:36:53'!
II subclass: #XVII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XVII class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:36:53'!
XVII class
	instanceVariableNames: ''!

XVII next!

!classDefinition: #XVIII category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:37:01'!
II subclass: #XVIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XVIII class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:37:01'!
XVIII class
	instanceVariableNames: ''!

XVIII next!

!classDefinition: #XIX category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:37:05'!
II subclass: #XIX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XIX class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:37:05'!
XIX class
	instanceVariableNames: ''!

XIX next!

!classDefinition: #XX category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:37:11'!
II subclass: #XX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XX class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:37:11'!
XX class
	instanceVariableNames: ''!

----SNAPSHOT----(4 April 2022 21:40:39) CuisUniversity-5053.image priorSource: 4232634!
!II class methodsFor: 'next & previous' stamp: 'LDMAF 4/4/2022 21:41:11' prior: 50464165!
nameOfNext
	(self name endsWith: 'XXXIX') ifTrue: [^(self name withoutSuffix: 'XXXIX') , 'XL'].
	(self name endsWith: 'IX') ifTrue: [^(self name withoutSuffix: 'IX') , 'X'].
	(self name endsWith: 'VIII') ifTrue: [^(self name withoutSuffix: 'VIII') , 'IX'].
	(self name endsWith: 'III') ifTrue: [^(self name withoutSuffix: 'III') , 'IV'].
	(self name endsWith: 'IV') ifTrue: [^(self name withoutSuffix: 'IV') , 'V'].
	^ self name , 'I'.! !

 XX + X!

!classDefinition: #XXI category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:22'!
II subclass: #XXI
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XXI class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:22'!
XXI class
	instanceVariableNames: ''!

!classDefinition: #XXII category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:22'!
II subclass: #XXII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XXII class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:22'!
XXII class
	instanceVariableNames: ''!

!classDefinition: #XXIII category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:22'!
II subclass: #XXIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XXIII class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:22'!
XXIII class
	instanceVariableNames: ''!

!classDefinition: #XXIV category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:22'!
II subclass: #XXIV
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XXIV class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:22'!
XXIV class
	instanceVariableNames: ''!

!classDefinition: #XXV category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:22'!
II subclass: #XXV
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XXV class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:22'!
XXV class
	instanceVariableNames: ''!

!classDefinition: #XXVI category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:22'!
II subclass: #XXVI
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XXVI class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:22'!
XXVI class
	instanceVariableNames: ''!

!classDefinition: #XXVII category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:22'!
II subclass: #XXVII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XXVII class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:22'!
XXVII class
	instanceVariableNames: ''!

!classDefinition: #XXVIII category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:22'!
II subclass: #XXVIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XXVIII class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:22'!
XXVIII class
	instanceVariableNames: ''!

!classDefinition: #XXIX category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:22'!
II subclass: #XXIX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XXIX class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:22'!
XXIX class
	instanceVariableNames: ''!

!classDefinition: #XXX category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:22'!
II subclass: #XXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XXX class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:22'!
XXX class
	instanceVariableNames: ''!

 XXX + X!

!classDefinition: #XXXI category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:44'!
II subclass: #XXXI
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XXXI class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:44'!
XXXI class
	instanceVariableNames: ''!

!classDefinition: #XXXII category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:44'!
II subclass: #XXXII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XXXII class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:44'!
XXXII class
	instanceVariableNames: ''!

!classDefinition: #XXXIII category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:44'!
II subclass: #XXXIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XXXIII class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:44'!
XXXIII class
	instanceVariableNames: ''!

!classDefinition: #XXXIV category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:44'!
II subclass: #XXXIV
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XXXIV class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:44'!
XXXIV class
	instanceVariableNames: ''!

!classDefinition: #XXXV category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:44'!
II subclass: #XXXV
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XXXV class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:44'!
XXXV class
	instanceVariableNames: ''!

!classDefinition: #XXXVI category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:44'!
II subclass: #XXXVI
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XXXVI class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:44'!
XXXVI class
	instanceVariableNames: ''!

!classDefinition: #XXXVII category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:44'!
II subclass: #XXXVII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XXXVII class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:44'!
XXXVII class
	instanceVariableNames: ''!

!classDefinition: #XXXVIII category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:44'!
II subclass: #XXXVIII
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XXXVIII class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:44'!
XXXVIII class
	instanceVariableNames: ''!

!classDefinition: #XXXIX category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:44'!
II subclass: #XXXIX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XXXIX class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:44'!
XXXIX class
	instanceVariableNames: ''!

!classDefinition: #XL category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:44'!
II subclass: #XL
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Numeros-Naturales'!

!classDefinition: 'XL class' category: 'Numeros-Naturales' stamp: 'LDMAF 4/4/2022 21:41:44'!
XL class
	instanceVariableNames: ''!
!II class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50443097!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := III.
	previous := I.! !
!III class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := IV.
	previous := II.! !
!IV class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := V.
	previous := III.! !
!IX class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := X.
	previous := VIII.! !
!V class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := VI.
	previous := IV.! !
!VI class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := VII.
	previous := V.! !
!VII class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := VIII.
	previous := VI.! !
!VIII class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := IX.
	previous := VII.! !
!X class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XI.
	previous := IX.! !
!XI class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XII.
	previous := X.! !
!XII class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XIII.
	previous := XI.! !
!XIII class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XIV.
	previous := XII.! !
!XIV class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XV.
	previous := XIII.! !
!XIX class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XX.
	previous := XVIII.! !
!XL class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := nil.
	previous := XXXIX.! !
!XV class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XVI.
	previous := XIV.! !
!XVI class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XVII.
	previous := XV.! !
!XVII class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XVIII.
	previous := XVI.! !
!XVIII class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XIX.
	previous := XVII.! !
!XX class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXI.
	previous := XIX.! !
!XXI class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXII.
	previous := XX.! !
!XXII class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXIII.
	previous := XXI.! !
!XXIII class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXIV.
	previous := XXII.! !
!XXIV class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXV.
	previous := XXIII.! !
!XXIX class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXX.
	previous := XXVIII.! !
!XXV class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXVI.
	previous := XXIV.! !
!XXVI class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXVII.
	previous := XXV.! !
!XXVII class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXVIII.
	previous := XXVI.! !
!XXVIII class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXIX.
	previous := XXVII.! !
!XXX class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXXI.
	previous := XXIX.! !
!XXXI class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXXII.
	previous := XXX.! !
!XXXII class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXXIII.
	previous := XXXI.! !
!XXXIII class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXXIV.
	previous := XXXII.! !
!XXXIV class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXXV.
	previous := XXXIII.! !
!XXXIX class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XL.
	previous := XXXVIII.! !
!XXXV class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXXVI.
	previous := XXXIV.! !
!XXXVI class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXXVII.
	previous := XXXV.! !
!XXXVII class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXXVIII.
	previous := XXXVI.! !
!XXXVIII class methodsFor: '--** private fileout/in **--' stamp: 'LDMAF 4/4/2022 21:44:58' overrides: 50464541!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXXIX.
	previous := XXXVII.! !

!methodRemoval: II class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := III.
	previous := I.!

!methodRemoval: III class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := IV.
	previous := II.!

!methodRemoval: IV class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := V.
	previous := III.!

!methodRemoval: IX class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := X.
	previous := VIII.!

!methodRemoval: V class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := VI.
	previous := IV.!

!methodRemoval: VI class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := VII.
	previous := V.!

!methodRemoval: VII class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := VIII.
	previous := VI.!

!methodRemoval: VIII class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := IX.
	previous := VII.!

!methodRemoval: X class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XI.
	previous := IX.!

!methodRemoval: XI class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XII.
	previous := X.!

!methodRemoval: XII class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XIII.
	previous := XI.!

!methodRemoval: XIII class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XIV.
	previous := XII.!

!methodRemoval: XIV class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XV.
	previous := XIII.!

!methodRemoval: XIX class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XX.
	previous := XVIII.!

!methodRemoval: XL class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := nil.
	previous := XXXIX.!

!methodRemoval: XV class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XVI.
	previous := XIV.!

!methodRemoval: XVI class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XVII.
	previous := XV.!

!methodRemoval: XVII class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XVIII.
	previous := XVI.!

!methodRemoval: XVIII class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XIX.
	previous := XVII.!

!methodRemoval: XX class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXI.
	previous := XIX.!

!methodRemoval: XXI class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXII.
	previous := XX.!

!methodRemoval: XXII class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXIII.
	previous := XXI.!

!methodRemoval: XXIII class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXIV.
	previous := XXII.!

!methodRemoval: XXIV class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXV.
	previous := XXIII.!

!methodRemoval: XXIX class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXX.
	previous := XXVIII.!

!methodRemoval: XXV class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXVI.
	previous := XXIV.!

!methodRemoval: XXVI class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXVII.
	previous := XXV.!

!methodRemoval: XXVII class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXVIII.
	previous := XXVI.!

!methodRemoval: XXVIII class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXIX.
	previous := XXVII.!

!methodRemoval: XXX class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXXI.
	previous := XXIX.!

!methodRemoval: XXXI class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXXII.
	previous := XXX.!

!methodRemoval: XXXII class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXXIII.
	previous := XXXI.!

!methodRemoval: XXXIII class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXXIV.
	previous := XXXII.!

!methodRemoval: XXXIV class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXXV.
	previous := XXXIII.!

!methodRemoval: XXXIX class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XL.
	previous := XXXVIII.!

!methodRemoval: XXXV class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXXVI.
	previous := XXXIV.!

!methodRemoval: XXXVI class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXXVII.
	previous := XXXV.!

!methodRemoval: XXXVII class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXXVIII.
	previous := XXXVI.!

!methodRemoval: XXXVIII class #initializeCollaboratorsFromFile stamp: 'LDMAF 4/4/2022 21:44:58'!
initializeCollaboratorsFromFile
	"Auto generated method for loading purposes - Do not modify it"

	next := XXXIX.
	previous := XXXVII.!

----STARTUP---- (7 April 2022 17:17:01) as /home/clinux01/Cuis_University/linux64/CuisUniversity-5053.image!


Array Superclass!

Array isArray!

Array isArray!

Array isArray!

Object subclass: #XXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Collections-Excercise'!

!classDefinition: #XXX category: 'Collections-Excercise' stamp: 'LDMAF 4/7/2022 20:27:06'!
Object subclass: #XXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Collections-Excercise'!

Object subclass: #XXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Collections-Excercise'!

!classDefinition: #XXX category: 'Collections-Excercise' stamp: 'LDMAF 4/7/2022 20:27:44'!
Object subclass: #XXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Collections-Excercise'!

Object subclass: #XXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Collections-Excercise'!

!classDefinition: #XXX category: 'Collections-Excercise' stamp: 'LDMAF 4/7/2022 20:27:46'!
Object subclass: #XXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Collections-Excercise'!

!classRemoval: #XXX stamp: 'LDMAF 4/7/2022 20:28:15'!
Object subclass: #XXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Collections-Excercise'!

Object subclass: #XXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Collection-Excercise'!

!classDefinition: #XXX category: 'Collection-Excercise' stamp: 'LDMAF 4/7/2022 20:28:45'!
Object subclass: #XXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Collection-Excercise'!

XXX!
!XXX methodsFor: 'nil' stamp: 'LDMAF 4/7/2022 20:36:04'!
findOddsPart0
	| elements index odds |
	
	elements := #(1 2 5 6  9).
	
	odds := OrderedCollection new.
	index := 1.
	
	[index <= elements size]
	
	whileTrue: [
		((elements at:index) odd) ifTrue: [odds add: (elements at: index)].
		index := index + 1.
		].
	^odds.! !

XXX findOddsPart0 !

XXX findOddsPart0 !

instance := XXX new!

XXX findOddsPart0 !

instance findOddsPart0 !
!XXX methodsFor: 'as yet unclassified' stamp: 'LDMAF 4/7/2022 20:42:37' prior: 50464359!
findOddsPart0
	| elements index odds |
	
	elements := #(1 2 5 6  9).
	
	odds := OrderedCollection new.
	index := 1.
	
	[index <= elements size]
	whileTrue: [
		((elements at:index) odd) ifTrue: [odds add: (elements at: index)].
		index := index + 1.
		].
	^odds.! !

instance findOddsPart0 !
!XXX methodsFor: 'as yet unclassified' stamp: 'LDMAF 4/7/2022 20:43:09' prior: 50464374!
findOddsPart0
	| elements index odds |
	
	elements := #(1 2 5 6  9).
	
	odds := OrderedCollection new.
	index := 1.
	
	[index <= elements size]
	whileTrue: [
		((elements at:index) odd) ifFalse: [odds add: (elements at: index)].
		index := index + 1.
		].
	^odds.! !

instance findOddsPart0 !
!XXX methodsFor: 'as yet unclassified' stamp: 'LDMAF 4/7/2022 20:43:22' prior: 50464386!
findOddsPart0
	| elements index odds |
	
	elements := #(1 2 5 6  9).
	
	odds := OrderedCollection new.
	index := 1.
	
	[index <= elements size]
	whileTrue: [
		((elements at:index) odd) ifTrue: [odds add: (elements at: index)].
		index := index + 1.
		].
	^odds.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'LDMAF 4/7/2022 20:51:58'!
findOddsPart1
	| elements odds |
	
	elements := #(1 2 5 6  9).
	
	odds := OrderedCollection new.
	
	elements do: [:each | each odd ifTrue: [odds add:each] 	].
	^odds.! !

instance findOddsPart1!

1!
!XXX methodsFor: 'as yet unclassified' stamp: 'LDMAF 4/7/2022 21:03:35'!
findOddsPart2
	| elements |
	
	elements := #(1 2 5 6  9).
	
	^ elements select: [:each | each odd]! !

instance findOddsPart2!

instance findOddsPart2!
!XXX methodsFor: 'as yet unclassified' stamp: 'LDMAF 4/7/2022 21:12:02'!
findDoubles
	| elements |
	
	elements := #(1 2 5 6  9).
	
	^ elements collect: [:each | each *2]! !

instance findDoubles !
!XXX methodsFor: 'as yet unclassified' stamp: 'LDMAF 4/7/2022 21:14:58'!
findFirstEven
	| elements |
	
	elements := #(1 2 5 6  9).
	
	^ elements detect: [:each | each odd]! !

instance findFirstEven !
!XXX methodsFor: 'as yet unclassified' stamp: 'LDMAF 4/7/2022 21:15:17' prior: 50464433!
findFirstEven
	| elements |
	
	elements := #(1 2 5 6  9).
	
	^ elements detect: [:each | each even]! !

instance findFirstEven !
!XXX methodsFor: 'as yet unclassified' stamp: 'LDMAF 4/7/2022 21:16:03' prior: 50464440!
findFirstEven
	| elements |
	
	elements := #(1 2 5 6  9).
	
	^ elements detect: [:each | each odd]! !

instance findFirstEven !
!XXX methodsFor: 'as yet unclassified' stamp: 'LDMAF 4/7/2022 21:16:11' prior: 50464447!
findFirstEven
	| elements |
	
	elements := #(1 2 5 6  9).
	
	^ elements detect: [:each | each even]! !

instance findFirstEven!
!XXX methodsFor: 'as yet unclassified' stamp: 'LDMAF 4/7/2022 21:18:03'!
findFirstEvenWithoutMatching
	| elements |
	
	elements := #(1 5  9).
	
	^ elements detect: [:each | each even]! !

instance findFirstEvenWithoutMatching !
!XXX methodsFor: 'as yet unclassified' stamp: 'LDMAF 4/7/2022 21:22:20'!
findFirstEvenWithoutMatchingReturnString
	| elements |
	
	elements := #(1 5  9).
	
	^ elements detect: [:each | each even] ifNone: 'Holis'! !

instance findFirstEvenWithoutMatchingReturnString !
!XXX methodsFor: 'as yet unclassified' stamp: 'LDMAF 4/7/2022 21:23:39' prior: 50464469!
findFirstEvenWithoutMatchingReturnString
	| elements |
	
	elements := #(1 5  9).
	
	^ elements detect: [:each | each even] ifNone: ['NONO, no encontre']! !

instance findFirstEvenWithoutMatchingReturnString !
!XXX methodsFor: 'as yet unclassified' stamp: 'LDMAF 4/7/2022 21:32:20'!
sumElementsInjecting
	| elements |
	
	elements := #(1 5 9).
	
	^ elements inject: 0 into: [:acc :each | each + acc]! !

instance sumElementsInjecting !
!XXX methodsFor: 'as yet unclassified' stamp: 'LDMAF 4/7/2022 21:32:35' prior: 50464487!
sumElementsInjecting
	| elements |
	
	elements := #(1 5 9).
	
	^ elements inject: 1 into: [:acc :each | each + acc]! !

instance sumElementsInjecting!
!XXX methodsFor: 'as yet unclassified' stamp: 'LDMAF 4/7/2022 21:32:42' prior: 50464495!
sumElementsInjecting
	| elements |
	
	elements := #(1 5 9).
	
	^ elements inject: 0 into: [:acc :each | each + acc]! !

instance sumElementsInjecting!
!XXX methodsFor: 'as yet unclassified' stamp: 'LDMAF 4/7/2022 21:34:01'!
sumElementsSum
	| elements |
	
	elements := #(1 5 9).
	
	^ elements sum! !

instance sumElementsSum !

----End fileIn of /home/clinux01/Cuis_University/linux64/Packages/TerseGuide.pck.st----!

----SNAPSHOT----(7 April 2022 21:55:40) CuisUniversity-5053.image priorSource: 4244789!

----STARTUP---- (11 April 2022 17:12:10) as /home/clinux01/Cuis_University/linux64/CuisUniversity-5053.image!


instance sumElementsSum!

instance sumElementsSum!

 15 !

 15 !

instance sumElementsSum!

self!

self sender!

instance sumElementsSum!

instance sumElementsSum!

instance sumElementsSum!

instance sumElementsSum!

 15 !

 15 !

 15 !

 15 !

 15 !

 15 !

 15 !

 15 !

 15 !

 15 !

 15 !

 15 !

1!

'hola'!

verdadero = True new!

verdadero = True new!

verdadero = True new!

verdadero = False new!

----STARTUP---- (21 April 2022 17:05:56) as /home/clinux01/Cuis_University/linux64/CuisUniversity-5053.image!


----End fileIn of /home/clinux01/Cuis_University/linux64/Numero-Exercise.st----!

!testRun: #NumeroTest #test01isCeroReturnsTrueWhenAskToZero stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test02isCeroReturnsFalseWhenAskToOthersButZero stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test03isOneReturnsTrueWhenAskToOne stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test04isOneReturnsFalseWhenAskToOtherThanOne stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test05EnteroAddsWithEnteroCorrectly stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test06EnteroMultipliesWithEnteroCorrectly stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test07EnteroDividesEnteroCorrectly stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test08FraccionAddsWithFraccionCorrectly stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test09FraccionMultipliesWithFraccionCorrectly stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test10FraccionDividesFraccionCorrectly stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test11EnteroAddsFraccionCorrectly stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test12FraccionAddsEnteroCorrectly stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test13EnteroMultipliesFraccionCorrectly stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test14FraccionMultipliesEnteroCorrectly stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test15EnteroDividesFraccionCorrectly stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test16FraccionDividesEnteroCorrectly stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test17AFraccionCanBeEqualToAnEntero stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test18AparentFraccionesAreEqual stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test19AddingFraccionesCanReturnAnEntero stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test20MultiplyingFraccionesCanReturnAnEntero stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test21DividingFraccionesCanReturnAnEntero stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test22DividingEnterosCanReturnAFraccion stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test23CanNotDivideEnteroByZero stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test24CanNotDivideFraccionByZero stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test25AFraccionCanNotBeZero stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test26AFraccionCanNotBeOne stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test27EnteroSubstractsEnteroCorrectly stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test28FraccionSubstractsFraccionCorrectly stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test29EnteroSubstractsFraccionCorrectly stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test30FraccionSubstractsEnteroCorrectly stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test31SubstractingFraccionesCanReturnAnEntero stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test32SubstractingSameEnterosReturnsZero stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test33SubstractingSameFraccionesReturnsZero stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test34SubstractingAHigherValueToANumberReturnsANegativeNumber stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test35FibonacciZeroIsOne stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test36FibonacciOneIsOne stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test37FibonacciEnteroReturnsAddingPreviousTwoFibonacciEnteros stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test38FibonacciNotDefinedForNegativeNumbers stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test39NegationOfEnteroIsCorrect stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test40NegationOfFraccionIsCorrect stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test41SignIsCorrectlyAssignedToFractionWithTwoNegatives stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

!testRun: #NumeroTest #test42SignIsCorrectlyAssignedToFractionWithNegativeDivisor stamp: 'LDMAF 4/21/2022 17:10:40'!
PASSED!

a := Entero with: 5.!

a := Entero with: 5.!

a := Entero with: 5.!

b := Entero with: 6.!

a*b!

a*b/5 !

a*b/a!

a := Fraccion with: 10 over: 3.!

a := Fraccion with: 10 over: 3.!

a := Fraccion initializeWith: 10 over: 3.!

a := Fraccion with: 10 over: 3.!

a := Fraccion with: 10 over: 3.!

a := Fraccion with: 10 over: 3.!

a := Entero with: 5.!

b := Entero with: 6.!

b/a  !

b/a*a!

b/a*a*a*a!

b/a*a*a*a/b!

 b := Fraccion initializeWith: 5 over: 3!

 b := Fraccion with: 5 over: 3!

!testRun: #NumeroTest #test01isCeroReturnsTrueWhenAskToZero stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test02isCeroReturnsFalseWhenAskToOthersButZero stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test03isOneReturnsTrueWhenAskToOne stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test04isOneReturnsFalseWhenAskToOtherThanOne stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test05EnteroAddsWithEnteroCorrectly stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test06EnteroMultipliesWithEnteroCorrectly stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test07EnteroDividesEnteroCorrectly stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test08FraccionAddsWithFraccionCorrectly stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test09FraccionMultipliesWithFraccionCorrectly stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test10FraccionDividesFraccionCorrectly stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test11EnteroAddsFraccionCorrectly stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test12FraccionAddsEnteroCorrectly stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test13EnteroMultipliesFraccionCorrectly stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test14FraccionMultipliesEnteroCorrectly stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test15EnteroDividesFraccionCorrectly stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test16FraccionDividesEnteroCorrectly stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test17AFraccionCanBeEqualToAnEntero stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test18AparentFraccionesAreEqual stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test19AddingFraccionesCanReturnAnEntero stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test20MultiplyingFraccionesCanReturnAnEntero stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test21DividingFraccionesCanReturnAnEntero stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test22DividingEnterosCanReturnAFraccion stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test23CanNotDivideEnteroByZero stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test24CanNotDivideFraccionByZero stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test25AFraccionCanNotBeZero stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test26AFraccionCanNotBeOne stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test27EnteroSubstractsEnteroCorrectly stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test28FraccionSubstractsFraccionCorrectly stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test29EnteroSubstractsFraccionCorrectly stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test30FraccionSubstractsEnteroCorrectly stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test31SubstractingFraccionesCanReturnAnEntero stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test32SubstractingSameEnterosReturnsZero stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test33SubstractingSameFraccionesReturnsZero stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test34SubstractingAHigherValueToANumberReturnsANegativeNumber stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test35FibonacciZeroIsOne stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test36FibonacciOneIsOne stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test37FibonacciEnteroReturnsAddingPreviousTwoFibonacciEnteros stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test38FibonacciNotDefinedForNegativeNumbers stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test39NegationOfEnteroIsCorrect stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test40NegationOfFraccionIsCorrect stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test41SignIsCorrectlyAssignedToFractionWithTwoNegatives stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

!testRun: #NumeroTest #test42SignIsCorrectlyAssignedToFractionWithNegativeDivisor stamp: 'LDMAF 4/21/2022 20:36:44'!
PASSED!

 b := Fraccion with: (Entero with:5) over: (Entero with:3)!

a := Entero with: 4!

a*b!
!Entero methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 20:44:17' prior: 50467821 overrides: 50467751!
* aMultiplier 
	(aMultiplier isKindOf: Entero) ifTrue: [^self class with: value * aMultiplier integerValue].
	^ Fraccion with: (Entero with: (self integerValue * aMultiplier numerator)) over: (aMultiplier denominator) 
! !

a*b !
!Entero methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 20:44:34' prior: 50468400 overrides: 50467751!
* aMultiplier 
	(aMultiplier isKindOf: Entero) ifTrue: [^self class with: value * aMultiplier integerValue].
	^ Fraccion with: ((Entero with: self integerValue) * aMultiplier numerator ) over: (aMultiplier denominator)
	! !

a*b !

a*b!

!testRun: #NumeroTest #test01isCeroReturnsTrueWhenAskToZero stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test02isCeroReturnsFalseWhenAskToOthersButZero stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test03isOneReturnsTrueWhenAskToOne stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test04isOneReturnsFalseWhenAskToOtherThanOne stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test05EnteroAddsWithEnteroCorrectly stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test06EnteroMultipliesWithEnteroCorrectly stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test07EnteroDividesEnteroCorrectly stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test08FraccionAddsWithFraccionCorrectly stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test09FraccionMultipliesWithFraccionCorrectly stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test10FraccionDividesFraccionCorrectly stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test11EnteroAddsFraccionCorrectly stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test12FraccionAddsEnteroCorrectly stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test13EnteroMultipliesFraccionCorrectly stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test14FraccionMultipliesEnteroCorrectly stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test15EnteroDividesFraccionCorrectly stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test16FraccionDividesEnteroCorrectly stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test17AFraccionCanBeEqualToAnEntero stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test18AparentFraccionesAreEqual stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test19AddingFraccionesCanReturnAnEntero stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test20MultiplyingFraccionesCanReturnAnEntero stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test21DividingFraccionesCanReturnAnEntero stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test22DividingEnterosCanReturnAFraccion stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test23CanNotDivideEnteroByZero stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test24CanNotDivideFraccionByZero stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test25AFraccionCanNotBeZero stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test26AFraccionCanNotBeOne stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test27EnteroSubstractsEnteroCorrectly stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test28FraccionSubstractsFraccionCorrectly stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test29EnteroSubstractsFraccionCorrectly stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test30FraccionSubstractsEnteroCorrectly stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test31SubstractingFraccionesCanReturnAnEntero stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test32SubstractingSameEnterosReturnsZero stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test33SubstractingSameFraccionesReturnsZero stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test34SubstractingAHigherValueToANumberReturnsANegativeNumber stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test35FibonacciZeroIsOne stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test36FibonacciOneIsOne stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test37FibonacciEnteroReturnsAddingPreviousTwoFibonacciEnteros stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test38FibonacciNotDefinedForNegativeNumbers stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test39NegationOfEnteroIsCorrect stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test40NegationOfFraccionIsCorrect stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test41SignIsCorrectlyAssignedToFractionWithTwoNegatives stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!

!testRun: #NumeroTest #test42SignIsCorrectlyAssignedToFractionWithNegativeDivisor stamp: 'LDMAF 4/21/2022 20:50:15'!
PASSED!
!Entero methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 20:51:28'!
** aMultiplier 
	^aMultiplier multiplicateAEntero with: self.

	! !
!Entero methodsFor: 'nil' stamp: 'LDMAF 4/21/2022 20:55:24'!
multiplicateAEntero: aMultiplier
	^ self*aMultiplier! !

a**c!

b := Fraccion with: (Entero with:5) over: (Entero with:3).
a := Entero with: 4.
c := Entero with: 5.

a**c!
!Entero methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 20:56:47' prior: 50468561!
** aMultiplier 
	^aMultiplier multiplicateAEntero with: self.

	! !
!Entero methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 20:57:04' prior: 50468575!
** aMultiplier 
	^aMultiplier multiplicateAEntero: self.

	! !

b := Fraccion with: (Entero with:5) over: (Entero with:3).!

a := Entero with: 4.!

c := Entero with: 5.!

a**c!

!methodRemoval: Entero #* stamp: 'LDMAF 4/21/2022 20:58:12'!
* aMultiplier 
	(aMultiplier isKindOf: Entero) ifTrue: [^self class with: value * aMultiplier integerValue].
	^ Fraccion with: ((Entero with: self integerValue) * aMultiplier numerator ) over: (aMultiplier denominator)
	!
!Entero methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 20:58:17' overrides: 50467751!
* aMultiplier 
	^aMultiplier multiplicateAEntero: self.

	! !

!methodRemoval: Entero #** stamp: 'LDMAF 4/21/2022 20:58:25'!
** aMultiplier 
	^aMultiplier multiplicateAEntero: self.

	!
!Fraccion methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 20:59:16' prior: 50467963 overrides: 50467751!
* aMultiplier 
	(aMultiplier isKindOf: Fraccion) ifTrue: [^(numerator * aMultiplier numerator) / (denominator * aMultiplier denominator)].
	^ aMultiplier multiplicateAFraccion: self.! !
!Fraccion methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 21:01:12'!
multiplicateAFraccion: aMultiplier
	^self 
	Fraccion with: ((Entero with: aMultiplier integerValue) * self numerator ) over: (self denominator)! !
!Fraccion methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 21:02:59' prior: 50468618!
multiplicateAFraccion: aMultiplier
	^ Fraccion with: (self numerator * aMultiplier numerator) over: (self denominator * aMultiplier denominator)! !

a*b!
!Fraccion methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 21:03:37'!
multiplicateAEntero: aMultiplier
	^ Fraccion with: (self numerator * aMultiplier numerator) over: (self denominator)! !
!Fraccion methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 21:03:40' prior: 50468634!
multiplicateAEntero: aMultiplier
	^ Fraccion with: (self numerator * aMultiplier numerator) over: self denominator! !

a*b!
!Entero methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 21:04:53'!
multiplicateAFraccion: aMultiplier
	^Fraccion with: (Entero with: self*aMultiplier) over: (Entero with: aMultiplier denominator)! !
!Fraccion methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 21:05:21' prior: 50468641!
multiplicateAEntero: aMultiplier
	^ Fraccion with: ((Entero with: self numerator) * aMultiplier numerator) over: self denominator! !

a*b!

b*b!
!Fraccion methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 21:06:08' prior: 50468609 overrides: 50467751!
* aMultiplier 
	^ aMultiplier multiplicateAFraccion: self.! !
!Fraccion methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 21:06:10' prior: 50468665 overrides: 50467751!
* aMultiplier
	^ aMultiplier multiplicateAFraccion: self.! !

b*b!

a*a!

----End fileIn of /home/clinux01/Cuis_University/linux64/Numero-ExerciseViejo.st----!
!Entero methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 21:17:29'!
** aMultiplier 
	^ aMultiplier multiplicateAEntero: self.
	! !
!Entero methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 21:19:10' prior: 50468566!
multiplicateAEntero: aMultiplier
	^ self class with: value * aMultiplier integerValue.! !

a*a!

a*b!

a**b!

a**c!

a**a!
!Entero methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 21:21:02' prior: 50468648!
multiplicateAFraccion: aMultiplier
	^Fraccion with: (Entero with: self value *aMultiplier) over: (Entero with: aMultiplier denominator)! !
!Entero methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 21:21:21' prior: 50469393!
multiplicateAFraccion: aMultiplier
	^Fraccion with: (Entero with: self value *aMultiplier) over: (Entero with: aMultiplier denominator)! !
!Entero methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 21:21:31' prior: 50469401!
multiplicateAFraccion: aMultiplier
	^Fraccion with: (Entero with: self value * aMultiplier integerValue) over: (Entero with: aMultiplier denominator)! !
!Fraccion methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 21:22:58' prior: 50468626!
multiplicateAFraccion: aMultiplier
	^ (numerator * aMultiplier numerator) / (denominator * aMultiplier denominator).! !
!Fraccion methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 21:23:33'!
** aMultiplier 
	^aMultiplier multiplicateAFraccion: self! !

a**b!

a**b!
!Fraccion methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 21:24:29' prior: 50468656!
multiplicateAEntero: aMultiplier
	^ Fraccion with: ((Entero with: self value) * aMultiplier numerator) over: self denominator! !

a**b!
!Fraccion methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 21:25:37' prior: 50469430!
multiplicateAEntero: aMultiplier
	^ Fraccion with: (Entero with: self value * aMultiplier numerator over: self denominator)! !

a**b!
!Fraccion methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 21:26:35' prior: 50469438!
multiplicateAEntero: aMultiplier
	^ Fraccion with: (Entero with: self numerator * aMultiplier integerValue over: self denominator)! !

a**b!

!methodRemoval: Fraccion #multiplicateAEntero: stamp: 'LDMAF 4/21/2022 21:27:51'!
multiplicateAEntero: aMultiplier
	^ Fraccion with: (Entero with: self numerator * aMultiplier integerValue over: self denominator)!

!methodRemoval: Entero #multiplicateAFraccion: stamp: 'LDMAF 4/21/2022 21:28:00'!
multiplicateAFraccion: aMultiplier
	^Fraccion with: (Entero with: self value * aMultiplier integerValue) over: (Entero with: aMultiplier denominator)!

a**b!
!Fraccion methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 21:29:16'!
multiplicateAEntero: aMultiplier
	^ (numerator * aMultiplier integerValue) / (denominator * aMultiplier denominator).! !
!Fraccion methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 21:29:20' prior: 50469468!
multiplicateAEntero: aMultiplier
	^ (numerator * aMultiplier integerValue) / (denominator * aMultiplier integerValue).! !

a**b!
!Entero methodsFor: 'arithmetic operations' stamp: 'LDMAF 4/21/2022 21:31:03'!
multiplicateAFraccion: aMultiplier
	^ Fraccion with: ((Entero with: self class with: value) * aMultiplier numerator ) over: aMultiplier denominator.! !

a**b!

a**c!

a**b!

----STARTUP---- (25 April 2022 18:18:11) as /home/clinux01/Cuis_University/linux64/CuisUniversity-5053.image!


----End fileIn of /home/clinux01/Cuis_University/linux64/Numero-Exercise.st----!

!testRun: #NumeroTest #test01isCeroReturnsTrueWhenAskToZero stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test02isCeroReturnsFalseWhenAskToOthersButZero stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test03isOneReturnsTrueWhenAskToOne stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test04isOneReturnsFalseWhenAskToOtherThanOne stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test05EnteroAddsWithEnteroCorrectly stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test06EnteroMultipliesWithEnteroCorrectly stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test07EnteroDividesEnteroCorrectly stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test08FraccionAddsWithFraccionCorrectly stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test09FraccionMultipliesWithFraccionCorrectly stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test10FraccionDividesFraccionCorrectly stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test11EnteroAddsFraccionCorrectly stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test12FraccionAddsEnteroCorrectly stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test13EnteroMultipliesFraccionCorrectly stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test14FraccionMultipliesEnteroCorrectly stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test15EnteroDividesFraccionCorrectly stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test16FraccionDividesEnteroCorrectly stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test17AFraccionCanBeEqualToAnEntero stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test18AparentFraccionesAreEqual stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test19AddingFraccionesCanReturnAnEntero stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test20MultiplyingFraccionesCanReturnAnEntero stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test21DividingFraccionesCanReturnAnEntero stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test22DividingEnterosCanReturnAFraccion stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test23CanNotDivideEnteroByZero stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test24CanNotDivideFraccionByZero stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test25AFraccionCanNotBeZero stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test26AFraccionCanNotBeOne stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test27EnteroSubstractsEnteroCorrectly stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test28FraccionSubstractsFraccionCorrectly stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test29EnteroSubstractsFraccionCorrectly stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test30FraccionSubstractsEnteroCorrectly stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test31SubstractingFraccionesCanReturnAnEntero stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test32SubstractingSameEnterosReturnsZero stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test33SubstractingSameFraccionesReturnsZero stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test34SubstractingAHigherValueToANumberReturnsANegativeNumber stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test35FibonacciZeroIsOne stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test36FibonacciOneIsOne stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test37FibonacciEnteroReturnsAddingPreviousTwoFibonacciEnteros stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test38FibonacciNotDefinedForNegativeNumbers stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test39NegationOfEnteroIsCorrect stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test40NegationOfFraccionIsCorrect stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test41SignIsCorrectlyAssignedToFractionWithTwoNegatives stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

!testRun: #NumeroTest #test42SignIsCorrectlyAssignedToFractionWithNegativeDivisor stamp: 'LDMAF 4/25/2022 18:22:30'!
PASSED!

Entero subclasses!

Entero allSubclasses!
!Entero class methodsFor: 'instance creation' stamp: 'LDMAF 4/25/2022 18:27:34' prior: 50467978!
with: aValue 
	
	"Esta verificacion esta puesta por si se equivocan y quieren crear un Entero pasando otra cosa que un Integer - Hernan"
	aValue isInteger ifFalse: [  self error: Entero forbiddenValueForIntegerInstantiation ].
	^(Entero subclasses 
		detect: [ :enteroSubclass | enteroSubclass canInitializeWith: aValue ]
		ifNone: [ self error: Entero unableToInitializeWithCurrentValueErrorDescription ]) 
		new initalizeWith: aValue.! !

!testRun: #NumeroTest #test01isCeroReturnsTrueWhenAskToZero stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test02isCeroReturnsFalseWhenAskToOthersButZero stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test03isOneReturnsTrueWhenAskToOne stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test04isOneReturnsFalseWhenAskToOtherThanOne stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test05EnteroAddsWithEnteroCorrectly stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test06EnteroMultipliesWithEnteroCorrectly stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test07EnteroDividesEnteroCorrectly stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test08FraccionAddsWithFraccionCorrectly stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test09FraccionMultipliesWithFraccionCorrectly stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test10FraccionDividesFraccionCorrectly stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test11EnteroAddsFraccionCorrectly stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test12FraccionAddsEnteroCorrectly stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test13EnteroMultipliesFraccionCorrectly stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test14FraccionMultipliesEnteroCorrectly stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test15EnteroDividesFraccionCorrectly stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test16FraccionDividesEnteroCorrectly stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test17AFraccionCanBeEqualToAnEntero stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test18AparentFraccionesAreEqual stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test19AddingFraccionesCanReturnAnEntero stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test20MultiplyingFraccionesCanReturnAnEntero stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test21DividingFraccionesCanReturnAnEntero stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test22DividingEnterosCanReturnAFraccion stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test23CanNotDivideEnteroByZero stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test24CanNotDivideFraccionByZero stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test25AFraccionCanNotBeZero stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test26AFraccionCanNotBeOne stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test27EnteroSubstractsEnteroCorrectly stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test28FraccionSubstractsFraccionCorrectly stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test29EnteroSubstractsFraccionCorrectly stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test30FraccionSubstractsEnteroCorrectly stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test31SubstractingFraccionesCanReturnAnEntero stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test32SubstractingSameEnterosReturnsZero stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test33SubstractingSameFraccionesReturnsZero stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test34SubstractingAHigherValueToANumberReturnsANegativeNumber stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test35FibonacciZeroIsOne stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test36FibonacciOneIsOne stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test37FibonacciEnteroReturnsAddingPreviousTwoFibonacciEnteros stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test38FibonacciNotDefinedForNegativeNumbers stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test39NegationOfEnteroIsCorrect stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test40NegationOfFraccionIsCorrect stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test41SignIsCorrectlyAssignedToFractionWithTwoNegatives stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

!testRun: #NumeroTest #test42SignIsCorrectlyAssignedToFractionWithNegativeDivisor stamp: 'LDMAF 4/25/2022 18:47:22'!
PASSED!

----STARTUP---- (28 April 2022 18:16:06) as /home/clinux01/Cuis_University/linux64/CuisUniversity-5053.image!


----End fileIn of /home/clinux01/Cuis_University/linux64/Stack-Exercise.st----!
!NilNode methodsFor: 'private' stamp: 'LDMAF 4/28/2022 18:58:32' overrides: 16901663!
size
	^0.! !
!FilledNode methodsFor: 'private' stamp: 'LDMAF 4/28/2022 18:58:55' overrides: 16901663!
size
	^previous size + 1.! !
!NodeList methodsFor: 'operations' stamp: 'LDMAF 4/28/2022 18:59:03' prior: 50467866 overrides: 16901663!
size
	^current size.! !

!testRun: #SentenceFinderByPrefixTest #test01SentenceFinderWithoutSentencesShouldReturnEmptyListOnFind stamp: 'LDMAF 4/28/2022 18:59:08'!
PASSED!

!testRun: #SentenceFinderByPrefixTest #test02SentenceFinderReturnsAllSentencesWithGivenPrefix stamp: 'LDMAF 4/28/2022 18:59:08'!
PASSED!

!testRun: #SentenceFinderByPrefixTest #test03SentenceFinderReturnsEmptyIfNoneHasTheGivenPrefix stamp: 'LDMAF 4/28/2022 18:59:08'!
PASSED!

!testRun: #SentenceFinderByPrefixTest #test04FinderIsCaseSensitive stamp: 'LDMAF 4/28/2022 18:59:08'!
PASSED!

!testRun: #SentenceFinderByPrefixTest #test05SentenceFinderOnlySearchesGivenPrefixOnSentences stamp: 'LDMAF 4/28/2022 18:59:08'!
PASSED!

!testRun: #SentenceFinderByPrefixTest #test06SentenceFinderDoesntModifyPreviouslyAddedSentences stamp: 'LDMAF 4/28/2022 18:59:08'!
PASSED!

!testRun: #SentenceFinderByPrefixTest #test07SentenceFinderShouldReturnEmptyIfSentencesAreShorterThanPrefix stamp: 'LDMAF 4/28/2022 18:59:08'!
PASSED!

Object subclass: #NodeList
	instanceVariableNames: 'current'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Stack-Exercise'!

!classDefinition: #NodeList category: 'Stack-Exercise' stamp: 'LDMAF 4/28/2022 18:59:29'!
Object subclass: #NodeList
	instanceVariableNames: 'current'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Stack-Exercise'!

!testRun: #SentenceFinderByPrefixTest #test01SentenceFinderWithoutSentencesShouldReturnEmptyListOnFind stamp: 'LDMAF 4/28/2022 18:59:33'!
PASSED!

!testRun: #SentenceFinderByPrefixTest #test02SentenceFinderReturnsAllSentencesWithGivenPrefix stamp: 'LDMAF 4/28/2022 18:59:33'!
PASSED!

!testRun: #SentenceFinderByPrefixTest #test03SentenceFinderReturnsEmptyIfNoneHasTheGivenPrefix stamp: 'LDMAF 4/28/2022 18:59:33'!
PASSED!

!testRun: #SentenceFinderByPrefixTest #test04FinderIsCaseSensitive stamp: 'LDMAF 4/28/2022 18:59:33'!
PASSED!

!testRun: #SentenceFinderByPrefixTest #test05SentenceFinderOnlySearchesGivenPrefixOnSentences stamp: 'LDMAF 4/28/2022 18:59:33'!
PASSED!

!testRun: #SentenceFinderByPrefixTest #test06SentenceFinderDoesntModifyPreviouslyAddedSentences stamp: 'LDMAF 4/28/2022 18:59:33'!
PASSED!

!testRun: #SentenceFinderByPrefixTest #test07SentenceFinderShouldReturnEmptyIfSentencesAreShorterThanPrefix stamp: 'LDMAF 4/28/2022 18:59:33'!
PASSED!

----STARTUP---- (9 May 2022 17:20:03) as /home/clinux01/Cuis_University/linux64/CuisUniversity-5053.image!


----End fileIn of /home/clinux01/Cuis_University/linux64/TDDBabyStepsGame.st----!

game := TDDBabyStepsGameRot13 new.!

game := TDDBabyStepsGameRot13 start.!

!classDefinition: #TDDBabyStepsRot13Test category: 'TDDBabyStepsGameRot13' stamp: 'LDMAF 5/9/2022 17:44:16'!
TestCase subclass: #TDDBabyStepsRot13Test
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TDDBabyStepsGameRot13'!

game openDefinition !

game openDefinition !

game next.!
!TDDBabyStepsRot13Test methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 17:49:25'!
test01TheEmptyStringDoesntChange
	
	self assert: '' equals: '' asRot13
	! !

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 17:49:26'!
ERROR!

!methodRemoval: TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 17:49:26'!
test01TheEmptyStringDoesntChange
	
	self assert: '' equals: '' asRot13
	!
!TDDBabyStepsRot13Test methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 17:49:26'!
test01TheEmptyStringDoesntChange
	
	self assert: '' equals: '' asRot13
	! !

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 17:49:26'!
ERROR!

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 17:51:25'!
ERROR!

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 17:51:25'!
ERROR!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 17:55:07'!
asRot13
	self shouldBeImplemented.! !

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 17:55:23'!
ERROR!

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 17:55:38'!
ERROR!

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 17:55:38'!
ERROR!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 17:55:48' prior: 50469561!
asRot13
	^''! !

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 17:55:50'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 17:55:52'!
PASSED!

game next.!

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 17:56:02'!
PASSED!
!TDDBabyStepsRot13Test methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 17:56:02'!
test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet
	
	self assert: 'n' equals: 'a' asRot13
	! !

!testRun: #TDDBabyStepsRot13Test #test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 17:56:02'!
FAILURE!

!methodRemoval: TDDBabyStepsRot13Test #test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 17:56:02'!
test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet
	
	self assert: 'n' equals: 'a' asRot13
	!
!TDDBabyStepsRot13Test methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 17:56:02'!
test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet
	
	self assert: 'n' equals: 'a' asRot13
	! !

!testRun: #TDDBabyStepsRot13Test #test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 17:56:02'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 17:56:48'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 17:56:48'!
FAILURE!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:00:26' prior: 50469575!
asRot13
	self ='a' ifTrue: [^'n'].
	^''.! !

!testRun: #TDDBabyStepsRot13Test #test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:00:30'!
PASSED!

game next.!

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 18:00:33'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:00:33'!
PASSED!
!TDDBabyStepsRot13Test methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 18:00:33'!
test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet
	
	self assert: 'z' equals: 'm' asRot13
	! !

!testRun: #TDDBabyStepsRot13Test #test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:00:33'!
FAILURE!

!methodRemoval: TDDBabyStepsRot13Test #test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:00:33'!
test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet
	
	self assert: 'z' equals: 'm' asRot13
	!
!TDDBabyStepsRot13Test methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 18:00:33'!
test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet
	
	self assert: 'z' equals: 'm' asRot13
	! !

!testRun: #TDDBabyStepsRot13Test #test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:00:33'!
FAILURE!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:01:22' prior: 50469630!
asRot13
	self ='a' ifTrue: [^'n'].
	self ='z' ifTrue: [^'m'].
	^''.! !

game next.!

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 18:01:31'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:01:31'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:01:31'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:01:36'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:01:36'!
FAILURE!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:02:07' prior: 50469679!
asRot13
	self ='a' ifTrue: [^'n'].
	self ='m' ifTrue: [^'z'].
	^''.! !

!testRun: #TDDBabyStepsRot13Test #test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:02:10'!
PASSED!

game next. !

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 18:02:15'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:02:15'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:02:15'!
PASSED!
!TDDBabyStepsRot13Test methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 18:02:15'!
test04CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet
	
	self assert: 'a' equals: 'n' asRot13
	! !

!testRun: #TDDBabyStepsRot13Test #test04CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:02:15'!
FAILURE!

!methodRemoval: TDDBabyStepsRot13Test #test04CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:02:15'!
test04CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet
	
	self assert: 'a' equals: 'n' asRot13
	!
!TDDBabyStepsRot13Test methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 18:02:15'!
test04CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet
	
	self assert: 'a' equals: 'n' asRot13
	! !

!testRun: #TDDBabyStepsRot13Test #test04CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:02:15'!
FAILURE!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:02:41' prior: 50469707!
asRot13
	self ='a' ifTrue: [^'n'].
	self ='m' ifTrue: [^'z'].
	self ='n' ifTrue: [^'a'].
	^''.! !

!testRun: #TDDBabyStepsRot13Test #test04CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:02:47'!
PASSED!

game next.!

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 18:02:50'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:02:50'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:02:50'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test04CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:02:50'!
PASSED!
!TDDBabyStepsRot13Test methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 18:02:50'!
test05CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet
	
	self assert: 'm' equals: 'z' asRot13
	! !

!testRun: #TDDBabyStepsRot13Test #test05CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:02:50'!
FAILURE!

!methodRemoval: TDDBabyStepsRot13Test #test05CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:02:50'!
test05CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet
	
	self assert: 'm' equals: 'z' asRot13
	!
!TDDBabyStepsRot13Test methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 18:02:50'!
test05CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet
	
	self assert: 'm' equals: 'z' asRot13
	! !

!testRun: #TDDBabyStepsRot13Test #test05CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:02:50'!
FAILURE!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:09:43' prior: 50469762!
asRot13
	self ='a' ifTrue: [^'n'].
	self ='m' ifTrue: [^'z'].
	self ='n' ifTrue: [^'a'].
	self ='m' ifTrue: [^'z'].
	^''.! !

!testRun: #TDDBabyStepsRot13Test #test05CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:09:46'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test05CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:09:46'!
FAILURE!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:09:55' prior: 50469823!
asRot13
	self ='a' ifTrue: [^'n'].
	self ='m' ifTrue: [^'z'].
	self ='n' ifTrue: [^'a'].
	self ='z' ifTrue: [^'m'].
	^''.! !

!testRun: #TDDBabyStepsRot13Test #test05CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:09:57'!
PASSED!

game next. !

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 18:10:02'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:10:02'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:10:02'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test04CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:10:02'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test05CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:10:02'!
PASSED!
!TDDBabyStepsRot13Test methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 18:10:02'!
test06CorrectlyEncodesAnUppercaseOneCharStringFromTheFirstPartOfTheAlphabet
	
	self assert: 'N' equals: 'A' asRot13.
	self assert: 'Z' equals: 'M' asRot13
	! !

!testRun: #TDDBabyStepsRot13Test #test06CorrectlyEncodesAnUppercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:10:02'!
FAILURE!

!methodRemoval: TDDBabyStepsRot13Test #test06CorrectlyEncodesAnUppercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:10:02'!
test06CorrectlyEncodesAnUppercaseOneCharStringFromTheFirstPartOfTheAlphabet
	
	self assert: 'N' equals: 'A' asRot13.
	self assert: 'Z' equals: 'M' asRot13
	!
!TDDBabyStepsRot13Test methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 18:10:02'!
test06CorrectlyEncodesAnUppercaseOneCharStringFromTheFirstPartOfTheAlphabet
	
	self assert: 'N' equals: 'A' asRot13.
	self assert: 'Z' equals: 'M' asRot13
	! !

!testRun: #TDDBabyStepsRot13Test #test06CorrectlyEncodesAnUppercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:10:02'!
FAILURE!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:10:25' prior: 50469839!
asRot13
	self ='a' ifTrue: [^'n'].
	self ='m' ifTrue: [^'z'].
	self ='n' ifTrue: [^'a'].
	self ='z' ifTrue: [^'m'].
	self ='A' ifTrue: [^'N'].
	self ='Z' ifTrue: [^'M'].
	^''.! !

!testRun: #TDDBabyStepsRot13Test #test06CorrectlyEncodesAnUppercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:10:28'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test06CorrectlyEncodesAnUppercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:10:28'!
FAILURE!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:10:49' prior: 50469909!
asRot13
	self ='a' ifTrue: [^'n'].
	self ='m' ifTrue: [^'z'].
	self ='n' ifTrue: [^'a'].
	self ='z' ifTrue: [^'m'].
	self ='A' ifTrue: [^'N'].
	self ='M' ifTrue: [^'Z'].
	^''.! !

!testRun: #TDDBabyStepsRot13Test #test06CorrectlyEncodesAnUppercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:10:55'!
PASSED!

game next. !

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 18:10:59'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:10:59'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:10:59'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test04CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:10:59'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test05CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:10:59'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test06CorrectlyEncodesAnUppercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:10:59'!
PASSED!
!TDDBabyStepsRot13Test methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 18:10:59'!
test07CorrectlyEncodesAnUppercaseOneCharStringFromTheSecondPartOfTheAlphabet
	
	self assert: 'A' equals: 'N' asRot13.
	self assert: 'M' equals: 'Z' asRot13
	! !

!testRun: #TDDBabyStepsRot13Test #test07CorrectlyEncodesAnUppercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:10:59'!
FAILURE!

!methodRemoval: TDDBabyStepsRot13Test #test07CorrectlyEncodesAnUppercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:10:59'!
test07CorrectlyEncodesAnUppercaseOneCharStringFromTheSecondPartOfTheAlphabet
	
	self assert: 'A' equals: 'N' asRot13.
	self assert: 'M' equals: 'Z' asRot13
	!
!TDDBabyStepsRot13Test methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 18:10:59'!
test07CorrectlyEncodesAnUppercaseOneCharStringFromTheSecondPartOfTheAlphabet
	
	self assert: 'A' equals: 'N' asRot13.
	self assert: 'M' equals: 'Z' asRot13
	! !

!testRun: #TDDBabyStepsRot13Test #test07CorrectlyEncodesAnUppercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:10:59'!
FAILURE!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:13:43' prior: 50469927!
asRot13
	self ='a' ifTrue: [^'n'].
	self ='m' ifTrue: [^'z'].
	self ='n' ifTrue: [^'a'].
	self ='z' ifTrue: [^'m'].
	self ='A' ifTrue: [^'N'].
	self ='M' ifTrue: [^'Z'].
	self ='N' ifTrue: [^'A'].
	self ='Z' ifTrue: [^'M'].
	^''.! !

!testRun: #TDDBabyStepsRot13Test #test07CorrectlyEncodesAnUppercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:13:46'!
PASSED!

game next. !

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 18:13:50'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:13:50'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:13:50'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test04CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:13:50'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test05CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:13:50'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test06CorrectlyEncodesAnUppercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:13:50'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test07CorrectlyEncodesAnUppercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:13:50'!
PASSED!
!TDDBabyStepsRot13Test methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 18:13:50'!
test08CorrectlyEncodesATwoCharStringWithNoSpecialCharacters
	
	self assert: 'nm' equals: 'az' asRot13
	! !

!testRun: #TDDBabyStepsRot13Test #test08CorrectlyEncodesATwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:13:50'!
FAILURE!

!methodRemoval: TDDBabyStepsRot13Test #test08CorrectlyEncodesATwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:13:50'!
test08CorrectlyEncodesATwoCharStringWithNoSpecialCharacters
	
	self assert: 'nm' equals: 'az' asRot13
	!
!TDDBabyStepsRot13Test methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 18:13:50'!
test08CorrectlyEncodesATwoCharStringWithNoSpecialCharacters
	
	self assert: 'nm' equals: 'az' asRot13
	! !

!testRun: #TDDBabyStepsRot13Test #test08CorrectlyEncodesATwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:13:50'!
FAILURE!

$a asciiValue!

Character asciiValue: 110 !

$a asciiValue.!

$a do:[: char| char asciiValue] !

'hola' do:[: char| char asciiValue] !

'hola' do:[: char| char asciiValue]  !

'hola' do:[: char| char asciiValue]!

'hola' do:[: char| ^char asciiValue]!

'hola' do:[: char| ^char asciiValue] !

'hola' do:[: char| ^char asciiValue] !

$h asciiValue!

resultado := ''.!

'hola' do:[: char| 
	resultado add: char asciiValue]!

resultado := orderedCollection new.!

resultado := OrderedCollection new.!

'hola' do:[: char| 
	resultado add: char asciiValue]!

resultado!

'hola' do:[: char| 
	resultado add: (Character asciiValue: (char asciiValue + 13))]!

resultado!

resultado := OrderedCollection new.!

'hola' do:[: char| 
	resultado add: (Character asciiValue: (char asciiValue + 13))]!

resultado!

resultado := ''.!

'hola' do:[: char| 
	resultado append: (Character asciiValue: (char asciiValue + 13))]!

'hola' do:[: char| 
	resultado append: (Character asciiValue: (char asciiValue + 13)) asString]!

resultado!

'hola' do:[: char| 
	resultado := resultado append: (Character asciiValue: (char asciiValue + 13)) asString]!

resultado!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:31:33' prior: 50470003!
asRot13
	| stringResult |
	stringResult := ''.
	self do: [:char | 
	char ='a' ifTrue: [stringResult := stringResult append: 'n'].
	char ='m' ifTrue: [stringResult := stringResult append:'z'].
	char ='n' ifTrue: [stringResult := stringResult append:'a'].
	char ='z' ifTrue: [stringResult := stringResult append:'m'].
	char ='A' ifTrue: [stringResult := stringResult append:'N'].
	char ='M' ifTrue: [stringResult := stringResult append:'Z'].
	char ='N' ifTrue: [stringResult := stringResult append:'A'].
	char ='Z' ifTrue: [stringResult := stringResult append:'M'].
	].
	^stringResult ! !
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:31:36' prior: 50470115!
asRot13
	| stringResult |
	stringResult := ''.
	self do: [:char | 
	char ='a' ifTrue: [stringResult := stringResult append: 'n'].
	char ='m' ifTrue: [stringResult := stringResult append:'z'].
	char ='n' ifTrue: [stringResult := stringResult append:'a'].
	char ='z' ifTrue: [stringResult := stringResult append:'m'].
	char ='A' ifTrue: [stringResult := stringResult append:'N'].
	char ='M' ifTrue: [stringResult := stringResult append:'Z'].
	char ='N' ifTrue: [stringResult := stringResult append:'A'].
	char ='Z' ifTrue: [stringResult := stringResult append:'M'].
	].
	^stringResult.! !

!testRun: #TDDBabyStepsRot13Test #test08CorrectlyEncodesATwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:31:39'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test08CorrectlyEncodesATwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:31:39'!
FAILURE!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:32:28' prior: 50470136!
asRot13
	| stringResult |
	stringResult := ''.
	self do: [:char | 
	(char ='a') ifTrue: [stringResult := stringResult append: 'n'].
	(char ='m') ifTrue: [stringResult := stringResult append:'z'].
	(char ='n') ifTrue: [stringResult := stringResult append:'a'].
	(char ='z') ifTrue: [stringResult := stringResult append:'m'].
	(char ='A') ifTrue: [stringResult := stringResult append:'N'].
	(char ='M') ifTrue: [stringResult := stringResult append:'Z'].
	(char ='N') ifTrue: [stringResult := stringResult append:'A'].
	(char ='Z') ifTrue: [stringResult := stringResult append:'M'].
	].
	^stringResult.! !

!testRun: #TDDBabyStepsRot13Test #test08CorrectlyEncodesATwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:32:32'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test08CorrectlyEncodesATwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:32:32'!
FAILURE!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:33:41' prior: 50470166!
asRot13
	| stringResult |
	stringResult := ''.
	self do: [:char | 
	(char =$a) ifTrue: [stringResult := stringResult append: 'n'].
	(char =$m) ifTrue: [stringResult := stringResult append:'z'].
	(char =$n) ifTrue: [stringResult := stringResult append:'a'].
	(char =$z) ifTrue: [stringResult := stringResult append:'m'].
	(char =$A) ifTrue: [stringResult := stringResult append:'N'].
	(char =$M) ifTrue: [stringResult := stringResult append:'Z'].
	(char =$N) ifTrue: [stringResult := stringResult append:'A'].
	(char =$Z) ifTrue: [stringResult := stringResult append:'M'].
	].
	^stringResult.! !

!testRun: #TDDBabyStepsRot13Test #test08CorrectlyEncodesATwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:33:44'!
PASSED!

game next.!

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 18:33:51'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:33:51'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:33:51'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test04CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:33:51'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test05CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:33:51'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test06CorrectlyEncodesAnUppercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:33:51'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test07CorrectlyEncodesAnUppercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:33:51'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test08CorrectlyEncodesATwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:33:51'!
PASSED!
!TDDBabyStepsRot13Test methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 18:33:51'!
test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters
	
	self assert: 'uByN' equals: 'hOlA' asRot13
	! !

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:33:51'!
FAILURE!

!methodRemoval: TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:33:51'!
test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters
	
	self assert: 'uByN' equals: 'hOlA' asRot13
	!
!TDDBabyStepsRot13Test methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 18:33:51'!
test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters
	
	self assert: 'uByN' equals: 'hOlA' asRot13
	! !

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:33:51'!
FAILURE!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:36:49' prior: 50470196!
asRot13
	| stringResult |
	stringResult := ''.
	self isEmpty ifTrue: [^''].
	self do: [:char | 
	stringResult := stringResult append: (char asciiValue + 13)].
	^stringResult.! !

$n asciiValue!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:39:19' prior: 50470289!
asRot13
	| stringResult |
	stringResult := ''.
	self isEmpty ifTrue: [^''].
	self do: [:char | 
	(char asciiValue >= 110) 
		ifTrue: [stringResult := stringResult append: (char asciiValue - 13)]
		ifFalse: [stringResult := stringResult append: (char asciiValue + 13)].
	].
	^stringResult.! !

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:39:25'!
ERROR!

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:39:25'!
ERROR!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:39:38' prior: 50470298!
asRot13
	| stringResult |
	stringResult := ''.
	self isEmpty ifTrue: [^''].
	self do: [:char | 
	(char asciiValue >= 110) 
		ifTrue: [stringResult := stringResult append: (char asciiValue - 13)asString]
		ifFalse: [stringResult := stringResult append: (char asciiValue + 13)asString].
	].
	^stringResult.! !

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:39:41'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:39:41'!
FAILURE!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:40:21' prior: 50470319!
asRot13
	| stringResult |
	stringResult := ''.
	self isEmpty ifTrue: [^''].
	self do: [:char | 
	(char asciiValue >= 110) 
		ifTrue: [stringResult := stringResult append: (Character asciiValue: (char asciiValue - 13))asString]
		ifFalse: [stringResult := stringResult append: (Character asciiValue: (char asciiValue + 13))asString].
	].
	^stringResult.! !

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:40:25'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:40:25'!
FAILURE!

$B asciiValue !

Character asciiValue: 79 !

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:41:26'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:41:26'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:42:06'!
FAILURE!

$h asciiValue !

$OasciiValue !

$O asciiValue !

Character asciiValue: 92!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:50:19' prior: 50470341!
asRot13
	| stringResult |
	stringResult := ''.
	self isEmpty ifTrue: [^''].
	self do: [:char | 
	((char asciiValue between: 90 and: 79) or: [(char asciiValue between: 122 and: 110)])
		ifTrue: [stringResult := stringResult append: (Character asciiValue: (char asciiValue - 13))asString]
		ifFalse: [stringResult := stringResult append: (Character asciiValue: (char asciiValue + 13))asString]
	].
	^stringResult.! !

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:50:21'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:50:33'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:50:33'!
FAILURE!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:51:16' prior: 50470382!
asRot13
	| stringResult |
	stringResult := ''.
	self isEmpty ifTrue: [^''].
	self do: [:char | 
	((char asciiValue between: 79 and: 90) or: [(char asciiValue between: 110 and: 122)])
		ifTrue: [stringResult := stringResult append: (Character asciiValue: (char asciiValue - 13))asString]
		ifFalse: [stringResult := stringResult append: (Character asciiValue: (char asciiValue + 13))asString]
	].
	^stringResult.! !

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:51:19'!
PASSED!

game next. !

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 18:51:42'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:51:42'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:51:42'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test04CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:51:42'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test05CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:51:42'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test06CorrectlyEncodesAnUppercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:51:42'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test07CorrectlyEncodesAnUppercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:51:42'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test08CorrectlyEncodesATwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:51:42'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:51:42'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:51:48'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 18:51:51'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:51:51'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:51:51'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test04CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:51:51'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test05CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:51:51'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test06CorrectlyEncodesAnUppercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:51:51'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test07CorrectlyEncodesAnUppercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:51:51'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test08CorrectlyEncodesATwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:51:51'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:51:51'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test07CorrectlyEncodesAnUppercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:51:51'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test07CorrectlyEncodesAnUppercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:52:07'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test07CorrectlyEncodesAnUppercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:52:07'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test07CorrectlyEncodesAnUppercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:53:07'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test07CorrectlyEncodesAnUppercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:53:07'!
FAILURE!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:54:35' prior: 50470412!
asRot13
	| stringResult |
	stringResult := ''.
	self isEmpty ifTrue: [^''].
	self do: [:char | 
	((char asciiValue between: 78 and: 90) or: [(char asciiValue between: 110 and: 122)])
		ifTrue: [stringResult := stringResult append: (Character asciiValue: (char asciiValue - 13))asString]
		ifFalse: [stringResult := stringResult append: (Character asciiValue: (char asciiValue + 13))asString]
	].
	^stringResult.! !

!testRun: #TDDBabyStepsRot13Test #test07CorrectlyEncodesAnUppercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:54:39'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 18:54:43'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:54:43'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:54:43'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test04CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:54:43'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test05CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:54:43'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test06CorrectlyEncodesAnUppercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:54:43'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test07CorrectlyEncodesAnUppercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:54:43'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test08CorrectlyEncodesATwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:54:43'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:54:43'!
PASSED!

game next. !

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 18:54:55'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:54:55'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:54:55'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test04CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:54:55'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test05CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:54:55'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test06CorrectlyEncodesAnUppercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:54:55'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test07CorrectlyEncodesAnUppercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 18:54:55'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test08CorrectlyEncodesATwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:54:55'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 18:54:55'!
PASSED!
!TDDBabyStepsRot13Test methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 18:54:55'!
test10CorrectlyEncodesSpecialCharactersWithNoChange
	
	self assert: '&n%( 4' equals: '&a%( 4' asRot13
	! !

!testRun: #TDDBabyStepsRot13Test #test10CorrectlyEncodesSpecialCharactersWithNoChange stamp: 'LDMAF 5/9/2022 18:54:55'!
FAILURE!

!methodRemoval: TDDBabyStepsRot13Test #test10CorrectlyEncodesSpecialCharactersWithNoChange stamp: 'LDMAF 5/9/2022 18:54:55'!
test10CorrectlyEncodesSpecialCharactersWithNoChange
	
	self assert: '&n%( 4' equals: '&a%( 4' asRot13
	!
!TDDBabyStepsRot13Test methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 18:54:55'!
test10CorrectlyEncodesSpecialCharactersWithNoChange
	
	self assert: '&n%( 4' equals: '&a%( 4' asRot13
	! !

!testRun: #TDDBabyStepsRot13Test #test10CorrectlyEncodesSpecialCharactersWithNoChange stamp: 'LDMAF 5/9/2022 18:54:55'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test10CorrectlyEncodesSpecialCharactersWithNoChange stamp: 'LDMAF 5/9/2022 18:55:05'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test10CorrectlyEncodesSpecialCharactersWithNoChange stamp: 'LDMAF 5/9/2022 18:55:05'!
FAILURE!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:58:43' prior: 50470543!
asRot13
	| stringResult |
	stringResult := ''.
	self isEmpty ifTrue: [^''].
	self do: [:char | 
	((char asciiValue between: 65 and: 90) or: [(char asciiValue between: 97 and: 122)])
	ifTrue:[
		((char asciiValue between: 78 and: 90) or: [(char asciiValue between: 110 and: 122)])
			ifTrue: [stringResult := stringResult append: (Character asciiValue: (char asciiValue - 13))asString]
			ifFalse: [stringResult := stringResult append: (Character asciiValue: (char asciiValue + 13))asString]
		]
	].
	^stringResult.! !
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:58:44' prior: 50470683!
asRot13
	| stringResult |
	stringResult := ''.
	self isEmpty ifTrue: [^''].
	self do: [:char | 
	((char asciiValue between: 65 and: 90) or: [(char asciiValue between: 97 and: 122)])
	ifTrue:[
		((char asciiValue between: 78 and: 90) or: [(char asciiValue between: 110 and: 122)])
			ifTrue: [stringResult := stringResult append: (Character asciiValue: (char asciiValue - 13))asString]
			ifFalse: [stringResult := stringResult append: (Character asciiValue: (char asciiValue + 13))asString]
		].
	].
	^stringResult.! !

!testRun: #TDDBabyStepsRot13Test #test10CorrectlyEncodesSpecialCharactersWithNoChange stamp: 'LDMAF 5/9/2022 18:58:48'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test10CorrectlyEncodesSpecialCharactersWithNoChange stamp: 'LDMAF 5/9/2022 18:58:48'!
FAILURE!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 18:59:20' prior: 50470702!
asRot13
	| stringResult |
	stringResult := ''.
	self isEmpty ifTrue: [^''].
	self do: [:char | 
	((char asciiValue between: 65 and: 90) or: [(char asciiValue between: 97 and: 122)])
	ifTrue:[
		((char asciiValue between: 78 and: 90) or: [(char asciiValue between: 110 and: 122)])
			ifTrue: [stringResult := stringResult append: (Character asciiValue: (char asciiValue - 13))asString]
			ifFalse: [stringResult := stringResult append: (Character asciiValue: (char asciiValue + 13))asString]
		]
	ifFalse:[stringResult append: char asString ].
	].
	^stringResult.! !

!testRun: #TDDBabyStepsRot13Test #test10CorrectlyEncodesSpecialCharactersWithNoChange stamp: 'LDMAF 5/9/2022 18:59:24'!
FAILURE!

!testRun: #TDDBabyStepsRot13Test #test10CorrectlyEncodesSpecialCharactersWithNoChange stamp: 'LDMAF 5/9/2022 18:59:24'!
FAILURE!
!String methodsFor: '*Rot13' stamp: 'LDMAF 5/9/2022 19:01:01' prior: 50470729!
asRot13
	| stringResult |
	stringResult := ''.
	self isEmpty ifTrue: [^''].
	self do: [:char | 
	((char asciiValue between: 65 and: 90) or: [(char asciiValue between: 97 and: 122)])
	ifTrue:[
		((char asciiValue between: 78 and: 90) or: [(char asciiValue between: 110 and: 122)])
			ifTrue: [stringResult := stringResult append: (Character asciiValue: (char asciiValue - 13))asString]
			ifFalse: [stringResult := stringResult append: (Character asciiValue: (char asciiValue + 13))asString]
		]
	ifFalse:[stringResult := stringResult append: char asString ].
	].
	^stringResult.! !

!testRun: #TDDBabyStepsRot13Test #test10CorrectlyEncodesSpecialCharactersWithNoChange stamp: 'LDMAF 5/9/2022 19:01:05'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 19:01:08'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 19:01:08'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 19:01:08'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test04CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 19:01:08'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test05CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 19:01:08'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test06CorrectlyEncodesAnUppercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 19:01:08'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test07CorrectlyEncodesAnUppercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 19:01:08'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test08CorrectlyEncodesATwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 19:01:08'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 19:01:08'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test10CorrectlyEncodesSpecialCharactersWithNoChange stamp: 'LDMAF 5/9/2022 19:01:08'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 19:01:13'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 19:01:13'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 19:01:13'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test04CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 19:01:13'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test05CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 19:01:13'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test06CorrectlyEncodesAnUppercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 19:01:13'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test07CorrectlyEncodesAnUppercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 19:01:13'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test08CorrectlyEncodesATwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 19:01:13'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 19:01:13'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test10CorrectlyEncodesSpecialCharactersWithNoChange stamp: 'LDMAF 5/9/2022 19:01:13'!
PASSED!

game next. !

!testRun: #TDDBabyStepsRot13Test #test01TheEmptyStringDoesntChange stamp: 'LDMAF 5/9/2022 19:01:18'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test02CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 19:01:18'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test03CorrectlyEncodesALowercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 19:01:18'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test04CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 19:01:18'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test05CorrectlyEncodesALowercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 19:01:18'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test06CorrectlyEncodesAnUppercaseOneCharStringFromTheFirstPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 19:01:18'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test07CorrectlyEncodesAnUppercaseOneCharStringFromTheSecondPartOfTheAlphabet stamp: 'LDMAF 5/9/2022 19:01:18'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test08CorrectlyEncodesATwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 19:01:18'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test09CorrectlyEncodesMoreThanTwoCharStringWithNoSpecialCharacters stamp: 'LDMAF 5/9/2022 19:01:18'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #test10CorrectlyEncodesSpecialCharactersWithNoChange stamp: 'LDMAF 5/9/2022 19:01:18'!
PASSED!
!TDDBabyStepsRot13Test methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 19:01:18'!
testExtraToCheckGeneralizationOnKata
		
	self assert: 'Ju3er j3 4e3 t01at j3 q0ag a3rq e04q$...' equals: 'Wh3re w3 4r3 g01ng w3 d0nt n3ed r04d$...' asRot13
	! !

!testRun: #TDDBabyStepsRot13Test #testExtraToCheckGeneralizationOnKata stamp: 'LDMAF 5/9/2022 19:01:18'!
PASSED!

!testRun: #TDDBabyStepsRot13Test #testExtraToCheckGeneralizationOnKata stamp: 'LDMAF 5/9/2022 19:04:01'!
PASSED!

game := TDDBabyStepsGamePrimeFactors start. !

!classDefinition: #TDDBabyStepsPrimeFactorsTest category: 'TDDBabyStepsGamePrimeFactors' stamp: 'LDMAF 5/9/2022 19:14:34'!
TestCase subclass: #TDDBabyStepsPrimeFactorsTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TDDBabyStepsGamePrimeFactors'!

----SNAPSHOT----(9 May 2022 19:15:05) CuisUniversity-5053.image priorSource: 4345117!

game openDefinition.!

game next. !
!TDDBabyStepsPrimeFactorsTest methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 19:15:44'!
test01OneHasNoPrimeFactors
	
	self assert: Bag new equals: 1 factorize
	! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 19:15:44'!
ERROR!

!methodRemoval: TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 19:15:44'!
test01OneHasNoPrimeFactors
	
	self assert: Bag new equals: 1 factorize
	!
!TDDBabyStepsPrimeFactorsTest methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 19:15:44'!
test01OneHasNoPrimeFactors
	
	self assert: Bag new equals: 1 factorize
	! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 19:15:44'!
ERROR!

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 19:15:55'!
ERROR!
!Integer methodsFor: '*PrimeFactor' stamp: 'LDMAF 5/9/2022 19:17:14'!
factorize
	self shouldBeImplemented.! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 19:17:42'!
ERROR!

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 19:17:47'!
ERROR!

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 19:17:47'!
ERROR!

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 19:18:03'!
FAILURE!

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 19:18:11'!
ERROR!

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 19:18:11'!
ERROR!
!Integer methodsFor: '*PrimeFactor' stamp: 'LDMAF 5/9/2022 19:18:38' prior: 50470975!
factorize
	^Bag new.! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 19:18:44'!
PASSED!

game next.!

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 19:18:47'!
PASSED!
!TDDBabyStepsPrimeFactorsTest methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 19:18:47'!
test02FactorsOfAPrimeNumberAreThePrimeNumber

	self assert: (Bag with: 2) equals: 2 factorize
	! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test02FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 19:18:47'!
FAILURE!

!methodRemoval: TDDBabyStepsPrimeFactorsTest #test02FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 19:18:47'!
test02FactorsOfAPrimeNumberAreThePrimeNumber

	self assert: (Bag with: 2) equals: 2 factorize
	!
!TDDBabyStepsPrimeFactorsTest methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 19:18:47'!
test02FactorsOfAPrimeNumberAreThePrimeNumber

	self assert: (Bag with: 2) equals: 2 factorize
	! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test02FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 19:18:47'!
FAILURE!
!Integer methodsFor: '*PrimeFactor' stamp: 'LDMAF 5/9/2022 19:21:10' prior: 50471000!
factorize
	self = 2 ifTrue: [^Bag new add: 2].
	^Bag new.! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test02FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 19:21:15'!
FAILURE!

!testRun: #TDDBabyStepsPrimeFactorsTest #test02FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 19:21:15'!
FAILURE!

Bag new add: 2!
!Integer methodsFor: '*PrimeFactor' stamp: 'LDMAF 5/9/2022 19:21:45' prior: 50471038!
factorize
	self = 2 ifTrue: [^Bag with: 2].
	^Bag new.! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test02FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 19:21:48'!
PASSED!

game next. !

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 19:21:51'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test02FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 19:21:51'!
PASSED!
!TDDBabyStepsPrimeFactorsTest methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 19:21:51'!
test03FactorsOfAPrimeNumberAreThePrimeNumber

	self assert: (Bag with: 3) equals: 3 factorize
	! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test03FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 19:21:51'!
FAILURE!

!methodRemoval: TDDBabyStepsPrimeFactorsTest #test03FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 19:21:51'!
test03FactorsOfAPrimeNumberAreThePrimeNumber

	self assert: (Bag with: 3) equals: 3 factorize
	!
!TDDBabyStepsPrimeFactorsTest methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 19:21:51'!
test03FactorsOfAPrimeNumberAreThePrimeNumber

	self assert: (Bag with: 3) equals: 3 factorize
	! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test03FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 19:21:51'!
FAILURE!
!Integer methodsFor: '*PrimeFactor' stamp: 'LDMAF 5/9/2022 19:22:06' prior: 50471052!
factorize
	self = 2 ifTrue: [^Bag with: 2].
	self = 3 ifTrue: [^Bag with: 3].
	^Bag new.! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 19:22:10'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test02FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 19:22:10'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test03FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 19:22:10'!
PASSED!

game next.  !

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 19:22:14'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test02FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 19:22:14'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test03FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 19:22:14'!
PASSED!
!TDDBabyStepsPrimeFactorsTest methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 19:22:14'!
test04CorrectlyFactorizesACompositeNumberWithTwoFactors2
	
	self assert: (Bag with: 2 with: 2) equals: 4 factorize
	! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test04CorrectlyFactorizesACompositeNumberWithTwoFactors2 stamp: 'LDMAF 5/9/2022 19:22:14'!
FAILURE!

!methodRemoval: TDDBabyStepsPrimeFactorsTest #test04CorrectlyFactorizesACompositeNumberWithTwoFactors2 stamp: 'LDMAF 5/9/2022 19:22:14'!
test04CorrectlyFactorizesACompositeNumberWithTwoFactors2
	
	self assert: (Bag with: 2 with: 2) equals: 4 factorize
	!
!TDDBabyStepsPrimeFactorsTest methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 19:22:14'!
test04CorrectlyFactorizesACompositeNumberWithTwoFactors2
	
	self assert: (Bag with: 2 with: 2) equals: 4 factorize
	! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test04CorrectlyFactorizesACompositeNumberWithTwoFactors2 stamp: 'LDMAF 5/9/2022 19:22:14'!
FAILURE!
!Integer methodsFor: '*PrimeFactor' stamp: 'LDMAF 5/9/2022 19:24:37' prior: 50471096!
factorize
	self = 2 ifTrue: [^Bag with: 2].
	self = 3 ifTrue: [^Bag with: 3].
	self = 4 ifTrue: [^Bag with: 2 with: 2].
	^Bag new.! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test04CorrectlyFactorizesACompositeNumberWithTwoFactors2 stamp: 'LDMAF 5/9/2022 19:24:43'!
PASSED!

game next.  !

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 19:24:47'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test02FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 19:24:47'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test03FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 19:24:47'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test04CorrectlyFactorizesACompositeNumberWithTwoFactors2 stamp: 'LDMAF 5/9/2022 19:24:47'!
PASSED!
!TDDBabyStepsPrimeFactorsTest methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 19:24:47'!
test08CorrectlyFactorizesACompositeNumberWithMoreThanTwoFactors2
	
	self assert: (Bag with: 2 with: 2 with: 2) equals: 8 factorize
	! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test08CorrectlyFactorizesACompositeNumberWithMoreThanTwoFactors2 stamp: 'LDMAF 5/9/2022 19:24:47'!
FAILURE!

!methodRemoval: TDDBabyStepsPrimeFactorsTest #test08CorrectlyFactorizesACompositeNumberWithMoreThanTwoFactors2 stamp: 'LDMAF 5/9/2022 19:24:47'!
test08CorrectlyFactorizesACompositeNumberWithMoreThanTwoFactors2
	
	self assert: (Bag with: 2 with: 2 with: 2) equals: 8 factorize
	!
!TDDBabyStepsPrimeFactorsTest methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 19:24:47'!
test08CorrectlyFactorizesACompositeNumberWithMoreThanTwoFactors2
	
	self assert: (Bag with: 2 with: 2 with: 2) equals: 8 factorize
	! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test08CorrectlyFactorizesACompositeNumberWithMoreThanTwoFactors2 stamp: 'LDMAF 5/9/2022 19:24:47'!
FAILURE!

----SNAPSHOT----(9 May 2022 19:26:49) CuisUniversity-5053.image priorSource: 4457364!

(2 to: 30)!

primeFactors := Bag new.!

(2 to: 8) do: [:num | 
	num isPrime ifTrue: [primeFactors add: num].
	]!

primeFactors!

numAFactorizar := 8.!

primeFactors := Bag new.!

numAFactorizar := 8.!

(2 to: numAFactorizar) do: [:num | 
	(num isPrime and: [numAFactorizar mod: num = 0])
		ifTrue: [primeFactors add: num].
	].!

	(num isPrime and: [(numAFactorizar mod: num) = 0])!

(2 to: numAFactorizar) do: [:num | 
	((num isPrime) and: [(numAFactorizar mod: num) = 0])
		ifTrue: [primeFactors add: num].
	].!

primeFactors!

inicio := 2.!

primeFactors := Bag new.!

numAFactorizar := 8.!

inicio := 2.!

(inicio to: numAFactorizar) do: [:num | 
	((num isPrime) and: [(numAFactorizar mod: num) = 0])
		ifTrue: [
			primeFactors add: num.
			inicio := 2.
			numAFactorizar := numAFactorizar / num.
			].
	].!

primeFactors!

primeFactors!

primeFactors!

primeFactors!

primeFactors := Bag new.!

numAFactorizar := 8.!

inicio := 2.!

(inicio to: numAFactorizar) do: [:num | 
	((num isPrime) and: [(numAFactorizar mod: num) = 0])
		ifTrue: [
			primeFactors add: num.
			inicio := 2.
			numAFactorizar := numAFactorizar / num.
			].
	].!

primeFactors!

primeFactors!

8/2!
!Integer methodsFor: '*PrimeFactor' stamp: 'LDMAF 5/9/2022 20:10:09' prior: 50471156!
factorize
	| primeFactors |
	primeFactors := Bag new.
	(2 to: self) do:[ :num | 
		((num isPrime) and: [(self mod: num) = 0])
		ifTrue: [	primeFactors add: num		].
	].
	self = 2 ifTrue: [^Bag with: 2].
	self = 3 ifTrue: [^Bag with: 3].
	self = 4 ifTrue: [^Bag with: 2 with: 2].
	^Bag new.! !
!Integer methodsFor: '*PrimeFactor' stamp: 'LDMAF 5/9/2022 20:10:18' prior: 50471257!
factorize
	| primeFactors |
	primeFactors := Bag new.
	(2 to: self) do:[ :num | 
		((num isPrime) and: [(self mod: num) = 0])
		ifTrue: [	primeFactors add: num		].
	].
	^primeFactors .! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 20:10:23'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test02FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 20:10:27'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test03FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 20:10:30'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test04CorrectlyFactorizesACompositeNumberWithTwoFactors2 stamp: 'LDMAF 5/9/2022 20:10:34'!
FAILURE!

!testRun: #TDDBabyStepsPrimeFactorsTest #test04CorrectlyFactorizesACompositeNumberWithTwoFactors2 stamp: 'LDMAF 5/9/2022 20:10:34'!
FAILURE!
!Integer methodsFor: '*PrimeFactor' stamp: 'LDMAF 5/9/2022 20:12:40' prior: 50471269!
factorize
	| primeFactors |
	primeFactors := Bag new.
	(2 to: self) do:[ :num | 
		((num isPrime) and: [(self mod: num) = 0])
		ifTrue: [
			primeFactors add: num	.
			].
	].
	^primeFactors .! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test03FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 20:12:45'!
PASSED!

primeFactors := Bag new.!

numAFactorizar := 8.!

inicio := 2.!
!Integer methodsFor: '*PrimeFactor' stamp: 'LDMAF 5/9/2022 20:23:54' prior: 50471298!
factorize
	| primeFactors iteradorPrimos numAFactorizar |
	primeFactors := Bag new.
	iteradorPrimos := 2.
	numAFactorizar := self.
	[iteradorPrimos <= numAFactorizar] whileTrue: [ 
		((iteradorPrimos isPrime) and: [(self mod: iteradorPrimos) = 0])		ifTrue: [		
			primeFactors add: iteradorPrimos	.
			numAFactorizar := numAFactorizar/2.
			]
		ifFalse:[iteradorPrimos := iteradorPrimos + 1].
	].
	^primeFactors.! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test08CorrectlyFactorizesACompositeNumberWithMoreThanTwoFactors2 stamp: 'LDMAF 5/9/2022 20:24:00'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 20:24:04'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test02FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 20:24:04'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test03FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 20:24:04'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test04CorrectlyFactorizesACompositeNumberWithTwoFactors2 stamp: 'LDMAF 5/9/2022 20:24:04'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test08CorrectlyFactorizesACompositeNumberWithMoreThanTwoFactors2 stamp: 'LDMAF 5/9/2022 20:24:04'!
PASSED!

game next.!

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 20:24:07'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test02FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 20:24:07'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test03FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 20:24:07'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test04CorrectlyFactorizesACompositeNumberWithTwoFactors2 stamp: 'LDMAF 5/9/2022 20:24:07'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test08CorrectlyFactorizesACompositeNumberWithMoreThanTwoFactors2 stamp: 'LDMAF 5/9/2022 20:24:07'!
PASSED!
!TDDBabyStepsPrimeFactorsTest methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 20:24:08'!
test09CorrectlyFactorizesACompositeNumberWithMoreThanOneFactorsDifferentThan2
	
	self assert: (Bag with: 3 with: 3) equals: 9 factorize
	! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test09CorrectlyFactorizesACompositeNumberWithMoreThanOneFactorsDifferentThan2 stamp: 'LDMAF 5/9/2022 20:24:08'!
PASSED!

!methodRemoval: TDDBabyStepsPrimeFactorsTest #test09CorrectlyFactorizesACompositeNumberWithMoreThanOneFactorsDifferentThan2 stamp: 'LDMAF 5/9/2022 20:24:08'!
test09CorrectlyFactorizesACompositeNumberWithMoreThanOneFactorsDifferentThan2
	
	self assert: (Bag with: 3 with: 3) equals: 9 factorize
	!
!Integer methodsFor: '*PrimeFactor' stamp: 'LDMAF 5/9/2022 20:25:01' prior: 50471313!
factorize
	| primeFactors iteradorPrimos numAFactorizar |
	self = 2 ifTrue: [^Bag with: 2].
	self = 3 ifTrue: [^Bag with: 3].
	primeFactors := Bag new.
	iteradorPrimos := 2.
	numAFactorizar := self.
	[iteradorPrimos <= numAFactorizar] whileTrue: [ 
		((iteradorPrimos isPrime) and: [(self mod: iteradorPrimos) = 0])		ifTrue: [		
			primeFactors add: iteradorPrimos	.
			numAFactorizar := numAFactorizar/2.
			]
		ifFalse:[iteradorPrimos := iteradorPrimos + 1].
	].
	^primeFactors.! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test08CorrectlyFactorizesACompositeNumberWithMoreThanTwoFactors2 stamp: 'LDMAF 5/9/2022 20:25:10'!
PASSED!

game next. !

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 20:25:15'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test02FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 20:25:15'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test03FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 20:25:15'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test04CorrectlyFactorizesACompositeNumberWithTwoFactors2 stamp: 'LDMAF 5/9/2022 20:25:15'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test08CorrectlyFactorizesACompositeNumberWithMoreThanTwoFactors2 stamp: 'LDMAF 5/9/2022 20:25:15'!
PASSED!
!TDDBabyStepsPrimeFactorsTest methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 20:25:15'!
test09CorrectlyFactorizesACompositeNumberWithMoreThanOneFactorsDifferentThan2
	
	self assert: (Bag with: 3 with: 3) equals: 9 factorize
	! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test09CorrectlyFactorizesACompositeNumberWithMoreThanOneFactorsDifferentThan2 stamp: 'LDMAF 5/9/2022 20:25:15'!
PASSED!

!methodRemoval: TDDBabyStepsPrimeFactorsTest #test09CorrectlyFactorizesACompositeNumberWithMoreThanOneFactorsDifferentThan2 stamp: 'LDMAF 5/9/2022 20:25:15'!
test09CorrectlyFactorizesACompositeNumberWithMoreThanOneFactorsDifferentThan2
	
	self assert: (Bag with: 3 with: 3) equals: 9 factorize
	!
!Integer methodsFor: '*PrimeFactor' stamp: 'LDMAF 5/9/2022 20:27:10' prior: 50471397!
factorize
	| primeFactors iteradorPrimos numAFactorizar |
	primeFactors := Bag new.
	iteradorPrimos := 2.
	numAFactorizar := self.
	[iteradorPrimos <= numAFactorizar] whileTrue: [ 
		((iteradorPrimos isPrime) and: [(self mod: iteradorPrimos) = 0])		ifTrue: [		
			primeFactors add: iteradorPrimos	.
			numAFactorizar := numAFactorizar/iteradorPrimos.
			]
		ifFalse:[iteradorPrimos := iteradorPrimos + 1].
	].
	^primeFactors.! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 20:27:14'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test02FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 20:27:14'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test03FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 20:27:14'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test04CorrectlyFactorizesACompositeNumberWithTwoFactors2 stamp: 'LDMAF 5/9/2022 20:27:14'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test08CorrectlyFactorizesACompositeNumberWithMoreThanTwoFactors2 stamp: 'LDMAF 5/9/2022 20:27:14'!
PASSED!

game next.  !

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 20:27:21'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test02FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 20:27:21'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test03FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 20:27:21'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test04CorrectlyFactorizesACompositeNumberWithTwoFactors2 stamp: 'LDMAF 5/9/2022 20:27:21'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test08CorrectlyFactorizesACompositeNumberWithMoreThanTwoFactors2 stamp: 'LDMAF 5/9/2022 20:27:21'!
PASSED!
!TDDBabyStepsPrimeFactorsTest methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 20:27:21'!
test09CorrectlyFactorizesACompositeNumberWithMoreThanOneFactorsDifferentThan2
	
	self assert: (Bag with: 3 with: 3) equals: 9 factorize
	! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test09CorrectlyFactorizesACompositeNumberWithMoreThanOneFactorsDifferentThan2 stamp: 'LDMAF 5/9/2022 20:27:21'!
PASSED!

!methodRemoval: TDDBabyStepsPrimeFactorsTest #test09CorrectlyFactorizesACompositeNumberWithMoreThanOneFactorsDifferentThan2 stamp: 'LDMAF 5/9/2022 20:27:21'!
test09CorrectlyFactorizesACompositeNumberWithMoreThanOneFactorsDifferentThan2
	
	self assert: (Bag with: 3 with: 3) equals: 9 factorize
	!
!Integer methodsFor: '*PrimeFactor' stamp: 'LDMAF 5/9/2022 19:24:37' prior: 50471463!
factorize
	self = 2 ifTrue: [^Bag with: 2].
	self = 3 ifTrue: [^Bag with: 3].
	self = 4 ifTrue: [^Bag with: 2 with: 2].
	^Bag new.! !
!Integer methodsFor: '*PrimeFactor' stamp: 'LDMAF 5/9/2022 20:28:31' prior: 50471543!
factorize
	self = 2 ifTrue: [^Bag with: 2].
	self = 3 ifTrue: [^Bag with: 3].
	self = 4 ifTrue: [^Bag with: 2 with: 2].
	self = 8 ifTrue: [^Bag with: 2 with: 2 with: 8].
	^Bag new.! !
!Integer methodsFor: '*PrimeFactor' stamp: 'LDMAF 5/9/2022 20:28:35' prior: 50471550!
factorize
	self = 2 ifTrue: [^Bag with: 2].
	self = 3 ifTrue: [^Bag with: 3].
	self = 4 ifTrue: [^Bag with: 2 with: 2].
	self = 8 ifTrue: [^Bag with: 2 with: 2 with: 2].
	^Bag new.! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 20:28:39'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test02FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 20:28:39'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test03FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 20:28:39'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test04CorrectlyFactorizesACompositeNumberWithTwoFactors2 stamp: 'LDMAF 5/9/2022 20:28:39'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test08CorrectlyFactorizesACompositeNumberWithMoreThanTwoFactors2 stamp: 'LDMAF 5/9/2022 20:28:39'!
PASSED!

game next.  !

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 20:28:45'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test02FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 20:28:45'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test03FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 20:28:45'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test04CorrectlyFactorizesACompositeNumberWithTwoFactors2 stamp: 'LDMAF 5/9/2022 20:28:45'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test08CorrectlyFactorizesACompositeNumberWithMoreThanTwoFactors2 stamp: 'LDMAF 5/9/2022 20:28:45'!
PASSED!
!TDDBabyStepsPrimeFactorsTest methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 20:28:45'!
test09CorrectlyFactorizesACompositeNumberWithMoreThanOneFactorsDifferentThan2
	
	self assert: (Bag with: 3 with: 3) equals: 9 factorize
	! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test09CorrectlyFactorizesACompositeNumberWithMoreThanOneFactorsDifferentThan2 stamp: 'LDMAF 5/9/2022 20:28:45'!
FAILURE!

!methodRemoval: TDDBabyStepsPrimeFactorsTest #test09CorrectlyFactorizesACompositeNumberWithMoreThanOneFactorsDifferentThan2 stamp: 'LDMAF 5/9/2022 20:28:45'!
test09CorrectlyFactorizesACompositeNumberWithMoreThanOneFactorsDifferentThan2
	
	self assert: (Bag with: 3 with: 3) equals: 9 factorize
	!
!TDDBabyStepsPrimeFactorsTest methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 20:28:45'!
test09CorrectlyFactorizesACompositeNumberWithMoreThanOneFactorsDifferentThan2
	
	self assert: (Bag with: 3 with: 3) equals: 9 factorize
	! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test09CorrectlyFactorizesACompositeNumberWithMoreThanOneFactorsDifferentThan2 stamp: 'LDMAF 5/9/2022 20:28:45'!
FAILURE!
!Integer methodsFor: '*PrimeFactor' stamp: 'LDMAF 5/9/2022 20:28:57' prior: 50471559!
factorize
	| primeFactors iteradorPrimos numAFactorizar |
	primeFactors := Bag new.
	iteradorPrimos := 2.
	numAFactorizar := self.
	[iteradorPrimos <= numAFactorizar] whileTrue: [ 
		((iteradorPrimos isPrime) and: [(self mod: iteradorPrimos) = 0])		ifTrue: [		
			primeFactors add: iteradorPrimos	.
			numAFactorizar := numAFactorizar/iteradorPrimos.
			]
		ifFalse:[iteradorPrimos := iteradorPrimos + 1].
	].
	^primeFactors.! !

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 20:29:01'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test02FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 20:29:01'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test03FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 20:29:01'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test04CorrectlyFactorizesACompositeNumberWithTwoFactors2 stamp: 'LDMAF 5/9/2022 20:29:01'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test08CorrectlyFactorizesACompositeNumberWithMoreThanTwoFactors2 stamp: 'LDMAF 5/9/2022 20:29:01'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test09CorrectlyFactorizesACompositeNumberWithMoreThanOneFactorsDifferentThan2 stamp: 'LDMAF 5/9/2022 20:29:01'!
PASSED!

game next.!

!testRun: #TDDBabyStepsPrimeFactorsTest #test01OneHasNoPrimeFactors stamp: 'LDMAF 5/9/2022 20:29:07'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test02FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 20:29:07'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test03FactorsOfAPrimeNumberAreThePrimeNumber stamp: 'LDMAF 5/9/2022 20:29:07'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test04CorrectlyFactorizesACompositeNumberWithTwoFactors2 stamp: 'LDMAF 5/9/2022 20:29:07'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test08CorrectlyFactorizesACompositeNumberWithMoreThanTwoFactors2 stamp: 'LDMAF 5/9/2022 20:29:07'!
PASSED!

!testRun: #TDDBabyStepsPrimeFactorsTest #test09CorrectlyFactorizesACompositeNumberWithMoreThanOneFactorsDifferentThan2 stamp: 'LDMAF 5/9/2022 20:29:07'!
PASSED!
!TDDBabyStepsPrimeFactorsTest methodsFor: 'tests' stamp: 'LDMAF 5/9/2022 20:29:07'!
testExtraToCheckGeneralizationOnKata
	
	self assert: (Bag with: 2 with: 2 with: 3 with: 3 with: 5 with: 13) equals: (2*2*3*3*5*13) factorize
	! !

!testRun: #TDDBabyStepsPrimeFactorsTest #testExtraToCheckGeneralizationOnKata stamp: 'LDMAF 5/9/2022 20:29:07'!
FAILURE!

!testRun: #TDDBabyStepsPrimeFactorsTest #testExtraToCheckGeneralizationOnKata stamp: 'LDMAF 5/9/2022 20:29:43'!
FAILURE!

!testRun: #TDDBabyStepsPrimeFactorsTest #testExtraToCheckGeneralizationOnKata stamp: 'LDMAF 5/9/2022 20:29:43'!
FAILURE!
!Integer methodsFor: '*PrimeFactor' stamp: 'LDMAF 5/9/2022 20:35:55' prior: 50471645!
factorize
	| primeFactors iteradorPrimos numAFactorizar |
	primeFactors := Bag new.
	iteradorPrimos := 2.
	numAFactorizar := self.
	[iteradorPrimos <= numAFactorizar] whileTrue: [ 
		(self isDivisibleBy: iteradorPrimos)		ifTrue: [		
			primeFactors add: iteradorPrimos	.
			numAFactorizar := numAFactorizar/iteradorPrimos.
			]
		ifFalse:[iteradorPrimos := iteradorPrimos + 1].
	].
	^primeFactors.! !

!testRun: #TDDBabyStepsPrimeFactorsTest #testExtraToCheckGeneralizationOnKata stamp: 'LDMAF 5/9/2022 20:36:00'!
FAILURE!

!testRun: #TDDBabyStepsPrimeFactorsTest #testExtraToCheckGeneralizationOnKata stamp: 'LDMAF 5/9/2022 20:36:00'!
FAILURE!
!Integer methodsFor: '*PrimeFactor' stamp: 'LDMAF 5/9/2022 20:36:47' prior: 50471732!
factorize
	| primeFactors iteradorPrimos numAFactorizar |
	primeFactors := Bag new.
	iteradorPrimos := 2.
	numAFactorizar := self.
	[iteradorPrimos <= numAFactorizar] whileTrue: [ 
		(numAFactorizar isDivisibleBy: iteradorPrimos)		ifTrue: [		
			primeFactors add: iteradorPrimos	.
			numAFactorizar := numAFactorizar/iteradorPrimos.
			]
		ifFalse:[iteradorPrimos := iteradorPrimos + 1].
	].
	^primeFactors.! !

!testRun: #TDDBabyStepsPrimeFactorsTest #testExtraToCheckGeneralizationOnKata stamp: 'LDMAF 5/9/2022 20:36:51'!
PASSED!

game next. !

!testRun: #TDDBabyStepsPrimeFactorsTest #testExtraToCheckGeneralizationOnKata stamp: 'LDMAF 5/9/2022 20:37:09'!
PASSED!

game openJourney !

!testRun: #TDDBabyStepsPrimeFactorsTest #testExtraToCheckGeneralizationOnKata stamp: 'LDMAF 5/9/2022 21:04:13'!
PASSED!

----STARTUP---- (12 May 2022 18:10:04) as /home/clinux01/Cuis_University/linux64/CuisUniversity-5053.image!


halt!

TestCase subclass: #MarsRoverTests
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classDefinition: #MarsRoverTests category: 'MarsRover' stamp: 'LDMAF 5/12/2022 20:23:53'!
TestCase subclass: #MarsRoverTests
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classDefinition: #MarsRover category: 'MarsRover' stamp: 'LDMAF 5/12/2022 20:44:57'!
Object subclass: #MarsRover
	instanceVariableNames: 'position direction'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!
!MarsRoverTests methodsFor: 'nil' stamp: 'LDMAF 5/12/2022 20:44:28'!
test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: ''.
	self assert: (((marsRover position) = (0@0)) and: [marsRover heading: #south])
! !

!testRun: #MarsRoverTests #test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 20:45:06'!
ERROR!
!MarsRover methodsFor: 'command proccesing' stamp: 'LDMAF 5/12/2022 20:45:46'!
processCommand: aString 
	self shouldBeImplemented.! !
!MarsRover methodsFor: 'command proccesing' stamp: 'LDMAF 5/12/2022 20:46:00' prior: 50471255!
processCommand: aString 
	^self.! !

!testRun: #MarsRoverTests #test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 20:46:06'!
ERROR!

!testRun: #MarsRoverTests #test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 20:46:06'!
ERROR!
!MarsRover methodsFor: 'position' stamp: 'LDMAF 5/12/2022 20:46:18'!
position
	self shouldBeImplemented.
	^position! !
!MarsRover methodsFor: 'position' stamp: 'LDMAF 5/12/2022 20:46:37' prior: 50471272!
position
	^(0@0).! !

!testRun: #MarsRoverTests #test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 20:46:40'!
ERROR!
!MarsRover methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 20:46:46'!
heading: aSymbol 
	self shouldBeImplemented.! !
!MarsRover methodsFor: 'position' stamp: 'LDMAF 5/12/2022 20:47:01'!
heading 
	self shouldBeImplemented.! !

!methodRemoval: MarsRover #heading: stamp: 'LDMAF 5/12/2022 20:47:11'!
heading: aSymbol 
	self shouldBeImplemented.!
!MarsRoverTests methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 20:47:20' prior: 50471241!
test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: ''.
	self assert: (((marsRover position) = (0@0)) and: [marsRover heading = #south])
! !
!MarsRover methodsFor: 'position' stamp: 'LDMAF 5/12/2022 20:47:33' prior: 50471289!
heading 
	^#south.! !

!testRun: #MarsRoverTests #test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 20:47:36'!
PASSED!

!testRun: #MarsRoverTests #test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 20:47:49'!
PASSED!
!MarsRoverTests methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 20:51:44'!
test02RoverChangesDirectionWhenRotatesToTheLeft
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: 'l'.
	self assert: (((marsRover position) = (0@0)) and: [marsRover heading = #west])
! !

!testRun: #MarsRoverTests #test02RoverChangesDirectionWhenRotatesToTheLeft stamp: 'LDMAF 5/12/2022 20:51:47'!
FAILURE!
!MarsRover methodsFor: 'command proccesing' stamp: 'LDMAF 5/12/2022 20:53:24' prior: 50471260!
processCommand: aString 
	direction _ #west.
	^self.! !
!MarsRover methodsFor: 'position' stamp: 'LDMAF 5/12/2022 20:53:38' prior: 50471308!
heading 
	^direction.! !
!MarsRover methodsFor: 'position' stamp: 'LDMAF 5/12/2022 20:58:55' prior: 50471339!
heading 
	(direction) isNil: [^#south].
	^direction.! !
!MarsRover methodsFor: 'position' stamp: 'LDMAF 5/12/2022 20:59:04' prior: 50471343!
heading 
	direction isNil: [^#south].
	^direction.! !
!MarsRover methodsFor: 'position' stamp: 'LDMAF 5/12/2022 20:59:23' prior: 50471348!
heading 
	direction ifNil: [^#south].
	^direction.! !
!MarsRoverTests methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 21:01:14' prior: 50471298!
test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: ''.
	self assert: (marsRover isAt: (0@0) heading: #south).

! !

!testRun: #MarsRoverTests #test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:01:16'!
ERROR!
!MarsRover methodsFor: 'position' stamp: 'LDMAF 5/12/2022 21:01:24'!
isAt: aPoint heading: aSymbol 
	self shouldBeImplemented.! !
!MarsRover methodsFor: 'position' stamp: 'LDMAF 5/12/2022 21:01:59' prior: 50471371!
isAt: aPosition heading: aSymbol 
	^true.! !

!testRun: #MarsRoverTests #test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:02:00'!
PASSED!

!testRun: #MarsRoverTests #test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:02:00'!
PASSED!

!testRun: #MarsRoverTests #test02RoverChangesDirectionWhenRotatesToTheLeft stamp: 'LDMAF 5/12/2022 21:02:00'!
PASSED!

!testRun: #MarsRoverTests #test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:02:06'!
PASSED!

!testRun: #MarsRoverTests #test02RoverChangesDirectionWhenRotatesToTheLeft stamp: 'LDMAF 5/12/2022 21:02:06'!
PASSED!
!MarsRoverTests methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 21:02:43' prior: 50471320!
test02RoverChangesDirectionWhenRotatesToTheLeft
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: 'l'.
	self assert: (marsRover isAt: (0@0) heading: #west)
! !

!testRun: #MarsRoverTests #test02RoverChangesDirectionWhenRotatesToTheLeft stamp: 'LDMAF 5/12/2022 21:02:45'!
PASSED!

!testRun: #MarsRoverTests #test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:02:45'!
PASSED!

!testRun: #MarsRoverTests #test02RoverChangesDirectionWhenRotatesToTheLeft stamp: 'LDMAF 5/12/2022 21:02:45'!
PASSED!
!MarsRover methodsFor: 'position' stamp: 'LDMAF 5/12/2022 21:05:35' prior: 50471376!
isAt: aPosition heading: aDirection
	^(aPosition = (0@0) and: [aDirection = #sout]).! !

!testRun: #MarsRoverTests #test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:05:41'!
FAILURE!

!testRun: #MarsRoverTests #test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:05:41'!
FAILURE!
!MarsRover methodsFor: 'position' stamp: 'LDMAF 5/12/2022 21:05:58' prior: 50471421!
isAt: aPosition heading: aDirection
	^(aPosition = (0@0) and: [aDirection = #south]).! !

!testRun: #MarsRoverTests #test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:06:02'!
PASSED!

!testRun: #MarsRoverTests #test02RoverChangesDirectionWhenRotatesToTheLeft stamp: 'LDMAF 5/12/2022 21:06:07'!
FAILURE!

!testRun: #MarsRoverTests #test02RoverChangesDirectionWhenRotatesToTheLeft stamp: 'LDMAF 5/12/2022 21:06:07'!
FAILURE!

!methodRemoval: MarsRover #position stamp: 'LDMAF 5/12/2022 21:06:19'!
position
	^(0@0).!

!methodRemoval: MarsRover #heading stamp: 'LDMAF 5/12/2022 21:06:25'!
heading 
	direction ifNil: [^#south].
	^direction.!

Object subclass: #MarsRover
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classDefinition: #MarsRover category: 'MarsRover' stamp: 'LDMAF 5/12/2022 21:06:32'!
Object subclass: #MarsRover
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!testRun: #MarsRoverTests #test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:06:36'!
PASSED!

!testRun: #MarsRoverTests #test02RoverChangesDirectionWhenRotatesToTheLeft stamp: 'LDMAF 5/12/2022 21:06:38'!
FAILURE!

!testRun: #MarsRoverTests #test02RoverChangesDirectionWhenRotatesToTheLeft stamp: 'LDMAF 5/12/2022 21:06:38'!
FAILURE!
!MarsRover methodsFor: 'position' stamp: 'LDMAF 5/12/2022 21:09:24' prior: 50471435!
isAt: aPosition heading: aDirection
	(aDirection = #south) ifTrue: [^aPosition = 0@0].
	(aDirection = #west) ifTrue: [^aPosition = 0@0].! !

!testRun: #MarsRoverTests #test02RoverChangesDirectionWhenRotatesToTheLeft stamp: 'LDMAF 5/12/2022 21:09:32'!
ERROR!

!testRun: #MarsRoverTests #test02RoverChangesDirectionWhenRotatesToTheLeft stamp: 'LDMAF 5/12/2022 21:09:32'!
ERROR!
!MarsRover methodsFor: 'position' stamp: 'LDMAF 5/12/2022 21:09:49' prior: 50471481!
isAt: aPosition heading: aDirection
	(aDirection = #south) ifTrue: [^aPosition = (0@0)].
	(aDirection = #west) ifTrue: [^aPosition = (0@0)].! !

!testRun: #MarsRoverTests #test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:09:52'!
PASSED!

!testRun: #MarsRoverTests #test02RoverChangesDirectionWhenRotatesToTheLeft stamp: 'LDMAF 5/12/2022 21:09:52'!
PASSED!
!MarsRoverTests methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 21:10:27'!
test03RoverChangesDirectionWhenRotatesToTheRight
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: 'l'.
	self assert: (marsRover isAt: (0@0) heading: #east)
! !

!testRun: #MarsRoverTests #test03RoverChangesDirectionWhenRotatesToTheRight stamp: 'LDMAF 5/12/2022 21:12:02'!
ERROR!

!testRun: #MarsRoverTests #test03RoverChangesDirectionWhenRotatesToTheRight stamp: 'LDMAF 5/12/2022 21:12:02'!
ERROR!
!MarsRoverTests methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 21:14:56'!
test02RoverLeftRotationFromSouthIsWest
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: 'l'.
	self assert: (marsRover isAt: (0@0) heading: #west)
! !

!methodRemoval: MarsRoverTests #test02RoverChangesDirectionWhenRotatesToTheLeft stamp: 'LDMAF 5/12/2022 21:14:56'!
test02RoverChangesDirectionWhenRotatesToTheLeft
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: 'l'.
	self assert: (marsRover isAt: (0@0) heading: #west)
!
!MarsRoverTests methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 21:15:16'!
test03RoverRightRotationFromSouthIsEast
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: 'l'.
	self assert: (marsRover isAt: (0@0) heading: #east)
! !

!methodRemoval: MarsRoverTests #test03RoverChangesDirectionWhenRotatesToTheRight stamp: 'LDMAF 5/12/2022 21:15:16'!
test03RoverChangesDirectionWhenRotatesToTheRight
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: 'l'.
	self assert: (marsRover isAt: (0@0) heading: #east)
!

!testRun: #MarsRoverTests #test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:15:24'!
PASSED!

!testRun: #MarsRoverTests #test02RoverLeftRotationFromSouthIsWest stamp: 'LDMAF 5/12/2022 21:15:24'!
PASSED!

!testRun: #MarsRoverTests #test03RoverRightRotationFromSouthIsEast stamp: 'LDMAF 5/12/2022 21:15:24'!
ERROR!

!testRun: #MarsRoverTests #test03RoverRightRotationFromSouthIsEast stamp: 'LDMAF 5/12/2022 21:15:24'!
ERROR!
!MarsRover methodsFor: 'position' stamp: 'LDMAF 5/12/2022 21:15:54' prior: 50471496!
isAt: aPosition heading: aDirection
	(aDirection = #south) ifTrue: [^aPosition = (0@0)].
	(aDirection = #west) ifTrue: [^aPosition = (0@0)].
	(aDirection = #east) ifTrue: [^aPosition = (0@0)].! !

!testRun: #MarsRoverTests #test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:15:57'!
PASSED!

!testRun: #MarsRoverTests #test02RoverLeftRotationFromSouthIsWest stamp: 'LDMAF 5/12/2022 21:15:57'!
PASSED!

!testRun: #MarsRoverTests #test03RoverRightRotationFromSouthIsEast stamp: 'LDMAF 5/12/2022 21:15:57'!
PASSED!
!MarsRoverTests methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 21:16:51'!
test02RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: ''.
	self assert: (marsRover isAt: (0@0) heading: #south).

! !

!methodRemoval: MarsRoverTests #test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:16:51'!
test01RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: ''.
	self assert: (marsRover isAt: (0@0) heading: #south).

!
!MarsRoverTests methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 21:17:10'!
test03RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: ''.
	self assert: (marsRover isAt: (0@0) heading: #south).

! !

!methodRemoval: MarsRoverTests #test02RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:17:10'!
test02RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: ''.
	self assert: (marsRover isAt: (0@0) heading: #south).

!
!MarsRoverTests methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 21:17:30'!
test04RoverLeftRotationFromSouthIsWest
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: 'l'.
	self assert: (marsRover isAt: (0@0) heading: #west)
! !

!methodRemoval: MarsRoverTests #test02RoverLeftRotationFromSouthIsWest stamp: 'LDMAF 5/12/2022 21:17:30'!
test02RoverLeftRotationFromSouthIsWest
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: 'l'.
	self assert: (marsRover isAt: (0@0) heading: #west)
!
!MarsRoverTests methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 21:17:38'!
test02RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: ''.
	self assert: (marsRover isAt: (0@0) heading: #south).

! !

!methodRemoval: MarsRoverTests #test03RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:17:38'!
test03RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: ''.
	self assert: (marsRover isAt: (0@0) heading: #south).

!
!MarsRoverTests methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 21:18:14'!
test01RoverBefereProccesingCommandStartsAtOriginHeadingSouth

! !
!MarsRoverTests methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 21:18:27'!
test01RoverBeforeProccesingCommandStartsAtOriginHeadingSouth

! !

!methodRemoval: MarsRoverTests #test01RoverBefereProccesingCommandStartsAtOriginHeadingSouth stamp: 'LDMAF 5/12/2022 21:18:27'!
test01RoverBefereProccesingCommandStartsAtOriginHeadingSouth

!
!MarsRoverTests methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 21:18:43' prior: 50471679!
test01RoverBeforeProccesingCommandStartsAtOriginHeadingSouth
	|rover|
	rover _ MarsRover new.
! !
!MarsRoverTests methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 21:19:19' prior: 50471691!
test01RoverBeforeProccesingCommandStartsAtOriginHeadingSouth
	|rover|
	rover _ MarsRover new.
	self assert: (rover isAt: (0@0) heading: #south)
! !

!testRun: #MarsRoverTests #test01RoverBeforeProccesingCommandStartsAtOriginHeadingSouth stamp: 'LDMAF 5/12/2022 21:19:21'!
PASSED!

!testRun: #MarsRoverTests #test01RoverBeforeProccesingCommandStartsAtOriginHeadingSouth stamp: 'LDMAF 5/12/2022 21:19:25'!
PASSED!

!testRun: #MarsRoverTests #test01RoverBeforeProccesingCommandStartsAtOriginHeadingSouth stamp: 'LDMAF 5/12/2022 21:19:25'!
PASSED!

!testRun: #MarsRoverTests #test02RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:19:25'!
PASSED!

!testRun: #MarsRoverTests #test03RoverRightRotationFromSouthIsEast stamp: 'LDMAF 5/12/2022 21:19:25'!
PASSED!

!testRun: #MarsRoverTests #test04RoverLeftRotationFromSouthIsWest stamp: 'LDMAF 5/12/2022 21:19:25'!
PASSED!
!MarsRoverTests methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 21:22:19'!
test04RoverTwoLeftRotationsFromSouthIsNorth
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: 'l'.
	self assert: (marsRover isAt: (0@0) heading: #west)
! !
!MarsRoverTests methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 21:23:33'!
test05RoverTwoLeftRotationsFromSouthIsNorth
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: 'l'.
	self assert: (marsRover isAt: (0@0) heading: #west)
! !

!methodRemoval: MarsRoverTests #test04RoverTwoLeftRotationsFromSouthIsNorth stamp: 'LDMAF 5/12/2022 21:23:33'!
test04RoverTwoLeftRotationsFromSouthIsNorth
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: 'l'.
	self assert: (marsRover isAt: (0@0) heading: #west)
!
!MarsRoverTests methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 21:24:19' prior: 50471738!
test05RoverTwoLeftRotationsFromSouthIsNorth
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: 'll'.
	self assert: (marsRover isAt: (0@0) heading: #north)
! !

!testRun: #MarsRoverTests #test05RoverTwoLeftRotationsFromSouthIsNorth stamp: 'LDMAF 5/12/2022 21:24:20'!
ERROR!

!testRun: #MarsRoverTests #test05RoverTwoLeftRotationsFromSouthIsNorth stamp: 'LDMAF 5/12/2022 21:24:26'!
ERROR!

!testRun: #MarsRoverTests #test05RoverTwoLeftRotationsFromSouthIsNorth stamp: 'LDMAF 5/12/2022 21:24:26'!
ERROR!
!MarsRover methodsFor: 'command proccesing' stamp: 'LDMAF 5/12/2022 21:24:40' prior: 50471334!
processCommand: aString 
	^self.! !
!MarsRover methodsFor: 'position' stamp: 'LDMAF 5/12/2022 21:24:55' prior: 50471577!
isAt: aPosition heading: aDirection
	(aDirection = #south) ifTrue: [^aPosition = (0@0)].
	(aDirection = #west) ifTrue: [^aPosition = (0@0)].
	(aDirection = #east) ifTrue: [^aPosition = (0@0)].
	^false.! !

!testRun: #MarsRoverTests #test01RoverBeforeProccesingCommandStartsAtOriginHeadingSouth stamp: 'LDMAF 5/12/2022 21:25:03'!
PASSED!

!testRun: #MarsRoverTests #test02RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:25:03'!
PASSED!

!testRun: #MarsRoverTests #test03RoverRightRotationFromSouthIsEast stamp: 'LDMAF 5/12/2022 21:25:03'!
PASSED!

!testRun: #MarsRoverTests #test04RoverLeftRotationFromSouthIsWest stamp: 'LDMAF 5/12/2022 21:25:03'!
PASSED!

!testRun: #MarsRoverTests #test05RoverTwoLeftRotationsFromSouthIsNorth stamp: 'LDMAF 5/12/2022 21:25:03'!
FAILURE!

!testRun: #MarsRoverTests #test05RoverTwoLeftRotationsFromSouthIsNorth stamp: 'LDMAF 5/12/2022 21:25:03'!
FAILURE!
!MarsRover methodsFor: 'position' stamp: 'LDMAF 5/12/2022 21:25:21' prior: 50471780!
isAt: aPosition heading: aDirection
	(aDirection = #south) ifTrue: [^aPosition = (0@0)].
	(aDirection = #west) ifTrue: [^aPosition = (0@0)].
	(aDirection = #east) ifTrue: [^aPosition = (0@0)].
	(aDirection = #north) ifTrue: [^aPosition = (0@0)].
	^false.! !

!testRun: #MarsRoverTests #test01RoverBeforeProccesingCommandStartsAtOriginHeadingSouth stamp: 'LDMAF 5/12/2022 21:25:25'!
PASSED!

!testRun: #MarsRoverTests #test02RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:25:25'!
PASSED!

!testRun: #MarsRoverTests #test03RoverRightRotationFromSouthIsEast stamp: 'LDMAF 5/12/2022 21:25:25'!
PASSED!

!testRun: #MarsRoverTests #test04RoverLeftRotationFromSouthIsWest stamp: 'LDMAF 5/12/2022 21:25:25'!
PASSED!

!testRun: #MarsRoverTests #test05RoverTwoLeftRotationsFromSouthIsNorth stamp: 'LDMAF 5/12/2022 21:25:25'!
PASSED!

!testRun: #MarsRoverTests #test05RoverTwoLeftRotationsFromSouthIsNorth stamp: 'LDMAF 5/12/2022 21:28:41'!
PASSED!

Object subclass: #MarsRover
	instanceVariableNames: 'position direction'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classDefinition: #MarsRover category: 'MarsRover' stamp: 'LDMAF 5/12/2022 21:29:50'!
Object subclass: #MarsRover
	instanceVariableNames: 'position direction'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!
!MarsRover methodsFor: 'nil' stamp: 'LDMAF 5/12/2022 21:30:24' overrides: 16920235!
initialize
	position _ (0@0).
	direction _ #south.! !
!MarsRover methodsFor: 'position' stamp: 'LDMAF 5/12/2022 21:31:48' prior: 50471812!
isAt: aPosition heading: aDirection
	^(direction = aDirection) and: [aPosition = (0@0)].! !

!testRun: #MarsRoverTests #test01RoverBeforeProccesingCommandStartsAtOriginHeadingSouth stamp: 'LDMAF 5/12/2022 21:31:49'!
PASSED!

!testRun: #MarsRoverTests #test02RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:31:49'!
PASSED!

!testRun: #MarsRoverTests #test03RoverRightRotationFromSouthIsEast stamp: 'LDMAF 5/12/2022 21:31:49'!
FAILURE!

!testRun: #MarsRoverTests #test04RoverLeftRotationFromSouthIsWest stamp: 'LDMAF 5/12/2022 21:31:49'!
FAILURE!

!testRun: #MarsRoverTests #test05RoverTwoLeftRotationsFromSouthIsNorth stamp: 'LDMAF 5/12/2022 21:31:49'!
FAILURE!
!MarsRover methodsFor: 'command proccesing' stamp: 'LDMAF 5/12/2022 21:32:29' prior: 50471776!
processCommand: aCommand
	
	^self.! !
!MarsRover methodsFor: 'command proccesing' stamp: 'LDMAF 5/12/2022 21:35:57' prior: 50471887!
processCommand: aCommand
	(aCommand = 'l') ifTrue: [
		(direction = #south) ifTrue: [direction _ #west].
		(direction = #west) ifTrue: [direction _ #north].
		(direction = #north) ifTrue: [direction _ #east].
		(direction = #east) ifTrue: [direction _ #south].
	].
	(aCommand = 'll') ifTrue: [
		(direction = #south) ifTrue: [direction _ #north].
		(direction = #west) ifTrue: [direction _ #east].
		(direction = #north) ifTrue: [direction _ #south].
		(direction = #east) ifTrue: [direction _ #west].
	].
	^self.! !

!testRun: #MarsRoverTests #test01RoverBeforeProccesingCommandStartsAtOriginHeadingSouth stamp: 'LDMAF 5/12/2022 21:36:01'!
PASSED!

!testRun: #MarsRoverTests #test02RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:36:01'!
PASSED!

!testRun: #MarsRoverTests #test03RoverRightRotationFromSouthIsEast stamp: 'LDMAF 5/12/2022 21:36:01'!
FAILURE!

!testRun: #MarsRoverTests #test04RoverLeftRotationFromSouthIsWest stamp: 'LDMAF 5/12/2022 21:36:01'!
FAILURE!

!testRun: #MarsRoverTests #test05RoverTwoLeftRotationsFromSouthIsNorth stamp: 'LDMAF 5/12/2022 21:36:01'!
FAILURE!

!testRun: #MarsRoverTests #test02RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:36:33'!
PASSED!

!testRun: #MarsRoverTests #test03RoverRightRotationFromSouthIsEast stamp: 'LDMAF 5/12/2022 21:36:37'!
FAILURE!

!testRun: #MarsRoverTests #test03RoverRightRotationFromSouthIsEast stamp: 'LDMAF 5/12/2022 21:36:37'!
FAILURE!
!MarsRoverTests methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 21:37:01' prior: 50471545!
test03RoverRightRotationFromSouthIsEast
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: 'r'.
	self assert: (marsRover isAt: (0@0) heading: #east)
! !
!MarsRover methodsFor: 'command proccesing' stamp: 'LDMAF 5/12/2022 21:37:19' prior: 50471892!
processCommand: aCommand
	(aCommand = 'l') ifTrue: [
		(direction = #south) ifTrue: [direction _ #west].
		(direction = #west) ifTrue: [direction _ #north].
		(direction = #north) ifTrue: [direction _ #east].
		(direction = #east) ifTrue: [direction _ #south].
	].
	(aCommand = 'll') ifTrue: [
		(direction = #south) ifTrue: [direction _ #north].
		(direction = #west) ifTrue: [direction _ #east].
		(direction = #north) ifTrue: [direction _ #south].
		(direction = #east) ifTrue: [direction _ #west].
	].
	(aCommand = 'r') ifTrue: [
		(direction = #south) ifTrue: [direction _ #west].
		(direction = #west) ifTrue: [direction _ #north].
		(direction = #north) ifTrue: [direction _ #east].
		(direction = #east) ifTrue: [direction _ #south].
	].
	^self.! !
!MarsRover methodsFor: 'command proccesing' stamp: 'LDMAF 5/12/2022 21:39:21' prior: 50471951!
processCommand: aCommand
	(aCommand = 'l') ifTrue: [
		(direction = #south) ifTrue: [direction _ #west].
		(direction = #west) ifTrue: [direction _ #north].
		(direction = #north) ifTrue: [direction _ #east].
		(direction = #east) ifTrue: [direction _ #south].
	].
	(aCommand = 'll') ifTrue: [
		(direction = #south) ifTrue: [direction _ #north].
		(direction = #west) ifTrue: [direction _ #east].
		(direction = #north) ifTrue: [direction _ #south].
		(direction = #east) ifTrue: [direction _ #west].
	].
	(aCommand = 'r') ifTrue: [
		(direction = #south) ifTrue: [direction _ #east].
		(direction = #west) ifTrue: [direction _ #south].
		(direction = #north) ifTrue: [direction _ #west].
		(direction = #east) ifTrue: [direction _ #north].
	].
	^self.! !

!testRun: #MarsRoverTests #test01RoverBeforeProccesingCommandStartsAtOriginHeadingSouth stamp: 'LDMAF 5/12/2022 21:39:23'!
PASSED!

!testRun: #MarsRoverTests #test02RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:39:23'!
PASSED!

!testRun: #MarsRoverTests #test03RoverRightRotationFromSouthIsEast stamp: 'LDMAF 5/12/2022 21:39:23'!
FAILURE!

!testRun: #MarsRoverTests #test04RoverLeftRotationFromSouthIsWest stamp: 'LDMAF 5/12/2022 21:39:23'!
FAILURE!

!testRun: #MarsRoverTests #test05RoverTwoLeftRotationsFromSouthIsNorth stamp: 'LDMAF 5/12/2022 21:39:23'!
FAILURE!

!testRun: #MarsRoverTests #test03RoverRightRotationFromSouthIsEast stamp: 'LDMAF 5/12/2022 21:39:46'!
FAILURE!

!testRun: #MarsRoverTests #test03RoverRightRotationFromSouthIsEast stamp: 'LDMAF 5/12/2022 21:39:46'!
FAILURE!
!MarsRover methodsFor: 'command proccesing' stamp: 'LDMAF 5/12/2022 21:41:34' prior: 50471978!
processCommand: aCommand
	(aCommand = 'l') ifTrue: [
		(direction = #south) ifTrue: [direction _ #west].
		(direction = #west) ifTrue: [direction _ #north].
		(direction = #north) ifTrue: [direction _ #east].
		(direction = #east) ifTrue: [direction _ #south].
	].
	(aCommand = 'll') ifTrue: [
		(direction = #south) ifTrue: [direction _ #north].
		(direction = #west) ifTrue: [direction _ #east].
		(direction = #north) ifTrue: [direction _ #south].
		(direction = #east) ifTrue: [direction _ #west].
	].
	(aCommand = 'r') ifTrue: [
		(direction = #south) ifTrue: [direction _ #east. ^self].
		(direction = #west) ifTrue: [direction _ #south].
		(direction = #north) ifTrue: [direction _ #west].
		(direction = #east) ifTrue: [direction _ #north].
	].
	^self.! !

!testRun: #MarsRoverTests #test03RoverRightRotationFromSouthIsEast stamp: 'LDMAF 5/12/2022 21:41:38'!
PASSED!
!MarsRover methodsFor: 'command proccesing' stamp: 'LDMAF 5/12/2022 21:42:04' prior: 50472031!
processCommand: aCommand
	(aCommand = 'l') ifTrue: [
		(direction = #south) ifTrue: [direction _ #west. ^self].
		(direction = #west) ifTrue: [direction _ #north. ^self].
		(direction = #north) ifTrue: [direction _ #east. ^self].
		(direction = #east) ifTrue: [direction _ #south. ^self].
	].
	(aCommand = 'll') ifTrue: [
		(direction = #south) ifTrue: [direction _ #north. ^self].
		(direction = #west) ifTrue: [direction _ #east. ^self].
		(direction = #north) ifTrue: [direction _ #south. ^self].
		(direction = #east) ifTrue: [direction _ #west. ^self].
	].
	(aCommand = 'r') ifTrue: [
		(direction = #south) ifTrue: [direction _ #east. ^self].
		(direction = #west) ifTrue: [direction _ #south. ^self].
		(direction = #north) ifTrue: [direction _ #west. ^self].
		(direction = #east) ifTrue: [direction _ #north. ^self].
	].
	^self.! !

!testRun: #MarsRoverTests #test01RoverBeforeProccesingCommandStartsAtOriginHeadingSouth stamp: 'LDMAF 5/12/2022 21:42:06'!
PASSED!

!testRun: #MarsRoverTests #test02RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:42:06'!
PASSED!

!testRun: #MarsRoverTests #test03RoverRightRotationFromSouthIsEast stamp: 'LDMAF 5/12/2022 21:42:06'!
PASSED!

!testRun: #MarsRoverTests #test04RoverLeftRotationFromSouthIsWest stamp: 'LDMAF 5/12/2022 21:42:06'!
PASSED!

!testRun: #MarsRoverTests #test05RoverTwoLeftRotationsFromSouthIsNorth stamp: 'LDMAF 5/12/2022 21:42:06'!
PASSED!
!MarsRoverTests methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 21:43:13'!
test05RoverTwoRightRotationsFromSouthIsNorth
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: 'll'.
	self assert: (marsRover isAt: (0@0) heading: #north)
! !
!MarsRoverTests methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 21:43:17' prior: 50472110!
test05RoverTwoRightRotationsFromSouthIsNorth
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: 'rr'.
	self assert: (marsRover isAt: (0@0) heading: #north)
! !

!testRun: #MarsRoverTests #test05RoverTwoRightRotationsFromSouthIsNorth stamp: 'LDMAF 5/12/2022 21:43:20'!
FAILURE!

!testRun: #MarsRoverTests #test05RoverTwoRightRotationsFromSouthIsNorth stamp: 'LDMAF 5/12/2022 21:43:20'!
FAILURE!
!MarsRover methodsFor: 'command proccesing' stamp: 'LDMAF 5/12/2022 21:43:38' prior: 50472062!
processCommand: aCommand
	(aCommand = 'l') ifTrue: [
		(direction = #south) ifTrue: [direction _ #west. ^self].
		(direction = #west) ifTrue: [direction _ #north. ^self].
		(direction = #north) ifTrue: [direction _ #east. ^self].
		(direction = #east) ifTrue: [direction _ #south. ^self].
	].
	(aCommand = 'll') ifTrue: [
		(direction = #south) ifTrue: [direction _ #north. ^self].
		(direction = #west) ifTrue: [direction _ #east. ^self].
		(direction = #north) ifTrue: [direction _ #south. ^self].
		(direction = #east) ifTrue: [direction _ #west. ^self].
	].
	(aCommand = 'r') ifTrue: [
		(direction = #south) ifTrue: [direction _ #east. ^self].
		(direction = #west) ifTrue: [direction _ #south. ^self].
		(direction = #north) ifTrue: [direction _ #west. ^self].
		(direction = #east) ifTrue: [direction _ #north. ^self].
	].
	(aCommand = 'r') ifTrue: [
		(direction = #south) ifTrue: [direction _ #east. ^self].
		(direction = #west) ifTrue: [direction _ #south. ^self].
		(direction = #north) ifTrue: [direction _ #west. ^self].
		(direction = #east) ifTrue: [direction _ #north. ^self].
	].
	^self.! !
!MarsRover methodsFor: 'command proccesing' stamp: 'LDMAF 5/12/2022 21:44:37' prior: 50472136!
processCommand: aCommand
	(aCommand = 'l') ifTrue: [
		(direction = #south) ifTrue: [direction _ #west. ^self].
		(direction = #west) ifTrue: [direction _ #north. ^self].
		(direction = #north) ifTrue: [direction _ #east. ^self].
		(direction = #east) ifTrue: [direction _ #south. ^self].
	].
	(aCommand = 'll') ifTrue: [
		(direction = #south) ifTrue: [direction _ #north. ^self].
		(direction = #west) ifTrue: [direction _ #east. ^self].
		(direction = #north) ifTrue: [direction _ #south. ^self].
		(direction = #east) ifTrue: [direction _ #west. ^self].
	].
	(aCommand = 'r') ifTrue: [
		(direction = #south) ifTrue: [direction _ #east. ^self].
		(direction = #west) ifTrue: [direction _ #south. ^self].
		(direction = #north) ifTrue: [direction _ #west. ^self].
		(direction = #east) ifTrue: [direction _ #north. ^self].
	].
	(aCommand = 'rr') ifTrue: [
		(direction = #south) ifTrue: [direction _ #north. ^self].
		(direction = #west) ifTrue: [direction _ #east. ^self].
		(direction = #north) ifTrue: [direction _ #south. ^self].
		(direction = #east) ifTrue: [direction _ #west. ^self].
	].
	^self.! !
!MarsRoverTests methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/12/2022 21:44:50'!
test06RoverTwoRightRotationsFromSouthIsNorth
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: 'rr'.
	self assert: (marsRover isAt: (0@0) heading: #north)
! !

!methodRemoval: MarsRoverTests #test05RoverTwoRightRotationsFromSouthIsNorth stamp: 'LDMAF 5/12/2022 21:44:50'!
test05RoverTwoRightRotationsFromSouthIsNorth
	
	| marsRover |
	
	marsRover := MarsRover new.
	marsRover processCommand: 'rr'.
	self assert: (marsRover isAt: (0@0) heading: #north)
!

!testRun: #MarsRoverTests #test06RoverTwoRightRotationsFromSouthIsNorth stamp: 'LDMAF 5/12/2022 21:45:00'!
PASSED!

!testRun: #MarsRoverTests #test01RoverBeforeProccesingCommandStartsAtOriginHeadingSouth stamp: 'LDMAF 5/12/2022 21:45:00'!
PASSED!

!testRun: #MarsRoverTests #test02RoverStaysAtOriginWhenReceivesEmptyStringHeadingSouth stamp: 'LDMAF 5/12/2022 21:45:00'!
PASSED!

!testRun: #MarsRoverTests #test03RoverRightRotationFromSouthIsEast stamp: 'LDMAF 5/12/2022 21:45:00'!
PASSED!

!testRun: #MarsRoverTests #test04RoverLeftRotationFromSouthIsWest stamp: 'LDMAF 5/12/2022 21:45:00'!
PASSED!

!testRun: #MarsRoverTests #test05RoverTwoLeftRotationsFromSouthIsNorth stamp: 'LDMAF 5/12/2022 21:45:00'!
PASSED!

!testRun: #MarsRoverTests #test06RoverTwoRightRotationsFromSouthIsNorth stamp: 'LDMAF 5/12/2022 21:45:00'!
PASSED!

----QUIT----(12 May 2022 21:54:47) CuisUniversity-5053.image priorSource: 4466109!

----STARTUP---- (16 May 2022 17:13:56) as /home/clinux01/Cuis_University/linux64/CuisUniversity-5053.image!


----End fileIn of /home/clinux01/Cuis_University/linux64/ISW1-2022-1C-Parcial-1.st----!

----STARTUP---- (16 May 2022 19:01:12) as /home/clinux01/Cuis_University/linux64/CuisUniversity-5053.image!


----End fileIn of /home/clinux01/Cuis_University/linux64/MarsRover.st----!

!classRemoval: #MarsRoverMovementSystem stamp: 'LDMAF 5/16/2022 19:04:03'!
Object subclass: #MarsRoverMovementSystem
	instanceVariableNames: 'cardinalMovement'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classRemoval: #RightRotateCommand stamp: 'LDMAF 5/16/2022 19:04:03'!
MarsRoverCommand subclass: #RightRotateCommand
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classRemoval: #LeftRotateCommand stamp: 'LDMAF 5/16/2022 19:04:04'!
MarsRoverCommand subclass: #LeftRotateCommand
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classRemoval: #ForwardCommand stamp: 'LDMAF 5/16/2022 19:04:04'!
MarsRoverCommand subclass: #ForwardCommand
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classRemoval: #BackwardCommand stamp: 'LDMAF 5/16/2022 19:04:04'!
MarsRoverCommand subclass: #BackwardCommand
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classRemoval: #MarsRoverCommand stamp: 'LDMAF 5/16/2022 19:04:04'!
Object subclass: #MarsRoverCommand
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classRemoval: #MarsRover stamp: 'LDMAF 5/16/2022 19:04:05'!
Object subclass: #MarsRover
	instanceVariableNames: 'movementSystem location'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classRemoval: #CartesianPosition stamp: 'LDMAF 5/16/2022 19:04:05'!
Object subclass: #CartesianPosition
	instanceVariableNames: 'marker'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classRemoval: #WestPointMovement stamp: 'LDMAF 5/16/2022 19:04:05'!
CardinalMovement subclass: #WestPointMovement
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classRemoval: #SouthPointMovement stamp: 'LDMAF 5/16/2022 19:04:06'!
CardinalMovement subclass: #SouthPointMovement
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classRemoval: #NorthPointMovement stamp: 'LDMAF 5/16/2022 19:04:06'!
CardinalMovement subclass: #NorthPointMovement
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classRemoval: #EastPointMovement stamp: 'LDMAF 5/16/2022 19:04:06'!
CardinalMovement subclass: #EastPointMovement
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classRemoval: #CardinalMovement stamp: 'LDMAF 5/16/2022 19:04:06'!
Object subclass: #CardinalMovement
	instanceVariableNames: 'direction'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classRemoval: #West stamp: 'LDMAF 5/16/2022 19:04:07'!
CardinalDirection subclass: #West
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classRemoval: #South stamp: 'LDMAF 5/16/2022 19:04:07'!
CardinalDirection subclass: #South
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classRemoval: #North stamp: 'LDMAF 5/16/2022 19:04:07'!
CardinalDirection subclass: #North
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classRemoval: #East stamp: 'LDMAF 5/16/2022 19:04:07'!
CardinalDirection subclass: #East
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classRemoval: #CardinalDirection stamp: 'LDMAF 5/16/2022 19:04:08'!
Object subclass: #CardinalDirection
	instanceVariableNames: 'direction'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classRemoval: #MarsRoverTests stamp: 'LDMAF 5/16/2022 19:04:08'!
TestCase subclass: #MarsRoverTests
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classRemoval: #MarsRoverTest stamp: 'LDMAF 5/16/2022 19:04:08'!
TestCase subclass: #MarsRoverTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

----End fileIn of /home/clinux01/Cuis_University/linux64/MarsRover.st----!
!Behavior method!
heading: aCardinalDirection
	^ [
	([
	(self coverAll:
		{31 to: 34}) new ] valueCoveringAll:
		{36 to: 38}) heading:
		(aCardinalDirection
			cover: (49 to: 66)
			declaredAt: (10 to: 27)) ] valueCoveringAll:
		{40 to: 47}.! !
!Behavior method!
heading: aCardinalDirection
	(location _ [
	(CartesianPosition
		cover: (41 to: 57)
		declaredAt: (41 to: 57)) new ] valueCoveringAll:
		{59 to: 61})
		cover: (30 to: 37)
		declaredAt: (30 to: 37).
	(movementSystem _ [
	(MarsRoverMovementSystem
		cover: (82 to: 104)
		declaredAt: (82 to: 104)) with:
		(aCardinalDirection
			cover: (112 to: 129)
			declaredAt: (10 to: 27)) ] valueCoveringAll:
		{106 to: 110})
		cover: (65 to: 78)
		declaredAt: (65 to: 78).
	^ self coverAll:
		{134 to: 137}.! !
!Behavior method!
initialize
	"In order to simplify the model, we've decided to always start at Origin = <0,0>."
	(marker _ [
	(0 coverAll:
		{106 to: 106}) @
		(0 coverAll:
			{108 to: 108}) ] valueCoveringAll:
		{107 to: 107})
		cover: (97 to: 102)
		declaredAt: (97 to: 102).! !
!Behavior method!
with: aDirection
	^ [
	([
	(self coverAll:
		{20 to: 23}) new ] valueCoveringAll:
		{25 to: 27}) withDirection:
		([
		([
		([
		(CardinalMovement
			cover: (45 to: 60)
			declaredAt: (45 to: 60)) subclasses ] valueCoveringAll:
			{62 to: 71}) detect: [ :aCardinalMovementDirection |
			[
			(aCardinalMovementDirection
				cover: (113 to: 138)
				declaredAt: (83 to: 108)) canHandle:
				(aDirection
					cover: (151 to: 160)
					declaredAt: (7 to: 16)) ] valueCoveringAll:
				{140 to: 149} ]] valueCoveringAll:
			{73 to: 79}) new ] valueCoveringAll:
			{166 to: 168}) ] valueCoveringAll:
		{29 to: 42}.! !
!Behavior method!
canHandle: aCardinalDirection
	^ [
	(aCardinalDirection
		cover: (34 to: 51)
		declaredAt: (12 to: 29)) isKindOf:
		([
		(East
			cover: (63 to: 66)
			declaredAt: (63 to: 66)) class ] valueCoveringAll:
			{68 to: 72}) ] valueCoveringAll:
		{53 to: 61}.! !
!Behavior method!
canHandle: aCardinalDirection
	^ [
	(aCardinalDirection
		cover: (34 to: 51)
		declaredAt: (12 to: 29)) isKindOf:
		([
		(North
			cover: (63 to: 67)
			declaredAt: (63 to: 67)) class ] valueCoveringAll:
			{69 to: 73}) ] valueCoveringAll:
		{53 to: 61}.! !
!Behavior method!
canHandle: aCardinalDirection
	^ [
	(aCardinalDirection
		cover: (34 to: 51)
		declaredAt: (12 to: 29)) isKindOf:
		([
		(South
			cover: (63 to: 67)
			declaredAt: (63 to: 67)) class ] valueCoveringAll:
			{69 to: 73}) ] valueCoveringAll:
		{53 to: 61}.! !
!Behavior method!
initialize
	(direction _ [
	(CardinalDirection
		cover: (25 to: 41)
		declaredAt: (25 to: 41)) south ] valueCoveringAll:
		{43 to: 47})
		cover: (13 to: 21)
		declaredAt: (13 to: 21).
	(position _ [
	(0 coverAll:
		{62 to: 62}) @
		(0 coverAll:
			{64 to: 64}) ] valueCoveringAll:
		{63 to: 63})
		cover: (51 to: 58)
		declaredAt: (51 to: 58).! !
!Behavior method!
south
	^ [
	(South
		cover: (9 to: 13)
		declaredAt: (9 to: 13)) new ] valueCoveringAll:
		{15 to: 17}.! !
!Behavior method!
withDirection: aRotator
	(cardinalMovement _ aRotator
		cover: (45 to: 52)
		declaredAt: (16 to: 23))
		cover: (26 to: 41)
		declaredAt: (26 to: 41).! !
!Behavior method!
processCommand: aCommandSequence
	[
	(aCommandSequence
		cover: (36 to: 51)
		declaredAt: (17 to: 32)) do: [ :aCommand |
		[
		([
		(MarsRoverCommand
			cover: (71 to: 86)
			declaredAt: (71 to: 86)) for:
			(aCommand
				cover: (93 to: 100)
				declaredAt: (59 to: 66)) ] valueCoveringAll:
			{88 to: 91}) executeFor:
			(self coverAll:
				{115 to: 118}) ] valueCoveringAll:
			{103 to: 113} ]] valueCoveringAll:
		{53 to: 55}.
	^ self coverAll:
		{125 to: 128}.! !
!Behavior method!
isAt: aPoint
	^ [
	(location
		cover: (16 to: 23)
		declaredAt: (16 to: 23)) isAt:
		(aPoint
			cover: (31 to: 36)
			declaredAt: (7 to: 12)) ] valueCoveringAll:
		{25 to: 29}.! !
!Behavior method!
isAt: aPoint
	^ [
	(marker
		cover: (16 to: 21)
		declaredAt: (16 to: 21)) =
		(aPoint
			cover: (25 to: 30)
			declaredAt: (7 to: 12)) ] valueCoveringAll:
		{23 to: 23}.! !
!Behavior method!
isHeadingToSouth
	^ [
	(movementSystem
		cover: (20 to: 33)
		declaredAt: (20 to: 33)) isHeadingToSouth ] valueCoveringAll:
		{35 to: 50}.! !
!Behavior method!
isHeadingToSouth
	^ [
	([
	(cardinalMovement
		cover: (20 to: 35)
		declaredAt: (20 to: 35)) direction ] valueCoveringAll:
		{37 to: 45}) isSouth ] valueCoveringAll:
		{47 to: 53}.! !
!Behavior method!
direction
	^ direction
		cover: (13 to: 21)
		declaredAt: (13 to: 21).! !
!Behavior method!
isSouth
	^ true coverAll:
		{11 to: 14}.! !

!testRun: #MarsRoverTest #test01RoverProcessEmptyCommandDoesntChangeItsPosition stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!
!Behavior method!
for: aCommand
	^ [
	([
	([
	(self coverAll:
		{18 to: 21}) subclasses ] valueCoveringAll:
		{23 to: 32}) detect: [ :aCommandType |
		[
		(aCommandType
			cover: (59 to: 70)
			declaredAt: (44 to: 55)) canHandle:
			(aCommand
				cover: (83 to: 90)
				declaredAt: (6 to: 13)) ] valueCoveringAll:
			{72 to: 81} ]] valueCoveringAll:
		{34 to: 40}) new ] valueCoveringAll:
		{94 to: 96}.! !
!Behavior method!
canHandle: aCommand
	^ [
	(aCommand
		cover: (23 to: 30)
		declaredAt: (12 to: 19)) =
		($b coverAll:
			{34 to: 35}) ] valueCoveringAll:
		{32 to: 32}.! !
!Behavior method!
canHandle: aCommand
	^ [
	(aCommand
		cover: (23 to: 30)
		declaredAt: (12 to: 19)) =
		($f coverAll:
			{34 to: 35}) ] valueCoveringAll:
		{32 to: 32}.! !
!Behavior method!
canHandle: aCommand
	^ [
	(aCommand
		cover: (23 to: 30)
		declaredAt: (12 to: 19)) =
		($l coverAll:
			{34 to: 35}) ] valueCoveringAll:
		{32 to: 32}.! !
!Behavior method!
executeFor: aMarsRover
	[
	(aMarsRover
		cover: (25 to: 34)
		declaredAt: (13 to: 22)) executeLeftRotate ] valueCoveringAll:
		{36 to: 52}.! !
!Behavior method!
executeLeftRotate
	[
	(movementSystem
		cover: (20 to: 33)
		declaredAt: (20 to: 33)) leftRotate ] valueCoveringAll:
		{35 to: 44}.! !
!Behavior method!
leftRotate
	(cardinalMovement _ [
	(cardinalMovement
		cover: (13 to: 28)
		declaredAt: (13 to: 28)) leftClockwiseRotation ] valueCoveringAll:
		{49 to: 69})
		cover: (32 to: 47)
		declaredAt: (13 to: 28).! !
!Behavior method!
leftClockwiseRotation
	^ [
	(WestPointMovement
		cover: (25 to: 41)
		declaredAt: (25 to: 41)) new ] valueCoveringAll:
		{43 to: 45}.! !
!Behavior method!
initialize
	(direction _ [
	(CardinalDirection
		cover: (25 to: 41)
		declaredAt: (25 to: 41)) west ] valueCoveringAll:
		{43 to: 46})
		cover: (13 to: 21)
		declaredAt: (13 to: 21).
	(position _ [
	(0 coverAll:
		{61 to: 61}) @
		(0 coverAll:
			{63 to: 63}) ] valueCoveringAll:
		{62 to: 62})
		cover: (50 to: 57)
		declaredAt: (50 to: 57).! !
!Behavior method!
west
	^ [
	(West
		cover: (8 to: 11)
		declaredAt: (8 to: 11)) new ] valueCoveringAll:
		{13 to: 15}.! !
!Behavior method!
isHeadingToWest
	^ [
	(movementSystem
		cover: (19 to: 32)
		declaredAt: (19 to: 32)) isHeadingToWest ] valueCoveringAll:
		{34 to: 48}.! !
!Behavior method!
isHeadingToWest
	^ [
	([
	(cardinalMovement
		cover: (19 to: 34)
		declaredAt: (19 to: 34)) direction ] valueCoveringAll:
		{36 to: 44}) isWest ] valueCoveringAll:
		{46 to: 51}.! !
!Behavior method!
isWest
	^ true coverAll:
		{10 to: 13}.! !

!testRun: #MarsRoverTest #test02RoverSingleLeftRotationFromSouthIsWest stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!
!Behavior method!
canHandle: aCardinalDirection
	^ [
	(aCardinalDirection
		cover: (34 to: 51)
		declaredAt: (12 to: 29)) isKindOf:
		([
		(West
			cover: (63 to: 66)
			declaredAt: (63 to: 66)) class ] valueCoveringAll:
			{68 to: 72}) ] valueCoveringAll:
		{53 to: 61}.! !
!Behavior method!
leftClockwiseRotation
	^ [
	(NorthPointMovement
		cover: (25 to: 42)
		declaredAt: (25 to: 42)) new ] valueCoveringAll:
		{44 to: 46}.! !
!Behavior method!
initialize
	(direction _ [
	(CardinalDirection
		cover: (25 to: 41)
		declaredAt: (25 to: 41)) north ] valueCoveringAll:
		{43 to: 47})
		cover: (13 to: 21)
		declaredAt: (13 to: 21).
	(position _ [
	(0 coverAll:
		{62 to: 62}) @
		(0 coverAll:
			{64 to: 64}) ] valueCoveringAll:
		{63 to: 63})
		cover: (51 to: 58)
		declaredAt: (51 to: 58).! !
!Behavior method!
north
	^ [
	(North
		cover: (9 to: 13)
		declaredAt: (9 to: 13)) new ] valueCoveringAll:
		{15 to: 17}.! !
!Behavior method!
isHeadingToNorth
	^ [
	(movementSystem
		cover: (20 to: 33)
		declaredAt: (20 to: 33)) isHeadingToNorth ] valueCoveringAll:
		{35 to: 50}.! !
!Behavior method!
isHeadingToNorth
	^ [
	([
	(cardinalMovement
		cover: (20 to: 35)
		declaredAt: (20 to: 35)) direction ] valueCoveringAll:
		{37 to: 45}) isNorth ] valueCoveringAll:
		{47 to: 53}.! !
!Behavior method!
isNorth
	^ true coverAll:
		{11 to: 14}.! !

!testRun: #MarsRoverTest #test03RoverSingleLeftRotationFromWestIsNorth stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!
!Behavior method!
leftClockwiseRotation
	^ [
	(EastPointMovement
		cover: (25 to: 41)
		declaredAt: (25 to: 41)) new ] valueCoveringAll:
		{43 to: 45}.! !
!Behavior method!
initialize
	(direction _ [
	(CardinalDirection
		cover: (25 to: 41)
		declaredAt: (25 to: 41)) east ] valueCoveringAll:
		{43 to: 46})
		cover: (13 to: 21)
		declaredAt: (13 to: 21).! !
!Behavior method!
east
	^ [
	(East
		cover: (8 to: 11)
		declaredAt: (8 to: 11)) new ] valueCoveringAll:
		{13 to: 15}.! !
!Behavior method!
isHeadingToEast
	^ [
	(movementSystem
		cover: (19 to: 32)
		declaredAt: (19 to: 32)) isHeadingToEast ] valueCoveringAll:
		{34 to: 48}.! !
!Behavior method!
isHeadingToEast
	^ [
	([
	(cardinalMovement
		cover: (19 to: 34)
		declaredAt: (19 to: 34)) direction ] valueCoveringAll:
		{36 to: 44}) isEast ] valueCoveringAll:
		{46 to: 51}.! !
!Behavior method!
isEast
	^ true coverAll:
		{10 to: 13}.! !

!testRun: #MarsRoverTest #test04RoverSingleLeftRotationFromNorthIsEast stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!
!Behavior method!
leftClockwiseRotation
	^ [
	(SouthPointMovement
		cover: (25 to: 42)
		declaredAt: (25 to: 42)) new ] valueCoveringAll:
		{44 to: 46}.! !

!testRun: #MarsRoverTest #test05RoverSingleLeftRotationFromEastIsSouth stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!
!Behavior method!
canHandle: aCommand
	^ [
	(aCommand
		cover: (23 to: 30)
		declaredAt: (12 to: 19)) =
		($r coverAll:
			{34 to: 35}) ] valueCoveringAll:
		{32 to: 32}.! !
!Behavior method!
executeFor: aMarsRover
	[
	(aMarsRover
		cover: (25 to: 34)
		declaredAt: (13 to: 22)) executeRightRotate ] valueCoveringAll:
		{36 to: 53}.! !
!Behavior method!
executeRightRotate
	[
	(movementSystem
		cover: (21 to: 34)
		declaredAt: (21 to: 34)) rightRotate ] valueCoveringAll:
		{36 to: 46}.! !
!Behavior method!
rightRotate
	(cardinalMovement _ [
	(cardinalMovement
		cover: (14 to: 29)
		declaredAt: (14 to: 29)) rightCounterClockwiseRotation ] valueCoveringAll:
		{50 to: 78})
		cover: (33 to: 48)
		declaredAt: (14 to: 29).! !
!Behavior method!
rightCounterClockwiseRotation
	^ [
	(EastPointMovement
		cover: (33 to: 49)
		declaredAt: (33 to: 49)) new ] valueCoveringAll:
		{51 to: 53}.! !

!testRun: #MarsRoverTest #test06RoverSingleRightRotationFromSouthIsEast stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!
!Behavior method!
rightCounterClockwiseRotation
	^ [
	(NorthPointMovement
		cover: (33 to: 50)
		declaredAt: (33 to: 50)) new ] valueCoveringAll:
		{52 to: 54}.! !

!testRun: #MarsRoverTest #test07RoverSingleRightRotationFromEastIsNorth stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!
!Behavior method!
rightCounterClockwiseRotation
	^ [
	(WestPointMovement
		cover: (33 to: 49)
		declaredAt: (33 to: 49)) new ] valueCoveringAll:
		{51 to: 53}.! !

!testRun: #MarsRoverTest #test08RoverSingleRightRotationFromNorthIsWest stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!
!Behavior method!
rightCounterClockwiseRotation
	^ [
	(SouthPointMovement
		cover: (33 to: 50)
		declaredAt: (33 to: 50)) new ] valueCoveringAll:
		{52 to: 54}.! !

!testRun: #MarsRoverTest #test09RoverSingleRightRotationFromWestIsSouth stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!

!testRun: #MarsRoverTest #test10RoverFourSingleRotationFromWestIsWest stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!

!testRun: #MarsRoverTest #test11RoverSingleRightRotationAndSingleLeftRotationFromWestIsWest stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!
!Behavior method!
executeFor: aMarsRover
	[
	(aMarsRover
		cover: (25 to: 34)
		declaredAt: (13 to: 22)) executeForwardMovement ] valueCoveringAll:
		{36 to: 57}.! !
!Behavior method!
executeForwardMovement
	[
	(location
		cover: (25 to: 32)
		declaredAt: (25 to: 32)) movePositionWith:
		([
		(movementSystem
			cover: (53 to: 66)
			declaredAt: (53 to: 66)) positionForward ] valueCoveringAll:
			{68 to: 82}) ] valueCoveringAll:
		{34 to: 50}.! !
!Behavior method!
positionForward
	^ [
	(cardinalMovement
		cover: (19 to: 34)
		declaredAt: (19 to: 34)) forwardMovement ] valueCoveringAll:
		{36 to: 50}.! !
!Behavior method!
forwardMovement
	^ [
	(0 coverAll:
		{20 to: 20}) @
		(1 coverAll:
			{22 to: 22}) ] valueCoveringAll:
		{21 to: 21}.! !
!Behavior method!
movePositionWith: aPoint
	(marker _ [
	(marker
		cover: (27 to: 32)
		declaredAt: (27 to: 32)) +
		(aPoint
			cover: (45 to: 50)
			declaredAt: (19 to: 24)) ] valueCoveringAll:
		{43 to: 43})
		cover: (36 to: 41)
		declaredAt: (27 to: 32).! !

!testRun: #MarsRoverTest #test12RoverSingleForwardCommandFromNorthAdvancesOneUnitNorth stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!
!Behavior method!
forwardMovement
	^ [
	(0 coverAll:
		{20 to: 20}) @
		(-1 coverAll:
			{22 to: 23}) ] valueCoveringAll:
		{21 to: 21}.! !

!testRun: #MarsRoverTest #test13RoverSingleForwardCommandFromSouthAdvancesOneUnitSouth stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!
!Behavior method!
forwardMovement
	^ [
	(1 coverAll:
		{20 to: 20}) @
		(0 coverAll:
			{22 to: 22}) ] valueCoveringAll:
		{21 to: 21}.! !

!testRun: #MarsRoverTest #test14RoverSingleForwardCommandFromEastAdvancesOneUnitEast stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!
!Behavior method!
forwardMovement
	^ [
	(-1 coverAll:
		{20 to: 21}) @
		(0 coverAll:
			{23 to: 23}) ] valueCoveringAll:
		{22 to: 22}.! !

!testRun: #MarsRoverTest #test15RoverSingleForwardCommandFromWestAdvancesOneUnitWest stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!
!Behavior method!
executeFor: aMarsRover
	[
	(aMarsRover
		cover: (25 to: 34)
		declaredAt: (13 to: 22)) executeBackwardMovement ] valueCoveringAll:
		{36 to: 58}.! !
!Behavior method!
executeBackwardMovement
	[
	(location
		cover: (26 to: 33)
		declaredAt: (26 to: 33)) movePositionWith:
		([
		(movementSystem
			cover: (54 to: 67)
			declaredAt: (54 to: 67)) positionBackward ] valueCoveringAll:
			{69 to: 84}) ] valueCoveringAll:
		{35 to: 51}.! !
!Behavior method!
positionBackward
	^ [
	(cardinalMovement
		cover: (20 to: 35)
		declaredAt: (20 to: 35)) backwardMovement ] valueCoveringAll:
		{37 to: 52}.! !
!Behavior method!
backwardMovement
	^ [
	(0 coverAll:
		{21 to: 21}) @
		(-1 coverAll:
			{23 to: 24}) ] valueCoveringAll:
		{22 to: 22}.! !

!testRun: #MarsRoverTest #test16RoverSingleBackwardCommandFromNorthReducesOneUnitNorth stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!
!Behavior method!
backwardMovement
	^ [
	(0 coverAll:
		{21 to: 21}) @
		(1 coverAll:
			{23 to: 23}) ] valueCoveringAll:
		{22 to: 22}.! !

!testRun: #MarsRoverTest #test17RoverSingleBackwardCommandFromSouthReducesOneUnitSouth stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!
!Behavior method!
backwardMovement
	^ [
	(-1 coverAll:
		{21 to: 22}) @
		(0 coverAll:
			{24 to: 24}) ] valueCoveringAll:
		{23 to: 23}.! !

!testRun: #MarsRoverTest #test18RoverSingleBackwardCommandFromEastReducesOneUnitEast stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!
!Behavior method!
backwardMovement
	^ [
	(1 coverAll:
		{21 to: 21}) @
		(0 coverAll:
			{23 to: 23}) ] valueCoveringAll:
		{22 to: 22}.! !

!testRun: #MarsRoverTest #test19RoverSingleBackwardCommandFromWestReducesOneUnitWest stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!

!testRun: #MarsRoverTest #test20RoverSingleBackwardAndSingleForwardDoesNotChangeItsPosition stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!

!testRun: #MarsRoverTest #test21RoverSingleForwardFromNorthAndSingleForwardFromEastIs1and1Position stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!

!testRun: #MarsRoverTest #test22RoverDoubleLeftRotationCommandFromSouthIsNorth stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!

!testRun: #MarsRoverTest #test23RoverLeftForwardRightForwardStartingAtSouthIsCoordinateMinusOneXAndMinusOneY stamp: 'LDMAF 5/16/2022 19:09:38'!
PASSED!

----STARTUP---- (16 May 2022 20:39:15) as /home/clinux01/Cuis_University/linux64/CuisUniversity-5053.image!


#(1 2 3 4) inject: 0 into: [:a :c | a + c]!

#(1 2 3 4) inject: 0 into: [:a :c | a + c]!

----STARTUP---- (19 May 2022 17:05:58) as /home/clinux01/Cuis_University/linux64/CuisUniversity-5053.image!


----End fileIn of /home/clinux01/Cuis_University/linux64/Portfolio-Ejercicio.st----!

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'LDMAF 5/19/2022 17:06:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'LDMAF 5/19/2022 17:06:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'LDMAF 5/19/2022 17:06:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'LDMAF 5/19/2022 17:06:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'LDMAF 5/19/2022 17:06:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'LDMAF 5/19/2022 17:06:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'LDMAF 5/19/2022 17:06:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'LDMAF 5/19/2022 17:06:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'LDMAF 5/19/2022 17:06:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'LDMAF 5/19/2022 17:06:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'LDMAF 5/19/2022 17:06:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'LDMAF 5/19/2022 17:06:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'LDMAF 5/19/2022 17:06:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'LDMAF 5/19/2022 17:06:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'LDMAF 5/19/2022 17:06:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'LDMAF 5/19/2022 17:06:38'!
PASSED!

1 == 1!

1 == 2!

b := Portfolio new.!

c := Portfolio new.!

b=c!

b=b!

hola := 'hola'!

hola := 'hola'.!

hola2 := 'hola'.!

hola == hola!

hola == hola2!

hola = hola2!

hola == hola2!

verdadero := true!

verdadero2 := true.!

verdadero2 := true.!

verdadero = verdadero2 !

verdadero == verdadero2!

SmallInteger maxVal !

SmallInteger minVal !

LargeNegativeInteger maxVal !

LargeNegativeInteger minVal !

SmallInteger maxVal == SmallInteger maxVal !

(SmallInteger maxVal) hash == (SmallInteger maxVal) hash !

(SmallInteger maxVal) hash!

SmallInteger maxVal hash!

SmallInteger maxVal == SmallInteger maxVal!

SmallInteger maxVal == SmallInteger maxVal!

(SmallInteger maxVal) + 1 == (SmallInteger maxVal) + 1!

(SmallInteger maxVal) + 1 == (SmallInteger maxVal) + 1!

(SmallInteger maxVal + 1) == (SmallInteger maxVal + 1)!

SmallInteger maxVal == SmallInteger maxVal!

Error!

Error!

Error!

signal!

TestCase subclass: #BankAsset
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!

!classDefinition: #BankAsset category: 'Portfolio-Ejercicio' stamp: 'LDMAF 5/19/2022 20:42:54'!
TestCase subclass: #BankAsset
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!

BankAsset subclass: #Portfolio
	instanceVariableNames: 'accounts portfolios'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!

!classDefinition: #Portfolio category: 'Portfolio-Ejercicio' stamp: 'LDMAF 5/19/2022 20:43:37'!
BankAsset subclass: #Portfolio
	instanceVariableNames: 'accounts portfolios'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!

BankAsset subclass: #ReceptiveAccount
	instanceVariableNames: 'transactions'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!

!classDefinition: #ReceptiveAccount category: 'Portfolio-Ejercicio' stamp: 'LDMAF 5/19/2022 20:43:48'!
BankAsset subclass: #ReceptiveAccount
	instanceVariableNames: 'transactions'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!
!BankAsset methodsFor: 'nil' stamp: 'LDMAF 5/19/2022 20:44:32'!
transactions
	self subclassResponsibility ! !
!BankAsset methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/19/2022 20:44:36'!
balance
	self subclassResponsibility ! !
!Portfolio methodsFor: 'operations' stamp: 'LDMAF 5/19/2022 20:48:06'!
addTo: aPortfolio

	(aPortfolio containsAnyAccountOf: self) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccountInPortfolio].
			portfolios add: self.
	
	! !
!ReceptiveAccount methodsFor: 'nil' stamp: 'LDMAF 5/19/2022 20:49:00'!
addTo: aReceptiveAccount
! !
!Portfolio methodsFor: 'operations' stamp: 'LDMAF 5/19/2022 20:50:01' prior: 50472867!
addTo: aPortfolio

	(aPortfolio containsAnyAccountOf: self) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccountInPortfolio].
			portfolios add: self
		
	
	! !
!Portfolio methodsFor: 'operations' stamp: 'LDMAF 5/19/2022 20:51:26' prior: 50472598!
add: anAsset
	anAsset addTo: self.
	(anAsset isKindOf: Portfolio) ifTrue: [
			(self containsAnyAccountOf: anAsset) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccountInPortfolio].
			portfolios add: anAsset.
		]
	ifFalse: [
			(accounts includes: anAsset) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccount].
			accounts add: anAsset.
		].! !
!Portfolio methodsFor: 'operations' stamp: 'LDMAF 5/19/2022 20:53:41' prior: 50472887!
add: anAsset
	anAsset addToPortfolio: self.
	(anAsset isKindOf: Portfolio) ifTrue: [
			(self containsAnyAccountOf: anAsset) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccountInPortfolio].
			portfolios add: anAsset.
		]
	ifFalse: [
			(accounts includes: anAsset) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccount].
			accounts add: anAsset.
		].! !
!Portfolio methodsFor: 'operations' stamp: 'LDMAF 5/19/2022 20:55:09'!
addToPortfolio: aPortfolio

	(aPortfolio containsAnyAccountOf: self) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccountInPortfolio].
	(aPortfolio portfolios) add: self.
		
	
	! !
!Portfolio methodsFor: 'operations' stamp: 'LDMAF 5/19/2022 20:55:24'!
portfolios
	^portfolios ! !
!ReceptiveAccount methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/19/2022 20:55:41'!
addToPortfolio: aPortfolio
! !
!ReceptiveAccount methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/19/2022 20:56:28' prior: 50472928!
addToPortfolio: aPortfolio

	((aPortfolio accounts) includes: self) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccount].
	(aPortfolio accounts) add: self.
! !
!Portfolio methodsFor: 'operations' stamp: 'LDMAF 5/19/2022 20:56:47'!
accounts
	^accounts ! !
!Portfolio methodsFor: 'operations' stamp: 'LDMAF 5/19/2022 20:56:56' prior: 50472901!
add: anAsset
	anAsset addToPortfolio: self.
! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'LDMAF 5/19/2022 20:56:59'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'LDMAF 5/19/2022 20:56:59'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'LDMAF 5/19/2022 20:56:59'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'LDMAF 5/19/2022 20:56:59'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'LDMAF 5/19/2022 20:56:59'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'LDMAF 5/19/2022 20:56:59'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'LDMAF 5/19/2022 20:56:59'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'LDMAF 5/19/2022 20:56:59'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'LDMAF 5/19/2022 20:56:59'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'LDMAF 5/19/2022 20:56:59'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'LDMAF 5/19/2022 20:56:59'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'LDMAF 5/19/2022 20:56:59'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'LDMAF 5/19/2022 20:56:59'!
PASSED!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'LDMAF 5/19/2022 20:56:59'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'LDMAF 5/19/2022 20:56:59'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'LDMAF 5/19/2022 20:56:59'!
PASSED!

!methodRemoval: Portfolio #addTo: stamp: 'LDMAF 5/19/2022 20:57:08'!
addTo: aPortfolio

	(aPortfolio containsAnyAccountOf: self) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccountInPortfolio].
			portfolios add: self
		
	
	!

!methodRemoval: ReceptiveAccount #addTo: stamp: 'LDMAF 5/19/2022 20:57:18'!
addTo: aReceptiveAccount
!
!Portfolio methodsFor: 'operations' stamp: 'LDMAF 5/19/2022 20:57:50'!
addTo: aPortfolio

	(aPortfolio containsAnyAccountOf: self) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccountInPortfolio].
	(aPortfolio portfolios) add: self.
		
	
	! !
!Portfolio methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/19/2022 20:57:50' prior: 50472945!
add: anAsset
	anAsset addTo: self.
! !

!methodRemoval: Portfolio #addToPortfolio: stamp: 'LDMAF 5/19/2022 20:57:50'!
addToPortfolio: aPortfolio

	(aPortfolio containsAnyAccountOf: self) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccountInPortfolio].
	(aPortfolio portfolios) add: self.
		
	
	!
!ReceptiveAccount methodsFor: 'as yet unclassified' stamp: 'LDMAF 5/19/2022 20:58:05'!
addTo: aPortfolio

	((aPortfolio accounts) includes: self) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccount].
	(aPortfolio accounts) add: self.
! !

!methodRemoval: ReceptiveAccount #addToPortfolio: stamp: 'LDMAF 5/19/2022 20:58:05'!
addToPortfolio: aPortfolio

	((aPortfolio accounts) includes: self) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccount].
	(aPortfolio accounts) add: self.
!

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'LDMAF 5/19/2022 20:58:32'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'LDMAF 5/19/2022 20:58:32'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'LDMAF 5/19/2022 20:58:32'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'LDMAF 5/19/2022 20:58:32'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'LDMAF 5/19/2022 20:58:32'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'LDMAF 5/19/2022 20:58:32'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'LDMAF 5/19/2022 20:58:32'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'LDMAF 5/19/2022 20:58:32'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'LDMAF 5/19/2022 20:58:32'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'LDMAF 5/19/2022 20:58:32'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'LDMAF 5/19/2022 20:58:32'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'LDMAF 5/19/2022 20:58:32'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'LDMAF 5/19/2022 20:58:32'!
PASSED!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'LDMAF 5/19/2022 20:58:32'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'LDMAF 5/19/2022 20:58:32'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'LDMAF 5/19/2022 20:58:32'!
PASSED!

BankAsset subclass: #Portfolio
	instanceVariableNames: 'accounts portfolios assets'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!

!classDefinition: #Portfolio category: 'Portfolio-Ejercicio' stamp: 'LDMAF 5/19/2022 21:20:42'!
BankAsset subclass: #Portfolio
	instanceVariableNames: 'accounts portfolios assets'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!
!Portfolio methodsFor: 'initialize' stamp: 'LDMAF 5/19/2022 21:21:06' prior: 50472657 overrides: 16920235!
initialize
	accounts _ OrderedCollection new.
	portfolios _ OrderedCollection new.
	assets _ OrderedCollection new.! !
!Portfolio methodsFor: 'operations' stamp: 'LDMAF 5/19/2022 21:21:37' prior: 50473025!
addTo: aPortfolio

	(aPortfolio containsAnyAccountOf: self) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccountInPortfolio].
	(aPortfolio assets) add: self.
		
	
	! !
!Portfolio methodsFor: 'operations' stamp: 'LDMAF 5/19/2022 21:21:50'!
assets
	^assets ! !
!Portfolio methodsFor: 'operations' stamp: 'LDMAF 5/19/2022 21:23:30' prior: 50473149!
addTo: aPortfolio

	(aPortfolio containsAnyAccountOf: self) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccountInPortfolio].
	(aPortfolio portfolios) add: self.
		
	
	! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'LDMAF 5/19/2022 21:23:34'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'LDMAF 5/19/2022 21:23:34'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'LDMAF 5/19/2022 21:23:34'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'LDMAF 5/19/2022 21:23:34'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'LDMAF 5/19/2022 21:23:34'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'LDMAF 5/19/2022 21:23:34'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'LDMAF 5/19/2022 21:23:34'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'LDMAF 5/19/2022 21:23:34'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'LDMAF 5/19/2022 21:23:34'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'LDMAF 5/19/2022 21:23:34'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'LDMAF 5/19/2022 21:23:34'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'LDMAF 5/19/2022 21:23:34'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'LDMAF 5/19/2022 21:23:34'!
PASSED!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'LDMAF 5/19/2022 21:23:34'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'LDMAF 5/19/2022 21:23:34'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'LDMAF 5/19/2022 21:23:34'!
PASSED!
!Portfolio methodsFor: 'operations' stamp: 'LDMAF 5/19/2022 21:28:12' prior: 50472632!
flattenAccounts	
	|flattenAccounts|
	flattenAccounts _ OrderedCollection new.
	assets do: [:anAsset | 
		(anAsset isKindOf: ReceptiveAccount) ifTrue: [flattenAccounts add: anAsset]
			ifFalse: [anAsset addYourAccountsTo: flattenAccounts]
		].
	^flattenAccounts.! !
!Portfolio methodsFor: 'operations' stamp: 'LDMAF 5/19/2022 21:31:33'!
addYourAccountsTo: aListOfAccounts	
	assets do: [:anAsset | 
		(anAsset isKindOf: ReceptiveAccount) ifTrue: [aListOfAccounts add: anAsset]
			ifFalse: [anAsset addYourAccountsTo: aListOfAccounts]
		].
	^aListOfAccounts.! !
!Portfolio methodsFor: 'operations' stamp: 'LDM 5/18/2022 10:51:02' prior: 50473235!
flattenAccounts	
	|flattenAccounts|
	flattenAccounts _ accounts.
	portfolios do: [:aPortfolio | 
			flattenAccounts _ flattenAccounts, (aPortfolio flattenAccounts)
		].
	^flattenAccounts.! !

BankAsset subclass: #Portfolio
	instanceVariableNames: 'accounts portfolios'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!

!classDefinition: #Portfolio category: 'Portfolio-Ejercicio' stamp: 'LDMAF 5/19/2022 21:37:57'!
BankAsset subclass: #Portfolio
	instanceVariableNames: 'accounts portfolios'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'LDMAF 5/19/2022 21:38:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'LDMAF 5/19/2022 21:38:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'LDMAF 5/19/2022 21:38:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'LDMAF 5/19/2022 21:38:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'LDMAF 5/19/2022 21:38:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'LDMAF 5/19/2022 21:38:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'LDMAF 5/19/2022 21:38:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'LDMAF 5/19/2022 21:38:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'LDMAF 5/19/2022 21:38:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'LDMAF 5/19/2022 21:38:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'LDMAF 5/19/2022 21:38:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'LDMAF 5/19/2022 21:38:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'LDMAF 5/19/2022 21:38:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'LDMAF 5/19/2022 21:38:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'LDMAF 5/19/2022 21:38:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'LDMAF 5/19/2022 21:38:00'!
PASSED!

----SNAPSHOT----(19 May 2022 21:41:29) CuisUniversity-5053.image priorSource: 4499357!

----STARTUP---- (20 May 2022 17:18:55) as /Users/lisandro.di.mateo/Documents/Lisandro/Facultad/ING/macos64/CuisUniversity-5053.image!


!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'ldm 5/20/2022 17:19:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'ldm 5/20/2022 17:19:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'ldm 5/20/2022 17:19:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'ldm 5/20/2022 17:19:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'ldm 5/20/2022 17:19:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'ldm 5/20/2022 17:19:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'ldm 5/20/2022 17:19:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'ldm 5/20/2022 17:19:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'ldm 5/20/2022 17:19:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'ldm 5/20/2022 17:19:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'ldm 5/20/2022 17:19:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'ldm 5/20/2022 17:19:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'ldm 5/20/2022 17:19:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'ldm 5/20/2022 17:19:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'ldm 5/20/2022 17:19:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'ldm 5/20/2022 17:19:09'!
PASSED!
!Portfolio methodsFor: 'operations' stamp: 'ldm 5/20/2022 17:20:49' prior: 50473161!
addTo: aPortfolio

	(aPortfolio containsAnyAccountOf: self) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccountInPortfolio].
	(self containsAnyAccountOf: aPortfolio) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccountInPortfolio].
	(aPortfolio portfolios) add: self.
		
	
	! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'ldm 5/20/2022 17:21:07'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'ldm 5/20/2022 17:21:07'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'ldm 5/20/2022 17:21:07'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'ldm 5/20/2022 17:21:07'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'ldm 5/20/2022 17:21:07'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'ldm 5/20/2022 17:21:07'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'ldm 5/20/2022 17:21:07'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'ldm 5/20/2022 17:21:07'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'ldm 5/20/2022 17:21:07'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'ldm 5/20/2022 17:21:07'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'ldm 5/20/2022 17:21:07'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'ldm 5/20/2022 17:21:07'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'ldm 5/20/2022 17:21:07'!
PASSED!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'ldm 5/20/2022 17:21:07'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'ldm 5/20/2022 17:21:07'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'ldm 5/20/2022 17:21:07'!
PASSED!
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/20/2022 17:26:30'!
test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail
	
	| transaction transaction1 transaction2 transaction3 transaction4 account account2 portfolio extraPortfolio allTransactions| 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	account := ReceptiveAccount new.
	account2 := ReceptiveAccount new.
	transaction := Deposit register: 50 on: account.
	transaction1 := Deposit register: 150 on: account.
	transaction2 := Withdraw register: 50 on: account.
	transaction3 := Deposit register: 30 on: account2.
	transaction4 := Deposit register: 10 on: account2.
	
	portfolio add: account.
	extraPortfolio add: portfolio.
	extraPortfolio add: account.

	self assert: false.
	! !
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/20/2022 17:29:31' prior: 50473491!
test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail
	
	| account portfolio extraPortfolio | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	account := ReceptiveAccount new.
	
	portfolio add: account.
	extraPortfolio add: portfolio.
	
	self 
		should: [ extraPortfolio add: account. ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccountInPortfolio.
			].
	! !

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 17:29:33'!
FAILURE!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 17:29:33'!
FAILURE!

BankAsset subclass: #Portfolio
	instanceVariableNames: 'accounts portfolios parentPorfolios'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!

!classDefinition: #Portfolio category: 'Portfolio-Ejercicio' stamp: 'ldm 5/20/2022 17:33:33'!
BankAsset subclass: #Portfolio
	instanceVariableNames: 'accounts portfolios parentPorfolios'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!
!Portfolio methodsFor: 'initialize' stamp: 'ldm 5/20/2022 17:34:08' prior: 50473142 overrides: 16920235!
initialize
	accounts _ OrderedCollection new.
	portfolios _ OrderedCollection new.! !
!Portfolio methodsFor: 'initialize' stamp: 'ldm 5/20/2022 17:34:25' prior: 50473560 overrides: 16920235!
initialize
	accounts _ OrderedCollection new.
	portfolios _ OrderedCollection new.
	parentPorfolios _ OrderedCollection new.! !
!Portfolio methodsFor: 'operations' stamp: 'ldm 5/20/2022 17:35:20' prior: 50473415!
addTo: aPortfolio

	(aPortfolio containsAnyAccountOf: self) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccountInPortfolio].
	(self containsAnyAccountOf: aPortfolio) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccountInPortfolio].
	(aPortfolio portfolios) add: self.
	parentPorfolios add: aPortfolio.
		
	
	! !
!ReceptiveAccount methodsFor: 'as yet unclassified' stamp: 'ldm 5/20/2022 17:38:17' prior: 50473047!
addTo: aPortfolio

	((aPortfolio accounts) includes: self) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccount].
	(aPortfolio accountExistsInParentPorfolios: self) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccount].
	(aPortfolio accounts) add: self.
! !

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 17:38:26'!
ERROR!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 17:38:26'!
ERROR!
!Portfolio methodsFor: 'operations' stamp: 'ldm 5/20/2022 17:38:35'!
accountExistsInParentPorfolios: aReceptiveAccount 
	self shouldBeImplemented.! !

#() anySatisfy: [:falopa | falopa ]!
!Portfolio methodsFor: 'operations' stamp: 'ldm 5/20/2022 17:49:40' prior: 50473608!
accountExistsInParentPorfolios: aReceptiveAccount 
	|a| 
	a _ parentPorfolios anySatisfy: [:aParentPortfolio | aParentPortfolio accountExistsInParentPorfolios: aReceptiveAccount].
	^(accounts includes: aReceptiveAccount) or: [a].! !

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 17:49:51'!
FAILURE!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 17:49:51'!
FAILURE!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 17:50:21'!
FAILURE!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 17:50:43'!
FAILURE!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 17:50:49'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 17:51:05'!
FAILURE!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 17:51:05'!
FAILURE!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 17:51:58'!
FAILURE!
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/20/2022 17:52:50' prior: 50473517!
test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail
	
	| account portfolio extraPortfolio | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	account := ReceptiveAccount new.
	
	portfolio add: account.
	extraPortfolio add: portfolio.
	
	self 
		should: [ extraPortfolio add: account. ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccountInPortfolio.
			].
	! !

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 17:52:55'!
FAILURE!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 17:52:55'!
FAILURE!
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/20/2022 17:54:47' prior: 50473667!
test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail
	
	| account portfolio extraPortfolio | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	account := ReceptiveAccount new.
	
	portfolio add: account.
	extraPortfolio add: portfolio.
	extraPortfolio add: account.
	
	self 
		should: [ extraPortfolio add: account. ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccountInPortfolio.
			].
	! !

self accounts!

self accounts size!

self!

parentPorfolios !

parentPorfolios size !
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/20/2022 18:03:38' prior: 50473696!
test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail
	
	| account portfolio extraPortfolio | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	account := ReceptiveAccount new.
	
	portfolio add: account.
	extraPortfolio add: portfolio.
	extraPortfolio add: account.
	
	self 
		should: [ extraPortfolio add: account. ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccount.
			].
	! !

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 18:03:41'!
PASSED!
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/20/2022 18:07:29'!
test18xxx
	
	| account portfolio extraPortfolio | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	account := ReceptiveAccount new.
	
	portfolio add: account.
	portfolio add: extraPortfolio.
	
	self 
		should: [ extraPortfolio add: account. ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccount.
			].
	! !
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/20/2022 18:07:36' prior: 50473718!
test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail
	
	| account portfolio extraPortfolio | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	account := ReceptiveAccount new.
	
	portfolio add: account.
	extraPortfolio add: portfolio.
	
	self 
		should: [ extraPortfolio add: account. ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccount.
			].
	! !

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 18:07:38'!
FAILURE!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 18:07:38'!
FAILURE!
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/20/2022 18:08:00' prior: 50473758!
test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail
	
	| account portfolio extraPortfolio | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	account := ReceptiveAccount new.
	
	portfolio add: account.
	extraPortfolio add: portfolio.
	extraPortfolio add: account.
	
	self 
		should: [ extraPortfolio add: account. ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccount.
			].
	! !

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 18:08:02'!
PASSED!
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/20/2022 18:08:06' prior: 50473787!
test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail
	
	| account portfolio extraPortfolio | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	account := ReceptiveAccount new.
	
	portfolio add: account.
	extraPortfolio add: portfolio.
	
	self 
		should: [ extraPortfolio add: account. ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccount.
			].
	! !

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 18:08:10'!
FAILURE!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 18:08:10'!
FAILURE!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 18:08:17'!
FAILURE!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 18:08:17'!
FAILURE!
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/20/2022 18:09:24' prior: 50473811!
test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail
	
	| account portfolio extraPortfolio | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	account := ReceptiveAccount new.
	
	portfolio add: account.
	extraPortfolio add: portfolio.
	
	self 
		should: [ extraPortfolio add: account. ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccountInPortfolio.
			].
	! !

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 18:09:26'!
FAILURE!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 18:09:26'!
FAILURE!
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/20/2022 18:09:31' prior: 50473850!
test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail
	
	| account portfolio extraPortfolio | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	account := ReceptiveAccount new.
	
	portfolio add: account.
	extraPortfolio add: portfolio.
	
	self 
		should: [ extraPortfolio add: account. ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccount.
			].
	! !
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/20/2022 18:10:20' prior: 50473879!
test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail
	
	| account portfolio extraPortfolio pepe | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	account := ReceptiveAccount new.
	
	portfolio add: account.
	extraPortfolio add: portfolio.
	
	pepe _ extraPortfolio add: account.
	
	self assert: false.
	! !
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/20/2022 18:11:37' prior: 50473897!
test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail
	
	| account portfolio extraPortfolio pepe | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	account := ReceptiveAccount new.
	
	portfolio add: account.
	extraPortfolio add: portfolio.
	
	pepe _ extraPortfolio add: account.
	
	
	self assert: false.
	! !

self flattenAccounts !
!ReceptiveAccount methodsFor: 'as yet unclassified' stamp: 'ldm 5/20/2022 18:15:30' prior: 50473587!
addTo: aPortfolio

	((aPortfolio flattenAccounts) includes: self) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccount].
	(aPortfolio accountExistsInParentPorfolios: self) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccount].
	(aPortfolio accounts) add: self.
! !

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 18:15:37'!
ERROR!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 18:15:42'!
FAILURE!
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/20/2022 18:09:31' prior: 50473912!
test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail
	
	| account portfolio extraPortfolio | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	account := ReceptiveAccount new.
	
	portfolio add: account.
	extraPortfolio add: portfolio.
	
	self 
		should: [ extraPortfolio add: account. ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccount.
			].
	! !

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/20/2022 18:16:19'!
PASSED!

!testRun: #ReceptiveAccountTest #test18xxx stamp: 'ldm 5/20/2022 18:16:26'!
PASSED!
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/20/2022 18:18:55'!
test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail
	
	| account portfolio extraPortfolio | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	account := ReceptiveAccount new.
	
	portfolio add: account.
	portfolio add: extraPortfolio.
	
	self 
		should: [ extraPortfolio add: account. ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccount.
			].
	! !

!methodRemoval: ReceptiveAccountTest #test18xxx stamp: 'ldm 5/20/2022 18:18:59'!
test18xxx
	
	| account portfolio extraPortfolio | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	account := ReceptiveAccount new.
	
	portfolio add: account.
	portfolio add: extraPortfolio.
	
	self 
		should: [ extraPortfolio add: account. ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccount.
			].
	!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'ldm 5/20/2022 18:20:21'!
PASSED!
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/20/2022 18:32:46'!
test19xxx
	
	| portfolio extraPortfolio | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	
	portfolio add: extraPortfolio.
	
	self 
		should: [ extraPortfolio add: portfolio. ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: true.
			].
	! !

!testRun: #ReceptiveAccountTest #test19xxx stamp: 'ldm 5/20/2022 18:32:49'!
FAILURE!

!testRun: #ReceptiveAccountTest #test19xxx stamp: 'ldm 5/20/2022 18:32:49'!
FAILURE!

----QUIT----(22 May 2022 15:13:39) CuisUniversity-5053.image priorSource: 4534153!

----STARTUP---- (22 May 2022 15:19:39) as /Users/lisandro.di.mateo/Documents/Lisandro/Facultad/ING/macos64/CuisUniversity-5053.image!


!testRun: #ReceptiveAccountTest #test19xxx stamp: 'ldm 5/22/2022 15:19:54'!
FAILURE!

!testRun: #ReceptiveAccountTest #test19xxx stamp: 'ldm 5/22/2022 15:19:54'!
FAILURE!
!Portfolio methodsFor: 'operations' stamp: 'ldm 5/22/2022 15:35:52' prior: 50473573!
addTo: aPortfolio

	(aPortfolio containsAnyAccountOf: self) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccountInPortfolio].
	(self containsAnyAccountOf: aPortfolio) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccountInPortfolio].
	(aPortfolio childrenPortfoliosDoesNotContain: self) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccountInPortfolio].
	(aPortfolio parentPortfoliosDoesNotContain: self) ifTrue: [self error: Portfolio cannotAddAlreadyAddedAccountInPortfolio].
	(aPortfolio portfolios) add: self.
	parentPorfolios add: aPortfolio.
		
	
	! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'ldm 5/22/2022 15:37:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 15:37:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 15:37:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'ldm 5/22/2022 15:37:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'ldm 5/22/2022 15:37:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'ldm 5/22/2022 15:37:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'ldm 5/22/2022 15:37:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'ldm 5/22/2022 15:37:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'ldm 5/22/2022 15:37:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'ldm 5/22/2022 15:37:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'ldm 5/22/2022 15:37:38'!
ERROR!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'ldm 5/22/2022 15:37:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'ldm 5/22/2022 15:37:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'ldm 5/22/2022 15:37:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'ldm 5/22/2022 15:37:38'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'ldm 5/22/2022 15:37:38'!
ERROR!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/22/2022 15:37:38'!
ERROR!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'ldm 5/22/2022 15:37:38'!
ERROR!

!testRun: #ReceptiveAccountTest #test19xxx stamp: 'ldm 5/22/2022 15:37:38'!
ERROR!

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'ldm 5/22/2022 15:37:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 15:37:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 15:37:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'ldm 5/22/2022 15:37:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'ldm 5/22/2022 15:37:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'ldm 5/22/2022 15:37:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'ldm 5/22/2022 15:37:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'ldm 5/22/2022 15:37:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'ldm 5/22/2022 15:37:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'ldm 5/22/2022 15:37:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'ldm 5/22/2022 15:37:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'ldm 5/22/2022 15:37:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'ldm 5/22/2022 15:37:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'ldm 5/22/2022 15:37:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'ldm 5/22/2022 15:37:47'!
ERROR!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'ldm 5/22/2022 15:37:47'!
ERROR!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/22/2022 15:37:47'!
ERROR!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'ldm 5/22/2022 15:37:47'!
ERROR!

!testRun: #ReceptiveAccountTest #test19xxx stamp: 'ldm 5/22/2022 15:37:47'!
ERROR!

!testRun: #ReceptiveAccountTest #test19xxx stamp: 'ldm 5/22/2022 15:37:56'!
ERROR!

!testRun: #ReceptiveAccountTest #test19xxx stamp: 'ldm 5/22/2022 15:37:56'!
ERROR!
!Portfolio methodsFor: 'operations' stamp: 'ldm 5/22/2022 15:38:01'!
childrenPortfoliosDoesNotContain: aPortfolio 
	self shouldBeImplemented.! !
!Portfolio methodsFor: 'operations' stamp: 'ldm 5/22/2022 15:39:58' prior: 50474222!
childrenPortfoliosDoesNotContain: aPortfolio 
	^(portfolios includes: aPortfolio) or: [portfolios anySatisfy: [:aChildrenPortfolio | aChildrenPortfolio childrenPortfoliosDoesNotContain: aPortfolio ]].! !

!testRun: #ReceptiveAccountTest #test19xxx stamp: 'ldm 5/22/2022 15:40:06'!
ERROR!

!testRun: #ReceptiveAccountTest #test19xxx stamp: 'ldm 5/22/2022 15:40:06'!
ERROR!
!Portfolio methodsFor: 'operations' stamp: 'ldm 5/22/2022 15:40:12'!
parentPortfoliosDoesNotContain: aPortfolio 
	self shouldBeImplemented.! !
!Portfolio methodsFor: 'operations' stamp: 'ldm 5/22/2022 15:41:51' prior: 50474242!
parentPortfoliosDoesNotContain: aPortfolio 
	^(parentPorfolios includes: aPortfolio) or: [parentPorfolios anySatisfy: [:aParentPorfolios | aParentPorfolios parentPortfoliosDoesNotContain: aPortfolio ]].! !

!testRun: #ReceptiveAccountTest #test19xxx stamp: 'ldm 5/22/2022 15:42:22'!
PASSED!
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/22/2022 15:43:04' prior: 50474013!
test19xxx
	
	| portfolio extraPortfolio | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	
	portfolio add: extraPortfolio.
	
	self 
		should: [ extraPortfolio add: portfolio. ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccount.
			].
	! !

!testRun: #ReceptiveAccountTest #test19xxx stamp: 'ldm 5/22/2022 15:43:07'!
FAILURE!

!testRun: #ReceptiveAccountTest #test19xxx stamp: 'ldm 5/22/2022 15:43:07'!
FAILURE!
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/22/2022 15:43:38' prior: 50474259!
test19xxx
	
	| portfolio extraPortfolio | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	
	portfolio add: extraPortfolio.
	
	self 
		should: [ extraPortfolio add: portfolio. ] 
		raise: Error
		withExceptionDo: [ :error |
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccountInPortfolio
			].
	! !

!testRun: #ReceptiveAccountTest #test19xxx stamp: 'ldm 5/22/2022 15:43:40'!
PASSED!

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'ldm 5/22/2022 15:43:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 15:43:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 15:43:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'ldm 5/22/2022 15:43:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'ldm 5/22/2022 15:43:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'ldm 5/22/2022 15:43:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'ldm 5/22/2022 15:43:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'ldm 5/22/2022 15:43:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'ldm 5/22/2022 15:43:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'ldm 5/22/2022 15:43:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'ldm 5/22/2022 15:43:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'ldm 5/22/2022 15:43:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'ldm 5/22/2022 15:43:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'ldm 5/22/2022 15:43:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'ldm 5/22/2022 15:43:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'ldm 5/22/2022 15:43:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/22/2022 15:43:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'ldm 5/22/2022 15:43:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test19xxx stamp: 'ldm 5/22/2022 15:43:44'!
PASSED!
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/22/2022 15:45:05'!
test19AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError
	
	| portfolio extraPortfolio | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	
	portfolio add: extraPortfolio.
	
	self 
		should: [ extraPortfolio add: portfolio. ] 
		raise: Error
		withExceptionDo: [ :error |
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccountInPortfolio
			].
	! !

!methodRemoval: ReceptiveAccountTest #test19xxx stamp: 'ldm 5/22/2022 15:45:13'!
test19xxx
	
	| portfolio extraPortfolio | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	
	portfolio add: extraPortfolio.
	
	self 
		should: [ extraPortfolio add: portfolio. ] 
		raise: Error
		withExceptionDo: [ :error |
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccountInPortfolio
			].
	!
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/22/2022 15:55:11'!
test20xxxx
	
	| portfolioA portfolioB portfolioC portfolioD portfolioE  | 
	
	portfolioA := Portfolio new.
	portfolioB := Portfolio new.
	portfolioC := Portfolio new.
	portfolioD := Portfolio new.
	portfolioE := Portfolio new.
	
	portfolioA add: portfolioB.
	portfolioA add: portfolioE.
	portfolioB add: portfolioC.
	portfolioB add: portfolioD.
	
	self 
		should: [ portfolioC add: portfolioE. ] 
		raise: Error
		withExceptionDo: [ :error |
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccountInPortfolio
			].
	! !

!testRun: #ReceptiveAccountTest #test20xxxx stamp: 'ldm 5/22/2022 15:55:15'!
FAILURE!

!testRun: #ReceptiveAccountTest #test20xxxx stamp: 'ldm 5/22/2022 15:55:15'!
FAILURE!
!Portfolio methodsFor: 'operations' stamp: 'ldm 5/22/2022 15:58:56' prior: 50474247!
parentPortfoliosDoesNotContain: aPortfolio 
	| portfolioToAddIsAParentPortfolio portfolioToAddIsChildrenOfAParentPortfolio portfolioToAddIsParentOfAParentPortfolio |
	portfolioToAddIsAParentPortfolio _ (parentPorfolios includes: aPortfolio).
	portfolioToAddIsChildrenOfAParentPortfolio _ false.
	portfolioToAddIsParentOfAParentPortfolio _ parentPorfolios anySatisfy: [:aParentPorfolios | aParentPorfolios parentPortfoliosDoesNotContain: aPortfolio ].
	^ portfolioToAddIsAParentPortfolio or: [portfolioToAddIsChildrenOfAParentPortfolio or: [portfolioToAddIsParentOfAParentPortfolio ] ]. ! !
!Portfolio methodsFor: 'operations' stamp: 'ldm 5/22/2022 16:01:03' prior: 50474426!
parentPortfoliosDoesNotContain: aPortfolio 
	| portfolioToAddIsAParentPortfolio portfolioToAddIsChildrenOfAParentPortfolio portfolioToAddIsParentOfAParentPortfolio |
	portfolioToAddIsAParentPortfolio _ (parentPorfolios includes: aPortfolio).
	portfolioToAddIsChildrenOfAParentPortfolio _ parentPorfolios do: [:aParentPortfolio | aParentPortfolio childrenPortfoliosDoesNotContain: aPortfolio].
	portfolioToAddIsParentOfAParentPortfolio _ parentPorfolios anySatisfy: [:aParentPorfolios | aParentPorfolios parentPortfoliosDoesNotContain: aPortfolio ].
	^ portfolioToAddIsAParentPortfolio or: [portfolioToAddIsChildrenOfAParentPortfolio or: [portfolioToAddIsParentOfAParentPortfolio ] ]. ! !

!testRun: #ReceptiveAccountTest #test20xxxx stamp: 'ldm 5/22/2022 16:01:11'!
ERROR!

!testRun: #ReceptiveAccountTest #test20xxxx stamp: 'ldm 5/22/2022 16:01:11'!
ERROR!
!Portfolio methodsFor: 'operations' stamp: 'ldm 5/22/2022 16:01:33' prior: 50474448!
parentPortfoliosDoesNotContain: aPortfolio 
	| portfolioToAddIsAParentPortfolio portfolioToAddIsChildrenOfAParentPortfolio portfolioToAddIsParentOfAParentPortfolio |
	portfolioToAddIsAParentPortfolio _ (parentPorfolios includes: aPortfolio).
	portfolioToAddIsChildrenOfAParentPortfolio _ parentPorfolios anySatisfy: [:aParentPortfolio | aParentPortfolio childrenPortfoliosDoesNotContain: aPortfolio].
	portfolioToAddIsParentOfAParentPortfolio _ parentPorfolios anySatisfy: [:aParentPorfolios | aParentPorfolios parentPortfoliosDoesNotContain: aPortfolio ].
	^ portfolioToAddIsAParentPortfolio or: [portfolioToAddIsChildrenOfAParentPortfolio or: [portfolioToAddIsParentOfAParentPortfolio ] ]. ! !

!testRun: #ReceptiveAccountTest #test20xxxx stamp: 'ldm 5/22/2022 16:01:39'!
PASSED!

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'ldm 5/22/2022 16:01:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 16:01:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 16:01:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'ldm 5/22/2022 16:01:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'ldm 5/22/2022 16:01:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'ldm 5/22/2022 16:01:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'ldm 5/22/2022 16:01:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'ldm 5/22/2022 16:01:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'ldm 5/22/2022 16:01:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'ldm 5/22/2022 16:01:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'ldm 5/22/2022 16:01:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'ldm 5/22/2022 16:01:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'ldm 5/22/2022 16:01:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'ldm 5/22/2022 16:01:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'ldm 5/22/2022 16:01:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'ldm 5/22/2022 16:01:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/22/2022 16:01:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'ldm 5/22/2022 16:01:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'ldm 5/22/2022 16:01:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test20xxxx stamp: 'ldm 5/22/2022 16:01:45'!
PASSED!
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/22/2022 16:04:04'!
test19AddingAPortfolioToAnyParentPortfolioThrowsAnError
	
	| portfolio extraPortfolio | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	
	portfolio add: extraPortfolio.
	
	self 
		should: [ extraPortfolio add: portfolio. ] 
		raise: Error
		withExceptionDo: [ :error |
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccountInPortfolio
			].
	! !
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/22/2022 16:04:19'!
test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError
	
	| portfolioA portfolioB portfolioC portfolioD portfolioE  | 
	
	portfolioA := Portfolio new.
	portfolioB := Portfolio new.
	portfolioC := Portfolio new.
	portfolioD := Portfolio new.
	portfolioE := Portfolio new.
	
	portfolioA add: portfolioB.
	portfolioA add: portfolioE.
	portfolioB add: portfolioC.
	portfolioB add: portfolioD.
	
	self 
		should: [ portfolioC add: portfolioE. ] 
		raise: Error
		withExceptionDo: [ :error |
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccountInPortfolio
			].
	! !

!methodRemoval: ReceptiveAccountTest #test20xxxx stamp: 'ldm 5/22/2022 16:04:23'!
test20xxxx
	
	| portfolioA portfolioB portfolioC portfolioD portfolioE  | 
	
	portfolioA := Portfolio new.
	portfolioB := Portfolio new.
	portfolioC := Portfolio new.
	portfolioD := Portfolio new.
	portfolioE := Portfolio new.
	
	portfolioA add: portfolioB.
	portfolioA add: portfolioE.
	portfolioB add: portfolioC.
	portfolioB add: portfolioD.
	
	self 
		should: [ portfolioC add: portfolioE. ] 
		raise: Error
		withExceptionDo: [ :error |
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccountInPortfolio
			].
	!

!methodRemoval: ReceptiveAccountTest #test19AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'ldm 5/22/2022 16:04:27'!
test19AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError
	
	| portfolio extraPortfolio | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	
	portfolio add: extraPortfolio.
	
	self 
		should: [ extraPortfolio add: portfolio. ] 
		raise: Error
		withExceptionDo: [ :error |
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccountInPortfolio
			].
	!

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'ldm 5/22/2022 16:04:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 16:04:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 16:04:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'ldm 5/22/2022 16:04:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'ldm 5/22/2022 16:04:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'ldm 5/22/2022 16:04:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'ldm 5/22/2022 16:04:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'ldm 5/22/2022 16:04:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'ldm 5/22/2022 16:04:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'ldm 5/22/2022 16:04:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'ldm 5/22/2022 16:04:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'ldm 5/22/2022 16:04:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'ldm 5/22/2022 16:04:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'ldm 5/22/2022 16:04:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'ldm 5/22/2022 16:04:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'ldm 5/22/2022 16:04:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/22/2022 16:04:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'ldm 5/22/2022 16:04:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToAnyParentPortfolioThrowsAnError stamp: 'ldm 5/22/2022 16:04:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'ldm 5/22/2022 16:04:30'!
PASSED!
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'ldm 5/22/2022 16:04:47'!
test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError
	
	| portfolio extraPortfolio | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	
	portfolio add: extraPortfolio.
	
	self 
		should: [ extraPortfolio add: portfolio. ] 
		raise: Error
		withExceptionDo: [ :error |
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccountInPortfolio
			].
	! !

!methodRemoval: ReceptiveAccountTest #test19AddingAPortfolioToAnyParentPortfolioThrowsAnError stamp: 'ldm 5/22/2022 16:04:47'!
test19AddingAPortfolioToAnyParentPortfolioThrowsAnError
	
	| portfolio extraPortfolio | 
	
	portfolio := Portfolio new.
	extraPortfolio := Portfolio new.
	
	portfolio add: extraPortfolio.
	
	self 
		should: [ extraPortfolio add: portfolio. ] 
		raise: Error
		withExceptionDo: [ :error |
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccountInPortfolio
			].
	!

----SNAPSHOT----(22 May 2022 16:05:47) CuisUniversity-5053.image priorSource: 4556128!

Object subclass: #BankAsset
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!

!classDefinition: #BankAsset category: 'Portfolio-Ejercicio' stamp: 'ldm 5/22/2022 16:12:19'!
Object subclass: #BankAsset
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!
!Behavior method!
initialize
	(transactions _ [
	(OrderedCollection
		cover: (30 to: 46)
		declaredAt: (30 to: 46)) new ] valueCoveringAll:
		{48 to: 50})
		cover: (14 to: 25)
		declaredAt: (14 to: 25).! !
!Behavior method!
balance
	| accumulatedBalance |
	(accumulatedBalance _ 0 coverAll:
		{55 to: 55})
		cover: (34 to: 51)
		declaredAt: (12 to: 29).
	[
	(transactions
		cover: (59 to: 70)
		declaredAt: (59 to: 70)) do: [ :aTransaction |
		(accumulatedBalance _ [
		(aTransaction
			cover: (118 to: 129)
			declaredAt: (78 to: 89)) applyTo:
			(accumulatedBalance
				cover: (97 to: 114)
				declaredAt: (12 to: 29)) ] valueCoveringAll:
			{131 to: 138})
			cover: (140 to: 157)
			declaredAt: (12 to: 29) ]] valueCoveringAll:
		{72 to: 74}.
	^ accumulatedBalance
		cover: (167 to: 184)
		declaredAt: (12 to: 29).! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'ldm 5/22/2022 16:12:27'!
PASSED!
!Behavior method!
register: aValue on: account
	| transaction |
	(transaction _ [
	(self coverAll:
		{66 to: 69}) for:
		(aValue
			cover: (76 to: 81)
			declaredAt: (11 to: 16)) ] valueCoveringAll:
		{71 to: 74})
		cover: (51 to: 61)
		declaredAt: (34 to: 44).
	[
	(account
		cover: (85 to: 91)
		declaredAt: (22 to: 28)) register:
		(transaction
			cover: (103 to: 113)
			declaredAt: (34 to: 44)) ] valueCoveringAll:
		{93 to: 101}.
	^ transaction
		cover: (122 to: 132)
		declaredAt: (34 to: 44).! !
!Behavior method!
for: aValue
	^ [
	([
	(self coverAll:
		{17 to: 20}) new ] valueCoveringAll:
		{22 to: 24}) initializeFor:
		(aValue
			cover: (41 to: 46)
			declaredAt: (6 to: 11)) ] valueCoveringAll:
		{26 to: 39}.! !
!Behavior method!
initializeFor: aValue
	(value _ aValue
		cover: (34 to: 39)
		declaredAt: (16 to: 21))
		cover: (25 to: 29)
		declaredAt: (25 to: 29).! !
!Behavior method!
register: aTransaction
	[
	(transactions
		cover: (26 to: 37)
		declaredAt: (26 to: 37)) add:
		(aTransaction
			cover: (44 to: 55)
			declaredAt: (11 to: 22)) ] valueCoveringAll:
		{39 to: 42}.! !
!Behavior method!
applyTo: anAmount
	^ [
	(value
		cover: (22 to: 26)
		declaredAt: (22 to: 26)) +
		(anAmount
			cover: (30 to: 37)
			declaredAt: (10 to: 17)) ] valueCoveringAll:
		{28 to: 28}.! !

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 16:12:27'!
PASSED!
!Behavior method!
for: aValue
	^ [
	([
	(self coverAll:
		{17 to: 20}) new ] valueCoveringAll:
		{22 to: 24}) initializeFor:
		(aValue
			cover: (41 to: 46)
			declaredAt: (6 to: 11)) ] valueCoveringAll:
		{26 to: 39}.! !
!Behavior method!
initializeFor: aValue
	(value _ aValue
		cover: (34 to: 39)
		declaredAt: (16 to: 21))
		cover: (25 to: 29)
		declaredAt: (25 to: 29).! !
!Behavior method!
applyTo: anAmount
	^ [
	(anAmount
		cover: (22 to: 29)
		declaredAt: (10 to: 17)) -
		(value
			cover: (33 to: 37)
			declaredAt: (33 to: 37)) ] valueCoveringAll:
		{31 to: 31}.! !

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 16:12:27'!
PASSED!
!Behavior method!
value
	^ value
		cover: (11 to: 15)
		declaredAt: (11 to: 15).! !

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'ldm 5/22/2022 16:12:27'!
PASSED!
!Behavior method!
hasRegistered: aTransaction
	^ [
	(transactions
		cover: (33 to: 44)
		declaredAt: (33 to: 44)) includes:
		(aTransaction
			cover: (56 to: 67)
			declaredAt: (16 to: 27)) ] valueCoveringAll:
		{46 to: 54}.! !

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'ldm 5/22/2022 16:12:27'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'ldm 5/22/2022 16:12:27'!
PASSED!
!Behavior method!
transactions
	^ [
	(transactions
		cover: (19 to: 30)
		declaredAt: (19 to: 30)) copy ] valueCoveringAll:
		{32 to: 35}.! !

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'ldm 5/22/2022 16:12:27'!
PASSED!
!Behavior method!
initialize
	(accounts _ [
	(OrderedCollection
		cover: (24 to: 40)
		declaredAt: (24 to: 40)) new ] valueCoveringAll:
		{42 to: 44})
		cover: (13 to: 20)
		declaredAt: (13 to: 20).
	(portfolios _ [
	(OrderedCollection
		cover: (61 to: 77)
		declaredAt: (24 to: 40)) new ] valueCoveringAll:
		{79 to: 81})
		cover: (48 to: 57)
		declaredAt: (48 to: 57).
	(parentPorfolios _ [
	(OrderedCollection
		cover: (103 to: 119)
		declaredAt: (24 to: 40)) new ] valueCoveringAll:
		{121 to: 123})
		cover: (85 to: 99)
		declaredAt: (85 to: 99).! !
!Behavior method!
balance
	| balanceOfAccounts balanceOfPortfolios |
	(balanceOfAccounts _ [
	(accounts
		cover: (71 to: 78)
		declaredAt: (71 to: 78))
		sum: [ :anAccount |
			[
			(anAccount
				cover: (99 to: 107)
				declaredAt: (87 to: 95)) balance ] valueCoveringAll:
				{109 to: 115} ]
		ifEmpty: [
			0 coverAll:
				{129 to: 129} ]] valueCoveringAll:
		{80 to: 83. 119 to: 126})
		cover: (51 to: 67)
		declaredAt: (11 to: 27).
	(balanceOfPortfolios _ [
	(portfolios
		cover: (156 to: 165)
		declaredAt: (156 to: 165))
		sum: [ :aPortfolio |
			[
			(aPortfolio
				cover: (187 to: 196)
				declaredAt: (174 to: 183)) balance ] valueCoveringAll:
				{198 to: 204} ]
		ifEmpty: [
			0 coverAll:
				{218 to: 218} ]] valueCoveringAll:
		{167 to: 170. 208 to: 215})
		cover: (134 to: 152)
		declaredAt: (29 to: 47).
	^ [
	(balanceOfAccounts
		cover: (224 to: 240)
		declaredAt: (11 to: 27)) +
		(balanceOfPortfolios
			cover: (244 to: 262)
			declaredAt: (29 to: 47)) ] valueCoveringAll:
		{242 to: 242}.! !

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'ldm 5/22/2022 16:12:27'!
PASSED!
!Behavior method!
add: anAsset
	[
	(anAsset
		cover: (15 to: 21)
		declaredAt: (6 to: 12)) addTo:
		(self coverAll:
			{30 to: 33}) ] valueCoveringAll:
		{23 to: 28}.! !
!Behavior method!
addTo: aPortfolio
	[
	([
	([
	(aPortfolio
		cover: (23 to: 32)
		declaredAt: (8 to: 17)) flattenAccounts ] valueCoveringAll:
		{34 to: 48}) includes:
		(self coverAll:
			{61 to: 64}) ] valueCoveringAll:
		{51 to: 59}) ifTrue: [
		[
		(self coverAll:
			{76 to: 79}) error:
			([
			(Portfolio
				cover: (88 to: 96)
				declaredAt: (88 to: 96)) cannotAddAlreadyAddedAccount ] valueCoveringAll:
				{98 to: 125}) ] valueCoveringAll:
			{81 to: 86} ]] valueCoveringAll:
		{67 to: 73}.
	[
	([
	(aPortfolio
		cover: (131 to: 140)
		declaredAt: (8 to: 17)) accountExistsInParentPorfolios:
		(self coverAll:
			{174 to: 177}) ] valueCoveringAll:
		{142 to: 172}) ifTrue: [
		[
		(self coverAll:
			{189 to: 192}) error:
			([
			(Portfolio
				cover: (201 to: 209)
				declaredAt: (88 to: 96)) cannotAddAlreadyAddedAccount ] valueCoveringAll:
				{211 to: 238}) ] valueCoveringAll:
			{194 to: 199} ]] valueCoveringAll:
		{180 to: 186}.
	[
	([
	(aPortfolio
		cover: (244 to: 253)
		declaredAt: (8 to: 17)) accounts ] valueCoveringAll:
		{255 to: 262}) add:
		(self coverAll:
			{270 to: 273}) ] valueCoveringAll:
		{265 to: 268}.! !
!Behavior method!
flattenAccounts
	| flattenAccounts |
	(flattenAccounts _ accounts
		cover: (56 to: 63)
		declaredAt: (56 to: 63))
		cover: (38 to: 52)
		declaredAt: (20 to: 34).
	[
	(portfolios
		cover: (67 to: 76)
		declaredAt: (67 to: 76)) do: [ :aPortfolio |
		(flattenAccounts _ [
		(flattenAccounts
			cover: (101 to: 115)
			declaredAt: (20 to: 34)) ,
			([
			(aPortfolio
				cover: (137 to: 146)
				declaredAt: (84 to: 93)) flattenAccounts ] valueCoveringAll:
				{148 to: 162}) ] valueCoveringAll:
			{134 to: 134})
			cover: (119 to: 133)
			declaredAt: (20 to: 34) ]] valueCoveringAll:
		{78 to: 80}.
	^ flattenAccounts
		cover: (172 to: 186)
		declaredAt: (20 to: 34).! !
!Behavior method!
accountExistsInParentPorfolios: aReceptiveAccount
	| a |
	(a _ [
	(parentPorfolios
		cover: (63 to: 77)
		declaredAt: (63 to: 77)) anySatisfy: [ :aParentPortfolio |
		[
		(aParentPortfolio
			cover: (112 to: 127)
			declaredAt: (93 to: 108)) accountExistsInParentPorfolios:
			(aReceptiveAccount
				cover: (161 to: 177)
				declaredAt: (33 to: 49)) ] valueCoveringAll:
			{129 to: 159} ]] valueCoveringAll:
		{79 to: 89})
		cover: (59 to: 59)
		declaredAt: (54 to: 54).
	^ [
	([
	(accounts
		cover: (184 to: 191)
		declaredAt: (184 to: 191)) includes:
		(aReceptiveAccount
			cover: (203 to: 219)
			declaredAt: (33 to: 49)) ] valueCoveringAll:
		{193 to: 201}) or: [
		a
			cover: (227 to: 227)
			declaredAt: (54 to: 54) ]] valueCoveringAll:
		{222 to: 224}.! !
!Behavior method!
accounts
	^ accounts
		cover: (12 to: 19)
		declaredAt: (12 to: 19).! !

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'ldm 5/22/2022 16:12:27'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'ldm 5/22/2022 16:12:27'!
PASSED!
!Behavior method!
addTo: aPortfolio
	[
	([
	(aPortfolio
		cover: (22 to: 31)
		declaredAt: (8 to: 17)) containsAnyAccountOf:
		(self coverAll:
			{55 to: 58}) ] valueCoveringAll:
		{33 to: 53}) ifTrue: [
		[
		(self coverAll:
			{70 to: 73}) error:
			([
			(Portfolio
				cover: (82 to: 90)
				declaredAt: (82 to: 90)) cannotAddAlreadyAddedAccountInPortfolio ] valueCoveringAll:
				{92 to: 130}) ] valueCoveringAll:
			{75 to: 80} ]] valueCoveringAll:
		{61 to: 67}.
	[
	([
	(self coverAll:
		{136 to: 139}) containsAnyAccountOf:
		(aPortfolio
			cover: (163 to: 172)
			declaredAt: (8 to: 17)) ] valueCoveringAll:
		{141 to: 161}) ifTrue: [
		[
		(self coverAll:
			{184 to: 187}) error:
			([
			(Portfolio
				cover: (196 to: 204)
				declaredAt: (82 to: 90)) cannotAddAlreadyAddedAccountInPortfolio ] valueCoveringAll:
				{206 to: 244}) ] valueCoveringAll:
			{189 to: 194} ]] valueCoveringAll:
		{175 to: 181}.
	[
	([
	(aPortfolio
		cover: (250 to: 259)
		declaredAt: (8 to: 17)) childrenPortfoliosDoesNotContain:
		(self coverAll:
			{295 to: 298}) ] valueCoveringAll:
		{261 to: 293}) ifTrue: [
		[
		(self coverAll:
			{310 to: 313}) error:
			([
			(Portfolio
				cover: (322 to: 330)
				declaredAt: (82 to: 90)) cannotAddAlreadyAddedAccountInPortfolio ] valueCoveringAll:
				{332 to: 370}) ] valueCoveringAll:
			{315 to: 320} ]] valueCoveringAll:
		{301 to: 307}.
	[
	([
	(aPortfolio
		cover: (376 to: 385)
		declaredAt: (8 to: 17)) parentPortfoliosDoesNotContain:
		(self coverAll:
			{419 to: 422}) ] valueCoveringAll:
		{387 to: 417}) ifTrue: [
		[
		(self coverAll:
			{434 to: 437}) error:
			([
			(Portfolio
				cover: (446 to: 454)
				declaredAt: (82 to: 90)) cannotAddAlreadyAddedAccountInPortfolio ] valueCoveringAll:
				{456 to: 494}) ] valueCoveringAll:
			{439 to: 444} ]] valueCoveringAll:
		{425 to: 431}.
	[
	([
	(aPortfolio
		cover: (500 to: 509)
		declaredAt: (8 to: 17)) portfolios ] valueCoveringAll:
		{511 to: 520}) add:
		(self coverAll:
			{528 to: 531}) ] valueCoveringAll:
		{523 to: 526}.
	[
	(parentPorfolios
		cover: (535 to: 549)
		declaredAt: (535 to: 549)) add:
		(aPortfolio
			cover: (556 to: 565)
			declaredAt: (8 to: 17)) ] valueCoveringAll:
		{551 to: 554}.! !
!Behavior method!
containsAnyAccountOf: aPortfolio
	| otherPortfolioAccounts |
	(otherPortfolioAccounts _ [
	(aPortfolio
		cover: (87 to: 96)
		declaredAt: (23 to: 32)) flattenAccounts ] valueCoveringAll:
		{98 to: 112})
		cover: (62 to: 83)
		declaredAt: (37 to: 58).
	[
	([
	(self coverAll:
		{116 to: 119}) flattenAccounts ] valueCoveringAll:
		{121 to: 135}) do: [ :anAccount |
		[
		([
		(otherPortfolioAccounts
			cover: (160 to: 181)
			declaredAt: (37 to: 58)) includes:
			(anAccount
				cover: (193 to: 201)
				declaredAt: (143 to: 151)) ] valueCoveringAll:
			{183 to: 191}) ifTrue: [ ^ true coverAll:
				{214 to: 217} ]] valueCoveringAll:
			{204 to: 210} ]] valueCoveringAll:
		{137 to: 139}.
	^ false coverAll:
		{228 to: 232}.! !
!Behavior method!
childrenPortfoliosDoesNotContain: aPortfolio
	^ [
	([
	(portfolios
		cover: (50 to: 59)
		declaredAt: (50 to: 59)) includes:
		(aPortfolio
			cover: (71 to: 80)
			declaredAt: (35 to: 44)) ] valueCoveringAll:
		{61 to: 69}) or: [
		[
		(portfolios
			cover: (88 to: 97)
			declaredAt: (50 to: 59)) anySatisfy: [ :aChildrenPortfolio |
			[
			(aChildrenPortfolio
				cover: (134 to: 151)
				declaredAt: (113 to: 130)) childrenPortfoliosDoesNotContain:
				(aPortfolio
					cover: (187 to: 196)
					declaredAt: (35 to: 44)) ] valueCoveringAll:
				{153 to: 185} ]] valueCoveringAll:
			{99 to: 109} ]] valueCoveringAll:
		{83 to: 85}.! !
!Behavior method!
parentPortfoliosDoesNotContain: aPortfolio
	| portfolioToAddIsAParentPortfolio portfolioToAddIsChildrenOfAParentPortfolio portfolioToAddIsParentOfAParentPortfolio |
	(portfolioToAddIsAParentPortfolio _ [
	(parentPorfolios
		cover: (204 to: 218)
		declaredAt: (204 to: 218)) includes:
		(aPortfolio
			cover: (230 to: 239)
			declaredAt: (33 to: 42)) ] valueCoveringAll:
		{220 to: 228})
		cover: (168 to: 199)
		declaredAt: (48 to: 79).
	(portfolioToAddIsChildrenOfAParentPortfolio _ [
	(parentPorfolios
		cover: (289 to: 303)
		declaredAt: (204 to: 218)) anySatisfy: [ :aParentPortfolio |
		[
		(aParentPortfolio
			cover: (338 to: 353)
			declaredAt: (319 to: 334)) childrenPortfoliosDoesNotContain:
			(aPortfolio
				cover: (389 to: 398)
				declaredAt: (33 to: 42)) ] valueCoveringAll:
			{355 to: 387} ]] valueCoveringAll:
		{305 to: 315})
		cover: (244 to: 285)
		declaredAt: (81 to: 122).
	(portfolioToAddIsParentOfAParentPortfolio _ [
	(parentPorfolios
		cover: (446 to: 460)
		declaredAt: (204 to: 218)) anySatisfy: [ :aParentPorfolios |
		[
		(aParentPorfolios
			cover: (495 to: 510)
			declaredAt: (476 to: 491)) parentPortfoliosDoesNotContain:
			(aPortfolio
				cover: (544 to: 553)
				declaredAt: (33 to: 42)) ] valueCoveringAll:
			{512 to: 542} ]] valueCoveringAll:
		{462 to: 472})
		cover: (403 to: 442)
		declaredAt: (124 to: 163).
	^ [
	(portfolioToAddIsAParentPortfolio
		cover: (561 to: 592)
		declaredAt: (48 to: 79)) or: [
		[
		(portfolioToAddIsChildrenOfAParentPortfolio
			cover: (599 to: 640)
			declaredAt: (81 to: 122)) or: [
			portfolioToAddIsParentOfAParentPortfolio
				cover: (647 to: 686)
				declaredAt: (124 to: 163) ]] valueCoveringAll:
			{642 to: 644} ]] valueCoveringAll:
		{594 to: 596}.! !
!Behavior method!
portfolios
	^ portfolios
		cover: (14 to: 23)
		declaredAt: (14 to: 23).! !

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'ldm 5/22/2022 16:12:27'!
PASSED!
!Behavior method!
cannotAddAlreadyAddedAccount
	^ 'A portfolio cannot add an already added account.' coverAll:
		{32 to: 81}.! !

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'ldm 5/22/2022 16:12:27'!
PASSED!
!Behavior method!
cannotAddAlreadyAddedAccountInPortfolio
	^ 'A portfolio cannot add a portfolio that has a common account.' coverAll:
		{43 to: 105}.! !

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'ldm 5/22/2022 16:12:27'!
PASSED!
!Behavior method!
hasRegistered: aTransaction
	^ [
	([
	(self coverAll:
		{31 to: 34}) flattenAccounts ] valueCoveringAll:
		{36 to: 50}) anySatisfy: [ :anAccount |
		[
		([
		(anAccount
			cover: (78 to: 86)
			declaredAt: (66 to: 74)) transactions ] valueCoveringAll:
			{88 to: 99}) includes:
			(aTransaction
				cover: (111 to: 122)
				declaredAt: (16 to: 27)) ] valueCoveringAll:
			{101 to: 109} ]] valueCoveringAll:
		{52 to: 62}.! !

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'ldm 5/22/2022 16:12:27'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'ldm 5/22/2022 16:12:27'!
PASSED!
!Behavior method!
transactions
	| flattenTransactions |
	(flattenTransactions _ [
	(Set
		cover: (60 to: 62)
		declaredAt: (60 to: 62)) new ] valueCoveringAll:
		{64 to: 66})
		cover: (38 to: 56)
		declaredAt: (16 to: 34).
	[
	([
	(self coverAll:
		{70 to: 73}) flattenAccounts ] valueCoveringAll:
		{75 to: 89}) do: [ :anAccount |
		[
		(flattenTransactions
			cover: (109 to: 127)
			declaredAt: (16 to: 34)) addAll:
			([
			(anAccount
				cover: (138 to: 146)
				declaredAt: (97 to: 105)) transactions ] valueCoveringAll:
				{148 to: 159}) ] valueCoveringAll:
			{129 to: 135} ]] valueCoveringAll:
		{91 to: 93}.
	^ flattenTransactions
		cover: (166 to: 184)
		declaredAt: (16 to: 34).! !

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'ldm 5/22/2022 16:12:27'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/22/2022 16:12:27'!
PASSED!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'ldm 5/22/2022 16:12:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'ldm 5/22/2022 16:12:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'ldm 5/22/2022 16:12:28'!
PASSED!

Object subclass: #RoseTree
	instanceVariableNames: 'parents children'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!

!classDefinition: #RoseTree category: 'Portfolio-Ejercicio' stamp: 'ldm 5/22/2022 16:15:29'!
Object subclass: #RoseTree
	instanceVariableNames: 'parents children'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!
!RoseTree methodsFor: 'init' stamp: 'ldm 5/22/2022 16:16:56' overrides: 16920235!
initialize! !
!RoseTree methodsFor: 'init' stamp: 'ldm 5/22/2022 16:17:47' prior: 50475353 overrides: 16920235!
initialize
	children _ OrderedCollection new.
	parents _ OrderedCollection new.! !
!RoseTree methodsFor: 'assertions' stamp: 'ldm 5/22/2022 16:21:20'!
assertChildrenContainsRose: aRose
	^(children includes: aRose) or: [ children anySatisfy: [:aSubRoseTree | aSubRoseTree assertChildrenContainsRose: aRose] ].! !
!RoseTree methodsFor: 'assertions' stamp: 'ldm 5/22/2022 16:35:42'!
assertParentsContainsRose: aRose
	|parentsIncludesARose childrenOfParentsIncludesARose parentsOfParentsIncludesARose | 
	parentsIncludesARose _ parents includes: aRose.
	childrenOfParentsIncludesARose _ parents anySatisfy: [:aSubRoseTree | aSubRoseTree assertChildrenContainsRose: aRose].
	parentsOfParentsIncludesARose _ parents anySatisfy: [:aParent | aParent assertParentsContainsRose: aRose].
	^ parentsIncludesARose or: [childrenOfParentsIncludesARose or: [parentsOfParentsIncludesARose] ].! !
!RoseTree methodsFor: 'operations' stamp: 'ldm 5/22/2022 16:36:14'!
add: aRose
	! !
!RoseTree methodsFor: 'operations' stamp: 'ldm 5/22/2022 16:39:00' prior: 50475388!
add: aRose
	(self assertChildrenContainsRose: aRose) ifTrue: [self error: 'cycle generated'].
	(self assertParentsContainsRose: aRose) ifTrue: [self error: 'cycle generated'].
	children add: aRose.
	aRose addAsParent: self.	! !
!RoseTree methodsFor: 'operations' stamp: 'ldm 5/22/2022 16:39:33'!
addAsParent: aRose
	parents add: aRose.! !

!classDefinition: #RoseTree category: 'Portfolio-Ejercicio' stamp: 'ldm 5/22/2022 16:40:16'!
Object subclass: #RoseTree
	instanceVariableNames: 'parents children value'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!
!RoseTree methodsFor: 'init' stamp: 'ldm 5/22/2022 16:40:22' prior: 50475357 overrides: 16920235!
initialize
	children _ OrderedCollection new.
	parents _ OrderedCollection new.
	value _ nil.! !
!RoseTree methodsFor: 'operations' stamp: 'ldm 5/22/2022 16:41:32'!
setValue: aValue
	value _ aValue.! !

rt _ RoseTree new.!

rt setValue: $a.!

rt add: (RoseTree new setValue: $b).!

rt!

children first!

children first!

 a RoseTree !

children first!

children first!

rt add: (RoseTree new setValue: $e).!

rtA _ RoseTree new.!

rtA setValue: $a.!

rtB _ RoseTree new.!

rtB setValue: $b.!

rtC _ RoseTree new.!

rtC setValue: $c.!

rtD _ RoseTree new.!

rtD setValue: $d.!

rtE _ RoseTree new.!

rtE setValue: $e.!

rtA add: rtB.!

rtA add: rtE.!

rtA!

children first!

rtE add: rtB.!

rtE add: rtE.!

rtB add: rtA.!

rtC add: rtD.!

rtA _ RoseTree new.!

rtA setValue: $a.!

rtB _ RoseTree new.!

rtB setValue: $b.!

rtC _ RoseTree new.!

rtC setValue: $c.!

rtD _ RoseTree new.!

rtD setValue: $d.!

rtE _ RoseTree new.!

rtE setValue: $e.!

rtA add: rtB.!

rtA add: rtE.!

rtB add: rtC.!

rtB add: rtD.!

rtC add: rtD.!

rtD add: rtE.!

rtF _ RoseTree new.!

rtF setValue: $f.!

rtF add: rtB.!

rtA add: rtF.!
!RoseTree methodsFor: 'assertions' stamp: 'ldm 5/22/2022 17:08:09' prior: 50475362!
assertChildrenContainsRose: aRose
	^(children includes: aRose) or: [ (children anySatisfy: [:aSubRoseTree | aSubRoseTree assertChildrenContainsRose: aRose]) or: [
				aRose assertParentsOfChildrenContainsRose: self.
			] ].! !
!RoseTree methodsFor: 'assertions' stamp: 'ldm 5/22/2022 17:09:26'!
assertParentsOfChildrenContainsRose: aRose
	^children anySatisfy: [:aChildrenRose | aChildrenRose assertParentsContainsRose: aRose].! !

rtA _ RoseTree new.!

rtA setValue: $a.!

rtB _ RoseTree new.!

rtA _ RoseTree new.!

rtA setValue: $a.!

rtB _ RoseTree new.!

rtB setValue: $b.!

rtC _ RoseTree new.!

rtC setValue: $c.!

rtD _ RoseTree new.!

rtD setValue: $d.!

rtE _ RoseTree new.!

rtE setValue: $e.!

rtA add: rtB.!

rtA add: rtE.!

rtB add: rtC.!

rtB add: rtD.!

rtF _ RoseTree new.!

rtF setValue: $f.!

rtF add: rtB.!

rtA add: rtF.!

rtA add: rtF.!

rtF add: rtA.!

----SNAPSHOT----(22 May 2022 17:13:36) CuisUniversity-5053.image priorSource: 4579987!
!RoseTree class methodsFor: 'no messages' stamp: 'ldm 5/22/2022 17:15:52'!
with: aValue
	^RoseTree new withValue: aValue.! !
!RoseTree methodsFor: 'operations' stamp: 'ldm 5/22/2022 17:16:06'!
withValue: aValue
	value _ aValue.! !

!methodRemoval: RoseTree #setValue: stamp: 'ldm 5/22/2022 17:16:06'!
setValue: aValue
	value _ aValue.!

BankAsset subclass: #Portfolio
	instanceVariableNames: 'accounts portfolios parentPorfolios assets'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!

!classDefinition: #Portfolio category: 'Portfolio-Ejercicio' stamp: 'ldm 5/22/2022 17:17:20'!
BankAsset subclass: #Portfolio
	instanceVariableNames: 'accounts portfolios parentPorfolios assets'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!
!Portfolio methodsFor: 'initialize' stamp: 'ldm 5/22/2022 17:18:24' prior: 50473566 overrides: 16920235!
initialize
	accounts _ OrderedCollection new.
	portfolios _ OrderedCollection new.
	parentPorfolios _ OrderedCollection new.
	assets _ RoseTree with: self.! !
!Portfolio methodsFor: 'operations' stamp: 'ldm 5/22/2022 17:21:26' prior: 50473034!
add: anAsset
	assets add: (RoseTree with: anAsset).
	anAsset addTo: self.
! !
!Portfolio methodsFor: 'operations' stamp: 'ldm 5/22/2022 17:35:19' prior: 50472611 overrides: 50472863!
balance
	|balanceOfAccounts balanceOfPortfolios auxBalance|
	auxBalance _ 1.
	balanceOfAccounts _ accounts sum: [:anAccount | anAccount balance ] ifEmpty: [0].
	balanceOfPortfolios _ portfolios sum: [:aPortfolio | aPortfolio balance ] ifEmpty: [0].
	^balanceOfAccounts + balanceOfPortfolios.! !

#(1 2 3) inject: 10 into: [:acc :e | e]!

#(1 2 3) inject: 10 into: [:acc :e | acc + e]!
!RoseTree methodsFor: 'operations' stamp: 'ldm 5/22/2022 17:47:04'!
reduce: aBlockWithChildren with: aStartValue 
	(children isEmpty) ifTrue: [^ aBlockWithChildren value: value].
	children inject: aStartValue into: [:accum :child | (child reduce: aBlockWithChildren with: aStartValue) ]! !

!methodRemoval: RoseTree #reduce:with: stamp: 'ldm 5/22/2022 17:52:44'!
reduce: aBlockWithChildren with: aStartValue 
	(children isEmpty) ifTrue: [^ aBlockWithChildren value: value].
	children inject: aStartValue into: [:accum :child | (child reduce: aBlockWithChildren with: aStartValue) ]!
!RoseTree methodsFor: 'operations' stamp: 'ldm 5/22/2022 17:55:27'!
childrenAsCollection
	| collection |
	collection _ OrderedCollection new.
	children do: [:aChild | 
			collection add: (aChild value).
			collection _ collection , (aChild childrenAsCollection).
		].
	! !
!RoseTree methodsFor: 'operations' stamp: 'ldm 5/22/2022 17:56:01' prior: 50475562!
childrenAsCollection
	| collection |
	collection _ OrderedCollection with: value.
	children do: [:aChild | 
			collection add: (aChild value).
			collection _ collection , (aChild childrenAsCollection).
		].
	^collection.! !
!RoseTree methodsFor: 'operations' stamp: 'ldm 5/22/2022 17:56:16' overrides: 16902254!
value
	^value.! !

rtA _ RoseTree with: $a.!

rtB _ RoseTree with: $b.!

rtC _ RoseTree with: $c.!

rtD _ RoseTree with: $d.!

rtE _ RoseTree with: $e.!

rtA childrenAsCollection !

rtA add: rtB.!

rtA add: rtE.!

rtB add: rtC.!

rtB add: rtD.!

rtA childrenAsCollection !

rtA _ RoseTree with: $a.!

rtB _ RoseTree with: $b.!

rtC _ RoseTree with: $c.!

rtD _ RoseTree with: $d.!

rtE _ RoseTree with: $e.!

rtA add: rtB.!

rtA add: rtE.!

rtB add: rtC.!

rtB add: rtD.!

rtA childrenAsCollection !
!RoseTree methodsFor: 'operations' stamp: 'ldm 5/22/2022 18:00:31' prior: 50475572!
childrenAsCollection
	| collection |
	collection _ OrderedCollection new.
	children do: [:aChild | 
			collection add: (aChild value).
			collection _ collection , (aChild childrenAsCollection).
		].
	^collection.! !

rtA childrenAsCollection!
!RoseTree methodsFor: 'operations' stamp: 'ldm 5/22/2022 18:01:48'!
asCollection
	^(OrderedCollection with: value), (self childrenAsCollection).! !

rtA asCollection!
!Portfolio methodsFor: 'operations' stamp: 'ldm 5/22/2022 18:04:01' prior: 50475528 overrides: 50472863!
balance
	|balanceOfAccounts balanceOfPortfolios auxBalance|
	auxBalance _ assets asCollection sum: [:anAsset | anAsset balance] ifEmpty: [0].
	balanceOfAccounts _ accounts sum: [:anAccount | anAccount balance ] ifEmpty: [0].
	balanceOfPortfolios _ portfolios sum: [:aPortfolio | aPortfolio balance ] ifEmpty: [0].
	^balanceOfAccounts + balanceOfPortfolios.! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'ldm 5/22/2022 18:04:20'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 18:04:20'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 18:04:20'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'ldm 5/22/2022 18:04:20'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'ldm 5/22/2022 18:04:20'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'ldm 5/22/2022 18:04:20'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'ldm 5/22/2022 18:04:20'!
PASSED!
!Portfolio methodsFor: 'operations' stamp: 'ldm 5/22/2022 18:04:44' prior: 50475618 overrides: 50472863!
balance
	|balanceOfAccounts balanceOfPortfolios auxBalance|
	auxBalance _ (assets asCollection) sum: [:anAsset | anAsset balance] ifEmpty: [0].
	balanceOfAccounts _ accounts sum: [:anAccount | anAccount balance ] ifEmpty: [0].
	balanceOfPortfolios _ portfolios sum: [:aPortfolio | aPortfolio balance ] ifEmpty: [0].
	^balanceOfAccounts + balanceOfPortfolios.! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'ldm 5/22/2022 18:04:53'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 18:04:53'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 18:04:53'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'ldm 5/22/2022 18:04:53'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'ldm 5/22/2022 18:04:53'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'ldm 5/22/2022 18:04:53'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'ldm 5/22/2022 18:04:53'!
PASSED!

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'ldm 5/22/2022 18:05:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 18:05:53'!
PASSED!

self asCollection !
!Portfolio methodsFor: 'operations' stamp: 'ldm 5/22/2022 18:08:49' prior: 50475660 overrides: 50472863!
balance
	|balanceOfAccounts balanceOfPortfolios auxBalance|
	auxBalance _ (assets childrenAsCollection) sum: [:anAsset | anAsset balance] ifEmpty: [0].
	balanceOfAccounts _ accounts sum: [:anAccount | anAccount balance ] ifEmpty: [0].
	balanceOfPortfolios _ portfolios sum: [:aPortfolio | aPortfolio balance ] ifEmpty: [0].
	^balanceOfAccounts + balanceOfPortfolios.! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'ldm 5/22/2022 18:08:56'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 18:08:56'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 18:08:56'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'ldm 5/22/2022 18:08:56'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'ldm 5/22/2022 18:08:56'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'ldm 5/22/2022 18:08:56'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'ldm 5/22/2022 18:08:56'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'ldm 5/22/2022 18:08:56'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'ldm 5/22/2022 18:08:56'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'ldm 5/22/2022 18:08:56'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'ldm 5/22/2022 18:08:56'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'ldm 5/22/2022 18:08:56'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'ldm 5/22/2022 18:08:56'!
PASSED!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'ldm 5/22/2022 18:08:56'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'ldm 5/22/2022 18:08:56'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'ldm 5/22/2022 18:08:56'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/22/2022 18:08:56'!
PASSED!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'ldm 5/22/2022 18:08:56'!
PASSED!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'ldm 5/22/2022 18:08:56'!
PASSED!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'ldm 5/22/2022 18:08:56'!
PASSED!
!Portfolio methodsFor: 'operations' stamp: 'ldm 5/22/2022 18:09:14' prior: 50475710 overrides: 50472863!
balance
	|balanceOfAccounts balanceOfPortfolios auxBalance|
	auxBalance _ (assets childrenAsCollection) sum: [:anAsset | anAsset balance] ifEmpty: [0].
	balanceOfAccounts _ accounts sum: [:anAccount | anAccount balance ] ifEmpty: [0].
	balanceOfPortfolios _ portfolios sum: [:aPortfolio | aPortfolio balance ] ifEmpty: [0].
	^auxBalance.! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'ldm 5/22/2022 18:09:19'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 18:09:19'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 18:09:19'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'ldm 5/22/2022 18:09:19'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'ldm 5/22/2022 18:09:19'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'ldm 5/22/2022 18:09:19'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'ldm 5/22/2022 18:09:19'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'ldm 5/22/2022 18:09:19'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'ldm 5/22/2022 18:09:19'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'ldm 5/22/2022 18:09:19'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'ldm 5/22/2022 18:09:19'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'ldm 5/22/2022 18:09:19'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'ldm 5/22/2022 18:09:19'!
PASSED!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'ldm 5/22/2022 18:09:19'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'ldm 5/22/2022 18:09:19'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'ldm 5/22/2022 18:09:19'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/22/2022 18:09:19'!
PASSED!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'ldm 5/22/2022 18:09:19'!
PASSED!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'ldm 5/22/2022 18:09:19'!
PASSED!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'ldm 5/22/2022 18:09:19'!
PASSED!
!Portfolio methodsFor: 'operations' stamp: 'ldm 5/22/2022 18:09:43' prior: 50475809 overrides: 50472863!
balance 
	^(assets childrenAsCollection) sum: [:anAsset | anAsset balance] ifEmpty: [0].! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'ldm 5/22/2022 18:09:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 18:09:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 18:09:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'ldm 5/22/2022 18:09:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'ldm 5/22/2022 18:09:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'ldm 5/22/2022 18:09:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'ldm 5/22/2022 18:09:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'ldm 5/22/2022 18:09:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'ldm 5/22/2022 18:09:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'ldm 5/22/2022 18:09:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'ldm 5/22/2022 18:09:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'ldm 5/22/2022 18:09:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'ldm 5/22/2022 18:09:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'ldm 5/22/2022 18:09:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'ldm 5/22/2022 18:09:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'ldm 5/22/2022 18:09:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/22/2022 18:09:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'ldm 5/22/2022 18:09:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'ldm 5/22/2022 18:09:47'!
PASSED!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'ldm 5/22/2022 18:09:47'!
PASSED!

Set with: 2 with: 3!

Set with: 2 with: 3, Set with: 5!

(Set with: 2 with: 3), (Set with: 5)!
!Portfolio methodsFor: 'operations' stamp: 'ldm 5/22/2022 18:13:38' prior: 50472648 overrides: 50472859!
transactions
	|setOfTransactions|
	setOfTransactions _ Set new.
	assets childrenAsCollection do: [:anAsset | setOfTransactions addAll: (anAsset transactions)].
	^setOfTransactions.! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'ldm 5/22/2022 18:13:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 18:13:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 18:13:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'ldm 5/22/2022 18:13:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'ldm 5/22/2022 18:13:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'ldm 5/22/2022 18:13:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'ldm 5/22/2022 18:13:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'ldm 5/22/2022 18:13:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'ldm 5/22/2022 18:13:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'ldm 5/22/2022 18:13:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'ldm 5/22/2022 18:13:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'ldm 5/22/2022 18:13:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'ldm 5/22/2022 18:13:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'ldm 5/22/2022 18:13:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'ldm 5/22/2022 18:13:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'ldm 5/22/2022 18:13:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/22/2022 18:13:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'ldm 5/22/2022 18:13:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'ldm 5/22/2022 18:13:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'ldm 5/22/2022 18:13:48'!
PASSED!
!Portfolio methodsFor: 'operations' stamp: 'ldm 5/22/2022 18:15:08' prior: 50472641!
hasRegistered: aTransaction
	^self transactions includes: aTransaction.
	! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'ldm 5/22/2022 18:15:11'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 18:15:11'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'ldm 5/22/2022 18:15:11'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'ldm 5/22/2022 18:15:11'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'ldm 5/22/2022 18:15:11'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'ldm 5/22/2022 18:15:11'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'ldm 5/22/2022 18:15:11'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'ldm 5/22/2022 18:15:11'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'ldm 5/22/2022 18:15:11'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'ldm 5/22/2022 18:15:11'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'ldm 5/22/2022 18:15:11'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'ldm 5/22/2022 18:15:11'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'ldm 5/22/2022 18:15:11'!
PASSED!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'ldm 5/22/2022 18:15:11'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'ldm 5/22/2022 18:15:11'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'ldm 5/22/2022 18:15:11'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'ldm 5/22/2022 18:15:11'!
PASSED!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'ldm 5/22/2022 18:15:11'!
PASSED!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'ldm 5/22/2022 18:15:11'!
PASSED!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'ldm 5/22/2022 18:15:11'!
PASSED!

----SNAPSHOT----(22 May 2022 18:16:03) CuisUniversity-5053.image priorSource: 4602691!

----QUIT----(22 May 2022 18:16:16) CuisUniversity-5053.image priorSource: 4624950!

----STARTUP---- (22 May 2022 18:03:59) as C:\Users\andyf\Desktop\windows64\CuisUniversity-5053.image!


!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:04:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:04:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:04:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:04:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:04:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:04:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:04:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:04:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:04:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:04:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:04:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:04:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:04:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:04:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:04:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:04:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:04:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:04:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:04:48'!
PASSED!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:04:48'!
PASSED!
!Portfolio methodsFor: 'operations' stamp: 'af 5/22/2022 18:05:55' prior: 50475522!
add: anAsset
	assets add: (RoseTree with: anAsset).
	
! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:05:59'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:05:59'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:05:59'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:05:59'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:06:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:06:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:06:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:06:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:06:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:06:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:06:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:06:00'!
FAILURE!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:06:00'!
FAILURE!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:06:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:06:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:06:00'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:06:00'!
FAILURE!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:06:00'!
FAILURE!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:06:00'!
FAILURE!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:06:00'!
FAILURE!
!Portfolio methodsFor: 'operations' stamp: 'af 5/22/2022 18:06:15' prior: 50476272!
add: anAsset
	assets add: (RoseTree with: anAsset).
	anAsset addTo: self.
! !

!methodRemoval: Portfolio #addYourAccountsTo: stamp: 'af 5/22/2022 18:07:39'!
addYourAccountsTo: aListOfAccounts	
	assets do: [:anAsset | 
		(anAsset isKindOf: ReceptiveAccount) ifTrue: [aListOfAccounts add: anAsset]
			ifFalse: [anAsset addYourAccountsTo: aListOfAccounts]
		].
	^aListOfAccounts.!

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:07:43'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:07:43'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:07:43'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:07:43'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:07:43'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:07:43'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:07:43'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:07:43'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:07:43'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:07:43'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:07:43'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:07:43'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:07:43'!
PASSED!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:07:43'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:07:43'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:07:43'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:07:43'!
PASSED!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:07:43'!
PASSED!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:07:43'!
PASSED!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:07:43'!
PASSED!
!Portfolio methodsFor: 'operations' stamp: 'af 5/22/2022 18:08:50' prior: 50476360!
add: anAsset
	assets add: (RoseTree with: anAsset).
	"anAsset addTo: self."
! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:08:53'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:08:53'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:08:53'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:08:53'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:08:53'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:08:53'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:08:53'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:08:53'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:08:53'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:08:53'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:08:53'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:08:53'!
FAILURE!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:08:53'!
FAILURE!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:08:53'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:08:53'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:08:53'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:08:53'!
FAILURE!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:08:53'!
FAILURE!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:08:53'!
FAILURE!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:08:53'!
FAILURE!

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:09:17'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:09:17'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:09:17'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:09:17'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:09:17'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:09:17'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:09:17'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:09:17'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:09:17'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:09:17'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:09:17'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:09:17'!
FAILURE!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:09:17'!
FAILURE!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:09:17'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:09:17'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:09:17'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:09:17'!
FAILURE!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:09:17'!
FAILURE!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:09:17'!
FAILURE!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:09:17'!
FAILURE!

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:12:22'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:12:22'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:12:22'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:12:22'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:12:22'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:12:22'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:12:22'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:12:22'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:12:22'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:12:22'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:12:22'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:12:22'!
FAILURE!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:12:22'!
FAILURE!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:12:22'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:12:22'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:12:22'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:12:22'!
FAILURE!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:12:22'!
FAILURE!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:12:22'!
FAILURE!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:12:22'!
FAILURE!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:12:36'!
FAILURE!

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:14:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:14:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:14:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:14:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:14:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:14:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:14:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:14:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:14:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:14:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:14:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:14:28'!
FAILURE!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:14:28'!
FAILURE!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:14:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:14:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:14:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:14:28'!
FAILURE!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:14:28'!
FAILURE!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:14:28'!
FAILURE!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:14:28'!
FAILURE!
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'af 5/22/2022 18:14:47' prior: 50472394!
test12PortfolioCantAddAlreadyAddedAccount

	|portfolio account|
	
	portfolio _ Portfolio new.
	account _ ReceptiveAccount new.
	portfolio add: account.
	self 
		should: [ portfolio add: account ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error messageText equals: 'cycle generated'.
			].
! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:14:50'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:14:50'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:14:50'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:14:50'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:14:50'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:14:50'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:14:50'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:14:50'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:14:50'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:14:50'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:14:50'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:14:50'!
FAILURE!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:14:50'!
FAILURE!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:14:50'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:14:50'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:14:50'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:14:50'!
FAILURE!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:14:50'!
FAILURE!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:14:50'!
FAILURE!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:14:50'!
FAILURE!

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:16:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:16:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:16:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:16:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:16:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:16:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:16:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:16:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:16:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:16:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:16:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:16:16'!
FAILURE!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:16:16'!
FAILURE!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:16:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:16:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:16:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:16:16'!
FAILURE!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:16:16'!
FAILURE!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:16:16'!
FAILURE!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:16:16'!
FAILURE!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:16:18'!
FAILURE!

self messageText !

self!

 Error !
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'af 5/22/2022 18:19:27' prior: 50476799!
test12PortfolioCantAddAlreadyAddedAccount

	|portfolio account|
	
	portfolio _ Portfolio new.
	account _ ReceptiveAccount new.
	portfolio add: account.
	self 
		should: [ portfolio add: account ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error equals: (self error: 'cycle generated').
			].
! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:19:29'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:19:29'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:19:29'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:19:29'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:19:29'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:19:29'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:19:29'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:19:29'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:19:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:19:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:19:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:19:30'!
FAILURE!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:19:30'!
FAILURE!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:19:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:19:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:19:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:19:30'!
FAILURE!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:19:30'!
FAILURE!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:19:30'!
FAILURE!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:19:30'!
FAILURE!
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'LDM 5/18/2022 10:18:48' prior: 50476983!
test12PortfolioCantAddAlreadyAddedAccount

	|portfolio account|
	
	portfolio _ Portfolio new.
	account _ ReceptiveAccount new.
	portfolio add: account.
	self 
		should: [ portfolio add: account ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccount.
			].
! !
!RoseTree class methodsFor: 'as yet unclassified' stamp: 'af 5/22/2022 18:21:14'!
cycleGenerated
	^'cycle generated'.! !
!RoseTree methodsFor: 'operations' stamp: 'af 5/22/2022 18:21:55' prior: 50475392!
add: aRose
	(self assertChildrenContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	(self assertParentsContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	children add: aRose.
	aRose addAsParent: self.	! !
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'af 5/22/2022 18:22:10' prior: 50477079!
test12PortfolioCantAddAlreadyAddedAccount

	|portfolio account|
	
	portfolio _ Portfolio new.
	account _ ReceptiveAccount new.
	portfolio add: account.
	self 
		should: [ portfolio add: account ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error messageText equals: RoseTree cycleGenerated.
			].
! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:22:13'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:22:13'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:22:13'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:22:13'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:22:13'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:22:13'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:22:13'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:22:13'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:22:13'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:22:13'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:22:13'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:22:13'!
FAILURE!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:22:13'!
FAILURE!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:22:13'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:22:13'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:22:13'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:22:14'!
FAILURE!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:22:14'!
FAILURE!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:22:14'!
FAILURE!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:22:14'!
FAILURE!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:22:23'!
FAILURE!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:22:32'!
FAILURE!

portfolio _ Portfolio new.!

account _ ReceptiveAccount new.!

portfolio add: account.!

portfolio add: account !
!RoseTree methodsFor: 'operations' stamp: 'af 5/22/2022 18:24:10' prior: 50477097!
add: aRose
	(self assertChildrenContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	(self assertParentsContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	(children includes: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	children add: aRose.
	aRose addAsParent: self.	! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:24:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:24:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:24:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:24:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:24:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:24:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:24:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:24:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:24:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:24:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:24:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:24:16'!
FAILURE!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:24:16'!
FAILURE!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:24:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:24:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:24:16'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:24:16'!
FAILURE!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:24:16'!
FAILURE!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:24:16'!
FAILURE!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:24:16'!
FAILURE!

portfolio _ Portfolio new.!

account _ ReceptiveAccount new.!

portfolio add: account.!

portfolio add: account!

portfolio _ Portfolio new.!

account _ ReceptiveAccount new.!

portfolio add: account.!

 a Portfolio !

portfolio add: account.!

portfolio _ Portfolio new.!

account _ ReceptiveAccount new.!

portfolio add: account.!

portfolio!

assets children!

assets!
!Portfolio methodsFor: 'operations' stamp: 'af 5/22/2022 18:30:40' prior: 50476458!
add: anAsset
	assets add: anAsset.
	"anAsset addTo: self."
! !

a := RoseTree with: 'hola'!

b := RoseTree with: 'hola'!

col := OrderedCollection with: a!

col includes: b!

col includes: a!
!RoseTree methodsFor: 'operations' stamp: 'af 5/22/2022 18:33:05' prior: 50477215!
add: aRose
	(self assertChildrenContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	(self assertParentsContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	(children includes: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	children add: (RoseTree with: aRose).
	aRose addAsParent: self.	! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:33:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:33:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:33:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:33:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:33:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:33:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:33:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:33:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:33:09'!
ERROR!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:33:09'!
ERROR!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:33:09'!
ERROR!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:33:09'!
ERROR!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:33:09'!
ERROR!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:33:09'!
ERROR!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:33:09'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:33:09'!
ERROR!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:33:09'!
ERROR!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:33:09'!
ERROR!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:33:09'!
ERROR!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:33:09'!
ERROR!
!RoseTree methodsFor: 'operations' stamp: 'af 5/22/2022 18:35:40' prior: 50477331!
add: aRose
	(self assertChildrenContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	(self assertParentsContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	children add: (RoseTree with: aRose).
	aRose addAsParent: self.	! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:35:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:35:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:35:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:35:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:35:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:35:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:35:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:35:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:35:45'!
ERROR!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:35:45'!
ERROR!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:35:45'!
ERROR!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:35:45'!
ERROR!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:35:45'!
ERROR!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:35:45'!
ERROR!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:35:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:35:45'!
ERROR!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:35:45'!
ERROR!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:35:45'!
ERROR!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:35:45'!
ERROR!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:35:45'!
ERROR!
!RoseTree methodsFor: 'operations' stamp: 'af 5/22/2022 18:37:18' prior: 50477427!
add: aRose
	| newRoseTree |

	(self assertChildrenContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	(self assertParentsContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	newRoseTree := RoseTree with: aRose.
	children add: newRoseTree.
	newRoseTree addAsParent: self.	! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:37:23'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:37:23'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:37:23'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:37:23'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:37:23'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:37:24'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:37:24'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:37:24'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:37:24'!
ERROR!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:37:24'!
ERROR!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:37:24'!
ERROR!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:37:24'!
ERROR!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:37:24'!
ERROR!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:37:24'!
ERROR!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:37:24'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:37:24'!
ERROR!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:37:24'!
ERROR!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:37:24'!
ERROR!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:37:24'!
ERROR!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:37:24'!
ERROR!

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:38:58'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:38:58'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:38:58'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:38:58'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:38:58'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:38:58'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:38:58'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:38:58'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:38:58'!
ERROR!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:38:58'!
ERROR!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:38:58'!
ERROR!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:38:58'!
ERROR!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:38:58'!
ERROR!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:38:58'!
ERROR!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:38:58'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:38:58'!
ERROR!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:38:58'!
ERROR!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:38:58'!
ERROR!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:38:58'!
ERROR!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:38:58'!
ERROR!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:39:06'!
ERROR!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:39:13'!
ERROR!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:39:29'!
ERROR!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:40:07'!
ERROR!
!Portfolio methodsFor: 'operations' stamp: 'af 5/22/2022 18:41:15' prior: 50477322!
add: anAsset
	assets add: (RoseTree with: anAsset).
	"anAsset addTo: self."
! !
!RoseTree methodsFor: 'operations' stamp: 'af 5/22/2022 18:41:41' prior: 50477520!
add: aRose
	(self assertChildrenContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	(self assertParentsContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	children add: aRose.
	aRose addAsParent: self.	! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:41:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:41:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:41:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:41:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:41:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:41:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:41:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:41:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:41:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:41:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:41:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:41:45'!
FAILURE!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:41:45'!
FAILURE!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:41:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:41:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:41:45'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:41:45'!
FAILURE!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:41:45'!
FAILURE!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:41:45'!
FAILURE!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:41:45'!
FAILURE!

col includes: a!

col includes: b!
!RoseTree methodsFor: 'assertions' stamp: 'af 5/22/2022 18:43:11' prior: 50475454!
assertChildrenContainsRose: aRose
	^(children includes: aRose value) or: [ (children anySatisfy: [:aSubRoseTree | aSubRoseTree assertChildrenContainsRose: aRose]) or: [
				aRose assertParentsOfChildrenContainsRose: self.
			] ].! !
!RoseTree methodsFor: 'assertions' stamp: 'af 5/22/2022 18:43:18' prior: 50477815!
assertChildrenContainsRose: aRose
	^(children includes: (aRose value)) or: [ (children anySatisfy: [:aSubRoseTree | aSubRoseTree assertChildrenContainsRose: aRose]) or: [
				aRose assertParentsOfChildrenContainsRose: self.
			] ].! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:43:21'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:43:21'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:43:21'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:43:21'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:43:21'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:43:21'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:43:21'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:43:21'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:43:21'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:43:21'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:43:21'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:43:21'!
FAILURE!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:43:21'!
FAILURE!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:43:21'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:43:21'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:43:21'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:43:21'!
FAILURE!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:43:21'!
FAILURE!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:43:21'!
FAILURE!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:43:21'!
FAILURE!
!RoseTree methodsFor: 'assertions' stamp: 'af 5/22/2022 18:43:27' prior: 50477825!
assertChildrenContainsRose: aRose
	^(children includes: aRose) or: [ (children anySatisfy: [:aSubRoseTree | aSubRoseTree assertChildrenContainsRose: aRose]) or: [
				aRose assertParentsOfChildrenContainsRose: self.
			] ].! !
!RoseTree methodsFor: 'assertions' stamp: 'af 5/22/2022 18:46:12' prior: 50477918!
assertChildrenContainsRose: aRose
	^(self childrenAsCollection includes: (aRose value)) or: [ (children anySatisfy: [:aSubRoseTree | aSubRoseTree assertChildrenContainsRose: aRose]) or: [
				aRose assertParentsOfChildrenContainsRose: self.
			] ].! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:46:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:46:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:46:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:46:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:46:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:46:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:46:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:46:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:46:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:46:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:46:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:46:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:46:25'!
FAILURE!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:46:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:46:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:46:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:46:25'!
FAILURE!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:46:25'!
FAILURE!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:46:25'!
FAILURE!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:46:25'!
FAILURE!
!RoseTree methodsFor: 'operations' stamp: 'af 5/22/2022 18:47:04'!
parentsAsCollection
	| collection |
	collection _ OrderedCollection new.
	parents do: [:aParent | 
			collection add: (aParent value).
			collection _ collection , (aParent childrenAsCollection).
		].
	^collection.! !
!RoseTree methodsFor: 'assertions' stamp: 'af 5/22/2022 18:47:26' prior: 50475370!
assertParentsContainsRose: aRose
	|parentsIncludesARose childrenOfParentsIncludesARose parentsOfParentsIncludesARose | 
	parentsIncludesARose _ self parentsAsCollection includes: (aRose value).
	childrenOfParentsIncludesARose _ parents anySatisfy: [:aSubRoseTree | aSubRoseTree assertChildrenContainsRose: aRose].
	parentsOfParentsIncludesARose _ parents anySatisfy: [:aParent | aParent assertParentsContainsRose: aRose].
	^ parentsIncludesARose or: [childrenOfParentsIncludesARose or: [parentsOfParentsIncludesARose] ].! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:47:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:47:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:47:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:47:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:47:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:47:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:47:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:47:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:47:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:47:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:47:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:47:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:47:28'!
FAILURE!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:47:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:47:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:47:28'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:47:28'!
FAILURE!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:47:28'!
FAILURE!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:47:28'!
FAILURE!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:47:28'!
FAILURE!

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:48:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:48:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:48:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:48:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:48:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:48:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:48:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:48:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:48:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:48:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:48:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:48:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:48:44'!
FAILURE!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:48:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:48:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:48:44'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:48:44'!
FAILURE!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:48:44'!
FAILURE!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:48:44'!
FAILURE!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:48:44'!
FAILURE!
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'af 5/22/2022 18:49:27' prior: 50472407!
test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio

	|portfolio account extraPortfolio|
	
	portfolio _ Portfolio new.
	extraPortfolio _ Portfolio new.
	account _ ReceptiveAccount new.
	portfolio add: account.
	extraPortfolio add: account.
	self 
		should: [ portfolio add: extraPortfolio. ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error messageText equals: RoseTree cycleGenerated .
			].
! !

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:49:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:49:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:49:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:49:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:49:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:49:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:49:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:49:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:49:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:49:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:49:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:49:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:49:30'!
FAILURE!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:49:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:49:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:49:30'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:49:30'!
FAILURE!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:49:30'!
FAILURE!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:49:30'!
FAILURE!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:49:30'!
FAILURE!

!testRun: #ReceptiveAccountTest #test01ReceptiveAccountHaveZeroAsBalanceWhenCreated stamp: 'af 5/22/2022 18:50:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test02DepositIncreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:50:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test03WithdrawDecreasesBalanceOnTransactionValue stamp: 'af 5/22/2022 18:50:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test04WithdrawValueMustBePositive stamp: 'af 5/22/2022 18:50:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test05ReceptiveAccountKnowsRegisteredTransactions stamp: 'af 5/22/2022 18:50:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test06ReceptiveAccountDoNotKnowNotRegisteredTransactions stamp: 'af 5/22/2022 18:50:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test07AccountKnowsItsTransactions stamp: 'af 5/22/2022 18:50:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test08AnEmptyPortfolioHasZeroAsBalance stamp: 'af 5/22/2022 18:50:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test09AnEmptyPorfolioWithAnEmptyAccountHasZeroAsBalance stamp: 'af 5/22/2022 18:50:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test10PortfolioWithNonEmptyAccoutHasTheSameBalanceAsTheAccount stamp: 'af 5/22/2022 18:50:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test11PortfolioWithNonEmptyAccountAndNonEmptyPortfolioHasTheSameBalanceAsTheSumOfThem stamp: 'af 5/22/2022 18:50:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test12PortfolioCantAddAlreadyAddedAccount stamp: 'af 5/22/2022 18:50:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio stamp: 'af 5/22/2022 18:50:25'!
FAILURE!

!testRun: #ReceptiveAccountTest #test14PortfolioAnswersTrueToHasRegisteredWhenTransactionWasRegistered stamp: 'af 5/22/2022 18:50:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test15PortfolioAnswersFalseToHasRegisteredWhenTransactionWasNotRegistered stamp: 'af 5/22/2022 18:50:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test16PortfolioReturnAllOfItsTransactions stamp: 'af 5/22/2022 18:50:25'!
PASSED!

!testRun: #ReceptiveAccountTest #test17AddingAnAccountToAPortfolioThatExistsInAnotherPortfolioAndHaveThatAccountShouldFail stamp: 'af 5/22/2022 18:50:25'!
FAILURE!

!testRun: #ReceptiveAccountTest #test18AddingAccountIntoPortfolioInsideAnotherPortfolioWithThatAccountShouldFail stamp: 'af 5/22/2022 18:50:25'!
FAILURE!

!testRun: #ReceptiveAccountTest #test19AddingAPortfolioToInmediateParentPortfolioThrowsAnError stamp: 'af 5/22/2022 18:50:25'!
FAILURE!

!testRun: #ReceptiveAccountTest #test20AddingAPortfolioThatAlreadyExistsInPortfolioHirearchyThrowsError stamp: 'af 5/22/2022 18:50:25'!
FAILURE!

portfolio _ Portfolio new.!

extraPortfolio _ Portfolio new.!

account _ ReceptiveAccount new.!

portfolio add: account.!

extraPortfolio add: account.!

portfolio add: extraPortfolio.!

----STARTUP---- (15 June 2022 16:54:25) as C:\Users\andyf\Desktop\windows64\CuisUniversity-5053.image!


----End fileIn of C:\Users\andyf\Desktop\windows64\TusLibrosREST Ejercicio it4.st----!

----End fileIn of C:\Users\andyf\Desktop\windows64\TusLibros-Tests Ejercicio it4.st----!

----End fileIn of C:\Users\andyf\Desktop\windows64\Packages\System\Collections-CompactArrays.pck.st----!

----End fileIn of C:\Users\andyf\Desktop\windows64\Packages\Features\Compression.pck.st----!

----End fileIn of C:\Users\andyf\Desktop\windows64\Packages\Features\Sound.pck.st----!

----End fileIn of C:\Users\andyf\Desktop\windows64\Packages\Features\Cryptography-DigitalSignatures.pck.st----!

----End fileIn of C:\Users\andyf\Desktop\windows64\Packages\Features\Identities-UUID.pck.st----!

----End fileIn of C:\Users\andyf\Desktop\windows64\Packages\System\Network-Kernel.pck.st----!

----End fileIn of C:\Users\andyf\Desktop\windows64\WebClient.pck.st----!

----End fileIn of C:\Users\andyf\Desktop\windows64\TusLibros-Model Ejercicio it4.st----!

TusLibrosServerRestInterface installForDefaultSystem!

TusLibrosClientTestWindow open!

----STARTUP---- (15 June 2022 17:06:38) as C:\Users\andyf\Desktop\windows64\CuisUniversity-5053.image!

!Portfolio methodsFor: 'operations' stamp: 'af 5/22/2022 18:05:55' prior: 50475522!
add: anAsset
	assets add: (RoseTree with: anAsset).
	
! !
!Portfolio methodsFor: 'operations' stamp: 'af 5/22/2022 18:06:15' prior: 50517900!
add: anAsset
	assets add: (RoseTree with: anAsset).
	anAsset addTo: self.
! !

!methodRemoval: Portfolio #addYourAccountsTo: stamp: 'ldmaf 6/15/2022 17:07:39'!
addYourAccountsTo: aListOfAccounts	
	assets do: [:anAsset | 
		(anAsset isKindOf: ReceptiveAccount) ifTrue: [aListOfAccounts add: anAsset]
			ifFalse: [anAsset addYourAccountsTo: aListOfAccounts]
		].
	^aListOfAccounts.!
!Portfolio methodsFor: 'operations' stamp: 'af 5/22/2022 18:08:50' prior: 50517905!
add: anAsset
	assets add: (RoseTree with: anAsset).
	"anAsset addTo: self."
! !
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'af 5/22/2022 18:14:47' prior: 50472394!
test12PortfolioCantAddAlreadyAddedAccount

	|portfolio account|
	
	portfolio _ Portfolio new.
	account _ ReceptiveAccount new.
	portfolio add: account.
	self 
		should: [ portfolio add: account ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error messageText equals: 'cycle generated'.
			].
! !
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'af 5/22/2022 18:19:27' prior: 50517926!
test12PortfolioCantAddAlreadyAddedAccount

	|portfolio account|
	
	portfolio _ Portfolio new.
	account _ ReceptiveAccount new.
	portfolio add: account.
	self 
		should: [ portfolio add: account ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error equals: (self error: 'cycle generated').
			].
! !
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'LDM 5/18/2022 10:18:48' prior: 50517939!
test12PortfolioCantAddAlreadyAddedAccount

	|portfolio account|
	
	portfolio _ Portfolio new.
	account _ ReceptiveAccount new.
	portfolio add: account.
	self 
		should: [ portfolio add: account ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error messageText equals: Portfolio cannotAddAlreadyAddedAccount.
			].
! !
!RoseTree class methodsFor: 'as yet unclassified' stamp: 'af 5/22/2022 18:21:14'!
cycleGenerated
	^'cycle generated'.! !
!RoseTree methodsFor: 'operations' stamp: 'af 5/22/2022 18:21:55' prior: 50475392!
add: aRose
	(self assertChildrenContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	(self assertParentsContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	children add: aRose.
	aRose addAsParent: self.	! !
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'af 5/22/2022 18:22:10' prior: 50517952!
test12PortfolioCantAddAlreadyAddedAccount

	|portfolio account|
	
	portfolio _ Portfolio new.
	account _ ReceptiveAccount new.
	portfolio add: account.
	self 
		should: [ portfolio add: account ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error messageText equals: RoseTree cycleGenerated.
			].
! !
!RoseTree methodsFor: 'operations' stamp: 'af 5/22/2022 18:24:10' prior: 50517970!
add: aRose
	(self assertChildrenContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	(self assertParentsContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	(children includes: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	children add: aRose.
	aRose addAsParent: self.	! !
!Portfolio methodsFor: 'operations' stamp: 'af 5/22/2022 18:30:40' prior: 50517920!
add: anAsset
	assets add: anAsset.
	"anAsset addTo: self."
! !
!RoseTree methodsFor: 'operations' stamp: 'af 5/22/2022 18:33:05' prior: 50517994!
add: aRose
	(self assertChildrenContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	(self assertParentsContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	(children includes: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	children add: (RoseTree with: aRose).
	aRose addAsParent: self.	! !
!RoseTree methodsFor: 'operations' stamp: 'af 5/22/2022 18:35:40' prior: 50518012!
add: aRose
	(self assertChildrenContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	(self assertParentsContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	children add: (RoseTree with: aRose).
	aRose addAsParent: self.	! !
!RoseTree methodsFor: 'operations' stamp: 'af 5/22/2022 18:37:18' prior: 50518025!
add: aRose
	| newRoseTree |

	(self assertChildrenContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	(self assertParentsContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	newRoseTree := RoseTree with: aRose.
	children add: newRoseTree.
	newRoseTree addAsParent: self.	! !
!Portfolio methodsFor: 'operations' stamp: 'af 5/22/2022 18:41:15' prior: 50518007!
add: anAsset
	assets add: (RoseTree with: anAsset).
	"anAsset addTo: self."
! !
!RoseTree methodsFor: 'operations' stamp: 'af 5/22/2022 18:41:41' prior: 50518036!
add: aRose
	(self assertChildrenContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	(self assertParentsContainsRose: aRose) ifTrue: [self error: RoseTree cycleGenerated].
	children add: aRose.
	aRose addAsParent: self.	! !
!RoseTree methodsFor: 'assertions' stamp: 'af 5/22/2022 18:43:11' prior: 50475454!
assertChildrenContainsRose: aRose
	^(children includes: aRose value) or: [ (children anySatisfy: [:aSubRoseTree | aSubRoseTree assertChildrenContainsRose: aRose]) or: [
				aRose assertParentsOfChildrenContainsRose: self.
			] ].! !
!RoseTree methodsFor: 'assertions' stamp: 'af 5/22/2022 18:43:18' prior: 50518066!
assertChildrenContainsRose: aRose
	^(children includes: (aRose value)) or: [ (children anySatisfy: [:aSubRoseTree | aSubRoseTree assertChildrenContainsRose: aRose]) or: [
				aRose assertParentsOfChildrenContainsRose: self.
			] ].! !
!RoseTree methodsFor: 'assertions' stamp: 'af 5/22/2022 18:43:27' prior: 50518076!
assertChildrenContainsRose: aRose
	^(children includes: aRose) or: [ (children anySatisfy: [:aSubRoseTree | aSubRoseTree assertChildrenContainsRose: aRose]) or: [
				aRose assertParentsOfChildrenContainsRose: self.
			] ].! !
!RoseTree methodsFor: 'assertions' stamp: 'af 5/22/2022 18:46:12' prior: 50518086!
assertChildrenContainsRose: aRose
	^(self childrenAsCollection includes: (aRose value)) or: [ (children anySatisfy: [:aSubRoseTree | aSubRoseTree assertChildrenContainsRose: aRose]) or: [
				aRose assertParentsOfChildrenContainsRose: self.
			] ].! !
!RoseTree methodsFor: 'operations' stamp: 'af 5/22/2022 18:47:04'!
parentsAsCollection
	| collection |
	collection _ OrderedCollection new.
	parents do: [:aParent | 
			collection add: (aParent value).
			collection _ collection , (aParent childrenAsCollection).
		].
	^collection.! !
!RoseTree methodsFor: 'assertions' stamp: 'af 5/22/2022 18:47:26' prior: 50475370!
assertParentsContainsRose: aRose
	|parentsIncludesARose childrenOfParentsIncludesARose parentsOfParentsIncludesARose | 
	parentsIncludesARose _ self parentsAsCollection includes: (aRose value).
	childrenOfParentsIncludesARose _ parents anySatisfy: [:aSubRoseTree | aSubRoseTree assertChildrenContainsRose: aRose].
	parentsOfParentsIncludesARose _ parents anySatisfy: [:aParent | aParent assertParentsContainsRose: aRose].
	^ parentsIncludesARose or: [childrenOfParentsIncludesARose or: [parentsOfParentsIncludesARose] ].! !
!ReceptiveAccountTest methodsFor: 'tests' stamp: 'af 5/22/2022 18:49:27' prior: 50472407!
test13PortfolioCantAddPortfolioWithAccountAlreadyInCurrentPortfolio

	|portfolio account extraPortfolio|
	
	portfolio _ Portfolio new.
	extraPortfolio _ Portfolio new.
	account _ ReceptiveAccount new.
	portfolio add: account.
	extraPortfolio add: account.
	self 
		should: [ portfolio add: extraPortfolio. ] 
		raise: Error
		withExceptionDo: [ :error | 
				self assert: error messageText equals: RoseTree cycleGenerated .
			].
! !

!classDefinition: #TusLibrosClientTestWindow category: 'TusLibrosREST' stamp: 'ldmaf 6/15/2022 17:07:39'!
SystemWindow subclass: #TusLibrosClientTestWindow
	instanceVariableNames: 'cartIdsListMorph booksCatalogListMorph cartContentListMorph addToCartButtonMorph listCartButtonMorph selectedCartLabelMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibrosREST'!

!classDefinition: #TusLibrosClientTestWindow category: 'TusLibrosREST' stamp: 'ldmaf 6/15/2022 17:07:39'!
SystemWindow subclass: #TusLibrosClientTestWindow
	instanceVariableNames: 'cartIdsListMorph booksCatalogListMorph cartContentListMorph addToCartButtonMorph listCartButtonMorph selectedCartLabelMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibrosREST'!
!TusLibrosClientTestWindow methodsFor: 'events' stamp: 'NR 6/13/2022 07:06:24'!
informBook: bookIsbn addedToCart: cartId

	self inform: bookIsbn,' added to CartId: ', cartId asString
	
! !
!TusLibrosClientTestWindow methodsFor: 'events' stamp: 'NR 6/13/2022 07:06:29'!
refreshCartButtonsLabels: anIndex

	self refreshButton: listCartButtonMorph withLabel: 'List CartId: '  onIndex: anIndex.
	self refreshButton: addToCartButtonMorph withLabel: 'Add to CartId: '  onIndex: anIndex.
	
	
	! !
!TusLibrosClientTestWindow methodsFor: 'events' stamp: 'NR 6/13/2022 07:06:35'!
refreshCurrentSelectedCartContent: cartId

	cartContentListMorph updateList.
	selectedCartLabelMorph contents: 'Books in CartId: ', cartId
	
	
	! !
!TusLibrosClientTestWindow methodsFor: 'events' stamp: 'NR 6/13/2022 07:06:39'!
refreshListOfCartIds

	cartIdsListMorph updateList
	! !
!TusLibrosClientTestWindow methodsFor: 'private' stamp: 'NR 6/13/2022 07:06:48'!
refreshButton: aButton withLabel: aLabel onIndex: anIndex

	| newLabel |

	newLabel := aLabel.
	(anIndex ~= 0) ifTrue: [newLabel := newLabel,  (self model cartIds at: anIndex) asString].
	aButton label: newLabel.
	aButton morphHeight: self heightOfButtons.
	aButton redrawNeeded 
	
	! !
!TusLibrosClientTestWindow methodsFor: 'GUI building' stamp: 'NR 6/13/2022 07:05:51'!
build1stRow

	| createCartButtonMorph firstRowLayoutMorph |
	
	createCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #createCart label: 'Create Cart'.	
	addToCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #addToCart label: 'Add To Cart'.	
	
	firstRowLayoutMorph := LayoutMorph newRow.
	firstRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: createCartButtonMorph;
	addMorph: self build2ndColumn1stRow;
	addMorph: self build3rdColumn1stRow;
	addMorph:  addToCartButtonMorph.
	
	
	^firstRowLayoutMorph.! !
!TusLibrosClientTestWindow methodsFor: 'GUI building' stamp: 'NR 6/9/2022 08:11:48'!
build2ndColumn1stRow

	| secondColumnLayoutMorphOfFirstRow |
	
	cartIdsListMorph := PluggableListMorph model: self model listGetter: #cartIds indexGetter: #cartIdsIndex indexSetter: #cartIdsIndex:.
	cartIdsListMorph  borderColor: Color lightBlue; borderWidth: 1; morphWidth:300.
		
	secondColumnLayoutMorphOfFirstRow := LayoutMorph newColumn.
	secondColumnLayoutMorphOfFirstRow separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Carts Created');
	addMorph: cartIdsListMorph.
	
	secondColumnLayoutMorphOfFirstRow layoutSpec fixedWidth: 390.
	cartIdsListMorph layoutSpec proportionalWidth: 1.
	cartIdsListMorph layoutSpec proportionalHeight: 1.
		
	^secondColumnLayoutMorphOfFirstRow.! !
!TusLibrosClientTestWindow methodsFor: 'GUI building' stamp: 'NR 6/13/2022 07:05:59'!
build2ndColumn2ndRow

	| secondColumnLayoutMorphOfSecondRow |

	cartContentListMorph := PluggableListMorph model: self model listGetter: #cartContent indexGetter: nil indexSetter: nil.
	cartContentListMorph  borderColor: Color lightBlue; borderWidth: 1; morphWidth:300.
	
	selectedCartLabelMorph := LabelMorph contents:'Books in CartId: '.
		
	secondColumnLayoutMorphOfSecondRow := LayoutMorph newColumn.
	secondColumnLayoutMorphOfSecondRow separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: selectedCartLabelMorph;
	addMorph: cartContentListMorph.
	
	secondColumnLayoutMorphOfSecondRow layoutSpec fixedWidth: 390.
	cartContentListMorph layoutSpec proportionalWidth: 1.
	cartContentListMorph layoutSpec proportionalHeight: 1.
		
	^secondColumnLayoutMorphOfSecondRow.! !
!TusLibrosClientTestWindow methodsFor: 'GUI building' stamp: 'NR 6/13/2022 07:06:04'!
build2ndRow

	| secondRowLayoutMorph |

	listCartButtonMorph := PluggableButtonMorph model: self model stateGetter: nil  action: #listCart label: 'List CartId: '.	
	
	secondRowLayoutMorph := LayoutMorph newRow.
	secondRowLayoutMorph separation: 25;
	axisEdgeWeight: 0.5;
	addMorph: listCartButtonMorph;
	addMorph: self build2ndColumn2ndRow.
	
	^secondRowLayoutMorph

		! !
!TusLibrosClientTestWindow methodsFor: 'GUI building' stamp: 'NR 6/9/2022 08:12:04'!
build3rdColumn1stRow

	| thirdColumnLayoutMorphOfFirstRow |
	
	booksCatalogListMorph := PluggableListMorph model: self model listGetter: #booksCatalog indexGetter: #booksCatalogIndex indexSetter: #booksCatalogIndex:.
	booksCatalogListMorph borderColor: Color lightBlue; borderWidth: 1; morphWidth:300.
		
	thirdColumnLayoutMorphOfFirstRow  := LayoutMorph newColumn.
	thirdColumnLayoutMorphOfFirstRow  separation: 5; 
	axisEdgeWeight: 0.5;
	addMorph: (LabelMorph contents:'Book Catalog');
	addMorph: booksCatalogListMorph.
	
	thirdColumnLayoutMorphOfFirstRow layoutSpec fixedWidth: 390.
		
	^thirdColumnLayoutMorphOfFirstRow.! !
!TusLibrosClientTestWindow methodsFor: 'GUI building' stamp: 'NR 6/9/2022 08:12:08'!
buildMorphicWindow

	self layoutMorph beColumn;
	separation: 15;
	axisEdgeWeight: 0;
	addMorph: self build1stRow;
	addMorph: self build2ndRow.
	! !
!TusLibrosClientTestWindow methodsFor: 'GUI building' stamp: 'NR 6/9/2022 08:12:11'!
defaultExtent

	^ 1035@485
	! !
!TusLibrosClientTestWindow methodsFor: 'GUI building' stamp: 'NR 6/13/2022 07:06:16'!
heightOfButtons

	^ 66! !
!TusLibrosClientTestWindow methodsFor: 'initialization' stamp: 'NR 6/13/2022 07:07:04'!
initializeWith: aTitle

	self setLabel: aTitle.
	self model: (TusLibrosClientTestWindowModel new).
	self morphExtent: (self defaultExtent).
	self buildMorphicWindow.
	self openInWorld.
			
	self model when: #newCartIdArrived send: #refreshListOfCartIds to: self.		
	self model when: #selectedCartChanged send: #refreshCartButtonsLabels: to: self.	
	self model when: #bookAddedToCart send: #informBook:addedToCart: to: self.
	self model when: #newCurrentSelectedCartContentArrived send: #refreshCurrentSelectedCartContent: to: self! !

!classDefinition: 'TusLibrosClientTestWindow class' category: 'TusLibrosREST' stamp: 'ldmaf 6/15/2022 17:07:41'!
TusLibrosClientTestWindow class
	instanceVariableNames: ''!

!classDefinition: 'TusLibrosClientTestWindow class' category: 'TusLibrosREST' stamp: 'ldmaf 6/15/2022 17:07:41'!
TusLibrosClientTestWindow class
	instanceVariableNames: ''!
!TusLibrosClientTestWindow class methodsFor: 'instance creation' stamp: 'NR 6/9/2022 02:07:29'!
open
	
	^self new initializeWith: 'TusLibros Client Test Window'.! !

!classDefinition: #RealTimeClock category: 'TusLibrosREST' stamp: 'ldmaf 6/15/2022 17:07:41'!
ProtoObject subclass: #RealTimeClock
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibrosREST'!

!classDefinition: #RealTimeClock category: 'TusLibrosREST' stamp: 'ldmaf 6/15/2022 17:07:41'!
ProtoObject subclass: #RealTimeClock
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibrosREST'!
!RealTimeClock methodsFor: 'time' stamp: 'HAW 5/5/2020 17:07:39'!
now

	^DateAndTime now! !
!RealTimeClock methodsFor: 'time' stamp: 'HAW 5/5/2020 17:07:48'!
today

	^Date today! !

!classDefinition: #DefaultMerchantProcessor category: 'TusLibrosREST' stamp: 'ldmaf 6/15/2022 17:07:41'!
ProtoObject subclass: #DefaultMerchantProcessor
	instanceVariableNames: 'transactionId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibrosREST'!

!classDefinition: #DefaultMerchantProcessor category: 'TusLibrosREST' stamp: 'ldmaf 6/15/2022 17:07:41'!
ProtoObject subclass: #DefaultMerchantProcessor
	instanceVariableNames: 'transactionId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibrosREST'!
!DefaultMerchantProcessor methodsFor: 'debit' stamp: 'HAW 5/5/2020 17:13:16'!
debit: anAmount from: aCreditCard 

	transactionId := transactionId + 1.
	^transactionId! !
!DefaultMerchantProcessor methodsFor: 'initialization' stamp: 'HAW 5/5/2020 17:13:31' overrides: 16920235!
initialize

	super initialize.
	transactionId := 0! !

!classDefinition: #TusLibrosClientRestInterface category: 'TusLibrosREST' stamp: 'ldmaf 6/15/2022 17:07:41'!
Object subclass: #TusLibrosClientRestInterface
	instanceVariableNames: 'port'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibrosREST'!

!classDefinition: #TusLibrosClientRestInterface category: 'TusLibrosREST' stamp: 'ldmaf 6/15/2022 17:07:41'!
Object subclass: #TusLibrosClientRestInterface
	instanceVariableNames: 'port'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibrosREST'!
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'NR 6/13/2022 07:05:17'!
add: quantity of: bookIsbn toCartIdentifiedAs: cartId

	| fieldDict resp |

	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. 'bookIsbn'. bookIsbn. 'bookQuantity'. quantity}.		
		
	resp := WebClient htmlSubmit: (self url,'/addToCart') fields: fieldDict.
		
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream))]
		ifFalse:[^self error: resp content]! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'NR 6/9/2022 08:11:20'!
createCartFor: aUser password: aPassword

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'clientId'. aUser. 'password'. aPassword}.		
	
	resp := WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
		
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream))] 
		ifFalse:[^self error: resp content]! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'NR 6/9/2022 08:11:24'!
listCart: cartId

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. }.		
	
	resp := WebClient htmlSubmit: (self url,'/listCart') fields: fieldDict.
		
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection] 
		ifFalse:[^self error: resp content]! !
!TusLibrosClientRestInterface methodsFor: 'initialization' stamp: 'NR 6/9/2022 08:11:33'!
port

	^port ifNil: [port:=9999].! !
!TusLibrosClientRestInterface methodsFor: 'initialization' stamp: 'NR 6/9/2022 08:11:37'!
url

	^'http://localhost:', self port asString! !

!classDefinition: #TusLibrosClientTestWindowModel category: 'TusLibrosREST' stamp: 'ldmaf 6/15/2022 17:07:41'!
Object subclass: #TusLibrosClientTestWindowModel
	instanceVariableNames: 'cartIds selectedCartIdsIndex selectedBookCatalogIndex currentSelectedCartContent restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibrosREST'!

!classDefinition: #TusLibrosClientTestWindowModel category: 'TusLibrosREST' stamp: 'ldmaf 6/15/2022 17:07:41'!
Object subclass: #TusLibrosClientTestWindowModel
	instanceVariableNames: 'cartIds selectedCartIdsIndex selectedBookCatalogIndex currentSelectedCartContent restInterface'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibrosREST'!
!TusLibrosClientTestWindowModel methodsFor: 'accessing' stamp: 'NR 6/13/2022 07:09:38'!
selectedBook

	^self booksCatalog at: selectedBookCatalogIndex! !
!TusLibrosClientTestWindowModel methodsFor: 'accessing' stamp: 'NR 6/13/2022 07:09:42'!
selectedCartId

	^self cartIds at: selectedCartIdsIndex! !
!TusLibrosClientTestWindowModel methodsFor: 'testing' stamp: 'NR 6/13/2022 07:09:49'!
areCartIdAndBookSelected

	^selectedCartIdsIndex  ~= 0 and: [selectedBookCatalogIndex  ~= 0]! !
!TusLibrosClientTestWindowModel methodsFor: 'testing' stamp: 'NR 6/13/2022 07:09:52'!
isCartIdSelected

	^selectedCartIdsIndex ~= 0! !
!TusLibrosClientTestWindowModel methodsFor: 'listSelectors' stamp: 'NR 6/13/2022 07:10:01'!
booksCatalog

	^self defaultCatalog keys! !
!TusLibrosClientTestWindowModel methodsFor: 'listSelectors' stamp: 'NR 6/9/2022 08:12:38'!
booksCatalogIndex

	^selectedBookCatalogIndex! !
!TusLibrosClientTestWindowModel methodsFor: 'listSelectors' stamp: 'NR 6/9/2022 08:12:41'!
booksCatalogIndex: anIndex

	selectedBookCatalogIndex  := anIndex! !
!TusLibrosClientTestWindowModel methodsFor: 'listSelectors' stamp: 'NR 6/9/2022 08:12:45'!
cartContent

	^currentSelectedCartContent! !
!TusLibrosClientTestWindowModel methodsFor: 'listSelectors' stamp: 'NR 6/9/2022 08:12:57'!
cartIds

	^cartIds! !
!TusLibrosClientTestWindowModel methodsFor: 'listSelectors' stamp: 'NR 6/13/2022 07:10:15'!
cartIdsIndex

	^selectedCartIdsIndex! !
!TusLibrosClientTestWindowModel methodsFor: 'listSelectors' stamp: 'NR 6/13/2022 07:10:19'!
cartIdsIndex: anIndex

	selectedCartIdsIndex  := anIndex. 
		
	self triggerEvent: #selectedCartChanged with: selectedCartIdsIndex
	! !
!TusLibrosClientTestWindowModel methodsFor: 'buttonSelectors' stamp: 'NR 6/13/2022 07:07:36'!
addToCart

	| cartId bookIsbn |

	(self areCartIdAndBookSelected) ifTrue:[
		cartId := self selectedCartId.
		bookIsbn := self selectedBook.
		restInterface add: 1 of: bookIsbn toCartIdentifiedAs: cartId.
		self triggerEvent: #bookAddedToCart withArguments: (Array with: bookIsbn with: cartId)]! !
!TusLibrosClientTestWindowModel methodsFor: 'buttonSelectors' stamp: 'NR 6/9/2022 08:13:07'!
createCart

	| newCartId |
	
	newCartId := restInterface createCartFor: 'hernan' password: 'smalltalk'.
	cartIds add: newCartId.
	self triggerEvent: #newCartIdArrived! !
!TusLibrosClientTestWindowModel methodsFor: 'buttonSelectors' stamp: 'NR 6/13/2022 07:08:06'!
listCart

	| cartId |
	
	(self isCartIdSelected) ifTrue:[
		cartId := self selectedCartId.
		currentSelectedCartContent := restInterface listCart: cartId.
		self triggerEvent: #newCurrentSelectedCartContentArrived with: cartId ].! !
!TusLibrosClientTestWindowModel methodsFor: 'initialization' stamp: 'NR 6/9/2022 08:13:11'!
defaultCatalog 

	^Dictionary new
		at: 'GreenBook' put: 10*dollar;
		at: 'BlueBook' put: 15*dollar;
		at: 'MartinFierro' put: 350*peso;
		yourself! !
!TusLibrosClientTestWindowModel methodsFor: 'initialization' stamp: 'NR 6/9/2022 08:13:15' overrides: 16920235!
initialize

	cartIds := OrderedCollection new.
	currentSelectedCartContent := OrderedCollection new.
	selectedCartIdsIndex := 0.
	selectedBookCatalogIndex := 0.
	restInterface := TusLibrosClientRestInterface new.! !

!classDefinition: #TusLibrosServerRestInterface category: 'TusLibrosREST' stamp: 'ldmaf 6/15/2022 17:07:43'!
Object subclass: #TusLibrosServerRestInterface
	instanceVariableNames: 'systemFacade'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibrosREST'!

!classDefinition: #TusLibrosServerRestInterface category: 'TusLibrosREST' stamp: 'ldmaf 6/15/2022 17:07:43'!
Object subclass: #TusLibrosServerRestInterface
	instanceVariableNames: 'systemFacade'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibrosREST'!
!TusLibrosServerRestInterface methodsFor: 'initialization' stamp: 'HAW 5/5/2020 17:18:31'!
initializeOn: aTusLibrosSystemFacade 
	
	systemFacade := aTusLibrosSystemFacade.! !
!TusLibrosServerRestInterface methodsFor: 'request' stamp: 'NR 6/9/2022 08:15:16'!
answer: aBlock to: aRequest 

	| response |
	
	[ response := aBlock value.
	aRequest send200Response: (WebUtils jsonEncode: (response))]
		on: Error
		do: [ :anError | aRequest send400Response: anError messageText ]! !
!TusLibrosServerRestInterface methodsFor: 'request' stamp: 'HAW 7/23/2020 16:18:57'!
cartIdFrom: requestFields

	^ (requestFields at: 'cartId') asNumber! !
!TusLibrosServerRestInterface methodsFor: 'request' stamp: 'HAW 7/23/2020 16:20:08'!
clientIdFrom: requestFields

	^ requestFields at: 'clientId'! !
!TusLibrosServerRestInterface methodsFor: 'request' stamp: 'HAW 7/23/2020 16:20:19'!
passwordFrom: requestFields

	^ requestFields at: 'password'! !
!TusLibrosServerRestInterface methodsFor: 'request' stamp: 'HAW 5/5/2020 18:26:47'!
withFieldsOf: aRequest do: aBlock

	[ aBlock value: aRequest fields ]
		on: Error
		do: [ :anError | aRequest 
			sendResponseCode: 400 
			content: ('Invalid request: ', anError messageText) asUtf8
			type: 'text/plain; charset=utf-8'
			close: true ]! !
!TusLibrosServerRestInterface methodsFor: 'rest interface' stamp: 'NR 6/13/2022 07:11:45'!
addToCart: aRequest

	| bookIsbn cartId quantity |

	(Delay forSeconds: 3) wait.
	
	self withFieldsOf: aRequest do: [ :requestFields |
		cartId := self cartIdFrom: requestFields.
		bookIsbn := requestFields at: 'bookIsbn'.
		quantity := (requestFields at: 'bookQuantity') asNumber ].
		
	self 
		answer: [
			systemFacade add: quantity of: bookIsbn toCartIdentifiedAs: cartId.
			'OK' ]
		to: aRequest 
	! !
!TusLibrosServerRestInterface methodsFor: 'rest interface' stamp: 'HAW 7/23/2020 16:19:16'!
checkOutCart: aRequest

	| cartId creditCardNumber creditCardOwner creditCartExpirationDate creditCartExpirationDateString transactionId |
	
	self withFieldsOf: aRequest do: [ :requestFields |
		cartId := self cartIdFrom: requestFields.
		creditCardNumber := requestFields at: 'ccn'.
		creditCartExpirationDateString := requestFields at: 'cced'.
		creditCartExpirationDate := Month 
			month: (creditCartExpirationDateString first: 2) asNumber 
			year: (creditCartExpirationDateString last: 4) asNumber.
		creditCardOwner := requestFields at: 'cco' ].
	
	self 
		answer: [
			transactionId := systemFacade 
					checkOutCartIdentifiedAs: cartId 
					withCreditCardNumbered: creditCardNumber 
					ownedBy: creditCardOwner 
					expiringOn: creditCartExpirationDate. 
			transactionId printString ]
		to: aRequest ! !
!TusLibrosServerRestInterface methodsFor: 'rest interface' stamp: 'NR 6/13/2022 07:11:38'!
createCart: aRequest

	| clientId password |

	(Delay forSeconds: 1) wait.
	
	self withFieldsOf: aRequest do: [ :requestFields |
		clientId := self clientIdFrom: requestFields.
		password := self passwordFrom: requestFields ].
	
	self 
		answer: [ | cartId | 
			cartId := systemFacade createCartFor: clientId authenticatedWith: password.
			cartId printString ]
		to: aRequest ! !
!TusLibrosServerRestInterface methodsFor: 'rest interface' stamp: 'NR 6/13/2022 07:11:31'!
listCart: aRequest

	| cartId |

	(Delay forSeconds: 10) wait.
	
	self withFieldsOf: aRequest do: [ :requestFields |
		cartId := self cartIdFrom: requestFields ].
	
	self 
		answer: [(systemFacade listCartIdentifiedAs: cartId) asArray]
		to: aRequest 
! !
!TusLibrosServerRestInterface methodsFor: 'rest interface' stamp: 'HAW 7/23/2020 16:20:19'!
listPurchases: aRequest

	| clientId password purchases response |
	
	self withFieldsOf: aRequest do: [ :requestFields |
		clientId := self clientIdFrom: requestFields.
		password := self passwordFrom: requestFields ].
	
	self 
		answer: [ | soldItems total |
			purchases := systemFacade listPurchasesOf: clientId authenticatingWith: password.
			soldItems := purchases first.
			total := purchases second.
			response := String streamContents: [:stream | 
				soldItems keysAndValuesDo: [ :isbn :amount |
					stream nextPutAll: isbn; nextPut: $|; print: amount; nextPut: $| ].
				stream print: total ].
			response ]
		to: aRequest ! !

!classDefinition: 'TusLibrosServerRestInterface class' category: 'TusLibrosREST' stamp: 'ldmaf 6/15/2022 17:07:43'!
TusLibrosServerRestInterface class
	instanceVariableNames: ''!

!classDefinition: 'TusLibrosServerRestInterface class' category: 'TusLibrosREST' stamp: 'ldmaf 6/15/2022 17:07:43'!
TusLibrosServerRestInterface class
	instanceVariableNames: ''!
!TusLibrosServerRestInterface class methodsFor: 'default objects' stamp: 'HAW 5/5/2020 17:11:42'!
createSalesBook
	
	^OrderedCollection new! !
!TusLibrosServerRestInterface class methodsFor: 'default objects' stamp: 'HAW 5/5/2020 17:47:11'!
defaultCatalog 
	
	^Dictionary new
		at: 'GreenBook' put: 10*dollar;
		at: 'BlueBook' put: 15*dollar;
		at: 'MartinFierro' put: 350*peso;
		yourself! !
!TusLibrosServerRestInterface class methodsFor: 'default objects' stamp: 'HAW 5/5/2020 17:13:55'!
defaultMerchantProcessor 
	
	^DefaultMerchantProcessor new! !
!TusLibrosServerRestInterface class methodsFor: 'default objects' stamp: 'HAW 5/5/2020 17:13:46'!
defaultSystem

	| clock systemFacade |
	
	clock := RealTimeClock new.
	systemFacade := TusLibrosSystemFacade 
		authenticatingWith: self validUsersAndPasswords 
		acceptingItemsOf: self defaultCatalog 
		registeringOn: self createSalesBook
		debitingThrought: self defaultMerchantProcessor 
		measuringTimeWith: clock.

	^systemFacade ! !
!TusLibrosServerRestInterface class methodsFor: 'default objects' stamp: 'HAW 5/5/2020 17:10:11'!
validUsersAndPasswords 
	
	^Dictionary new
		at: 'hernan' put: 'smalltalk';
		at: 'maximo' put: 'ruby';
		yourself! !
!TusLibrosServerRestInterface class methodsFor: 'instance creation' stamp: 'HAW 5/5/2020 17:18:06'!
on: aTusLibrosSystemFacade 

	^self new initializeOn: aTusLibrosSystemFacade ! !
!TusLibrosServerRestInterface class methodsFor: 'installation' stamp: 'HAW 7/24/2020 11:07:02'!
installForDefaultSystem

	"self installForDefaultSystem"
	
	| server port interface |
	
	interface := self on: self defaultSystem.
	
	"Esto es para poder acceder a la interface de manera global - Hernan"
	Smalltalk at: #CurrentTusLibrosRestInterface put: interface.
	
	port := 9999.
	server := WebServer reset default.
	server listenOn: port.
	server 
		addService: '/createCart' 
		action: [:request | interface createCart: request ].
	server 
		addService: '/addToCart' 
		action: [:request | interface addToCart: request ].
	server
		addService: '/listCart' 
		action: [:request | interface listCart: request ].
	server
		addService: '/checkOutCart' 
		action: [:request | interface checkOutCart: request ].
	server
		addService: '/listPurchases' 
		action: [:request | interface listPurchases: request ].
	server useDebugErrorHandler ! !

!classDefinition: #CartTest category: 'TusLibros-Tests' stamp: 'ldmaf 6/15/2022 17:07:44'!
TestCase subclass: #CartTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

!classDefinition: #CartTest category: 'TusLibros-Tests' stamp: 'ldmaf 6/15/2022 17:07:44'!
TestCase subclass: #CartTest
	instanceVariableNames: 'testObjectsFactory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!
!CartTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/17/2013 18:10'!
test01NewCartsAreCreatedEmpty

	self assert: testObjectsFactory createCart isEmpty! !
!CartTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/17/2013 18:10'!
test02CanNotAddItemsThatDoNotBelongToStore

	| cart |
	
	cart := testObjectsFactory createCart.
	
	self 
		should: [ cart add: testObjectsFactory itemNotSellByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/17/2013 18:10'!
test03AfterAddingAnItemTheCartIsNotEmptyAnymore

	| cart |
	
	cart := testObjectsFactory createCart.
	
	cart add: testObjectsFactory itemSellByTheStore.
	self deny: cart isEmpty ! !
!CartTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/17/2013 18:10'!
test04CanNotAddNonPositiveNumberOfItems

	| cart |
	
	cart := testObjectsFactory createCart.
	
	self 
		should: [cart add: 0 of: testObjectsFactory itemSellByTheStore ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidQuantityErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/17/2013 18:10'!
test05CanNotAddMoreThanOneItemNotSellByTheStore

	| cart |
	
	cart := testObjectsFactory createCart.
	
	self 
		should: [cart add: 2 of: testObjectsFactory itemNotSellByTheStore  ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = cart invalidItemErrorMessage.
			self assert: cart isEmpty ]! !
!CartTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/17/2013 18:11'!
test06CartRemembersAddedItems

	| cart |
	
	cart := testObjectsFactory createCart.
	
	cart add: testObjectsFactory itemSellByTheStore.
	self assert: (cart includes: testObjectsFactory itemSellByTheStore)! !
!CartTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/17/2013 18:11'!
test07CartDoesNotHoldNotAddedItems

	| cart |
	
	cart := testObjectsFactory createCart.
	
	self deny: (cart includes: testObjectsFactory itemSellByTheStore)! !
!CartTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/17/2013 18:11'!
test08CartRemembersTheNumberOfAddedItems

	| cart |
	
	cart := testObjectsFactory createCart.
	
	cart add: 2 of: testObjectsFactory itemSellByTheStore.
	self assert: (cart occurrencesOf: testObjectsFactory itemSellByTheStore) = 2! !
!CartTest methodsFor: 'setup' stamp: 'HernanWilkinson 6/17/2013 18:09' overrides: 16961394!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.! !

!classDefinition: #CashierTest category: 'TusLibros-Tests' stamp: 'ldmaf 6/15/2022 17:07:45'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'testObjectsFactory debitBehavior'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

!classDefinition: #CashierTest category: 'TusLibros-Tests' stamp: 'ldmaf 6/15/2022 17:07:45'!
TestCase subclass: #CashierTest
	instanceVariableNames: 'testObjectsFactory debitBehavior'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!
!CashierTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/22/2013 12:00'!
test01CanNotCheckoutAnEmptyCart

	| salesBook |
	
	salesBook := OrderedCollection new.
	self 
		should: [ Cashier 
			toCheckout: testObjectsFactory createCart 
			ownedBy: testObjectsFactory customer
			charging: testObjectsFactory notExpiredCreditCard 
			throught: self
			on: testObjectsFactory today
			registeringOn:  salesBook ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier cartCanNotBeEmptyErrorMessage.
			self assert: salesBook isEmpty ]! !
!CashierTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/22/2013 12:22'!
test02CalculatedTotalIsCorrect

	| cart cashier |
	
	cart := testObjectsFactory createCart.
	cart add: 2 of: testObjectsFactory itemSellByTheStore.
	
	cashier :=  Cashier
		toCheckout: cart 
		ownedBy: testObjectsFactory customer
		charging: testObjectsFactory notExpiredCreditCard 
		throught: self
		on: testObjectsFactory today 
		registeringOn: OrderedCollection new.
		
	self assert: cashier checkOut total = (testObjectsFactory itemSellByTheStorePrice * 2)! !
!CashierTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/22/2013 12:01'!
test03CanNotCheckoutWithAnExpiredCreditCart

	| cart salesBook |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	salesBook := OrderedCollection new.
	
	self
		should: [ Cashier 
				toCheckout: cart 
				ownedBy: testObjectsFactory customer 
				charging: testObjectsFactory expiredCreditCard 
				throught: self
				on: testObjectsFactory today
				registeringOn: salesBook ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError | 
			self assert: anError messageText = Cashier canNotChargeAnExpiredCreditCardErrorMessage.
			self assert: salesBook isEmpty ]! !
!CashierTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/22/2013 12:23'!
test04CheckoutRegistersASale

	| cart cashier salesBook total |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	salesBook := OrderedCollection new.
 
	cashier:= Cashier 
		toCheckout: cart 
		ownedBy: testObjectsFactory customer 
		charging: testObjectsFactory notExpiredCreditCard
		throught: self
		on: testObjectsFactory today
		registeringOn: salesBook.
		
	total := cashier checkOut total.
					
	self assert: salesBook size = 1.
	self assert: salesBook first total = total.! !
!CashierTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/22/2013 12:22'!
test05CashierChargesCreditCardUsingMerchantProcessor

	| cart cashier salesBook total creditCard debitedAmout debitedCreditCard  |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	creditCard := testObjectsFactory notExpiredCreditCard.
	salesBook := OrderedCollection new.
 
	cashier:= Cashier 
		toCheckout: cart
		ownedBy: testObjectsFactory customer 
		charging: creditCard
		throught: self
		on: testObjectsFactory today
		registeringOn: salesBook.
		
	debitBehavior := [ :anAmount :aCreditCard | 
		debitedAmout := anAmount.
		debitedCreditCard := aCreditCard ].
	total := cashier checkOut total.
					
	self assert: debitedCreditCard = creditCard.
	self assert: debitedAmout = total.! !
!CashierTest methodsFor: 'tests' stamp: 'HernanWilkinson 6/22/2013 12:02'!
test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit

	| cart cashier salesBook creditCard |

	cart := testObjectsFactory createCart.
	cart add: testObjectsFactory itemSellByTheStore.
	creditCard := testObjectsFactory notExpiredCreditCard.
	salesBook := OrderedCollection new.
 	debitBehavior := [ :anAmount :aCreditCard | self error: Cashier creditCardHasNoCreditErrorMessage].
	
	cashier:= Cashier 
		toCheckout: cart 
		ownedBy: testObjectsFactory customer
		charging: creditCard
		throught: self
		on: testObjectsFactory today
		registeringOn: salesBook.
		
	self 
		should: [cashier checkOut ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assert: anError messageText = Cashier creditCardHasNoCreditErrorMessage.
			self assert: salesBook isEmpty ]! !
!CashierTest methodsFor: 'setup' stamp: 'HernanWilkinson 6/17/2013 19:03' overrides: 16961394!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	debitBehavior := [ :anAmount :aCreditCard | ]! !
!CashierTest methodsFor: 'merchant processor protocol' stamp: 'HernanWilkinson 6/17/2013 19:02'!
debit: anAmount from: aCreditCard 

	^debitBehavior value: anAmount value: aCreditCard ! !

!classDefinition: #CreditCardTest category: 'TusLibros-Tests' stamp: 'ldmaf 6/15/2022 17:07:46'!
TestCase subclass: #CreditCardTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

!classDefinition: #CreditCardTest category: 'TusLibros-Tests' stamp: 'ldmaf 6/15/2022 17:07:46'!
TestCase subclass: #CreditCardTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!
!CreditCardTest methodsFor: 'tests' stamp: 'HAW 7/22/2020 14:26:34'!
test01CreditCardNumberWithLessThan16DigitsIsNotValid

	self 
		should: [ CreditCard numbered: '123456789012345' ownedBy: self validOwnerName expiringOn: Month current ]
		raise: Error - MessageNotUnderstood 
		withMessageText: CreditCard invalidNumberErrorDescription! !
!CreditCardTest methodsFor: 'tests' stamp: 'HAW 7/22/2020 14:26:33'!
test02CreditCardNumberWithMoreThan16DigitsIsNotValid

	self 
		should: [ CreditCard numbered: '12345678901234567' ownedBy: self validOwnerName expiringOn: Month current ]
		raise: Error - MessageNotUnderstood 
		withMessageText: CreditCard invalidNumberErrorDescription! !
!CreditCardTest methodsFor: 'tests' stamp: 'HAW 7/22/2020 14:26:33'!
test03CreditCardNumberShouldBeDigitsOnly

	self 
		should: [ CreditCard numbered: 'a234567890123456' ownedBy: self validOwnerName expiringOn: Month current ]
		raise: Error - MessageNotUnderstood 
		withMessageText: CreditCard invalidNumberErrorDescription! !
!CreditCardTest methodsFor: 'tests' stamp: 'HAW 7/22/2020 14:27:23'!
test04NameCanNotBeEmpty

	self 
		should: [ CreditCard numbered: '1234567890123456' ownedBy: '' expiringOn: Month current ]
		raise: Error - MessageNotUnderstood 
		withMessageText: CreditCard invalidOwnerNameErrorDescription! !
!CreditCardTest methodsFor: 'tests' stamp: 'HAW 7/22/2020 14:32:08'!
test05IsExpiredOnNextExpirationMonth

	| expirationMonth expiredMonth creditCard |
	
	expirationMonth := Month month: #January year: 2020. 
	expiredMonth := expirationMonth next.
	creditCard := CreditCard 
		numbered: '1234567890123456' 
		ownedBy: self validOwnerName 
		expiringOn: expirationMonth.
		
	self assert: (creditCard isExpiredOn: expiredMonth)! !
!CreditCardTest methodsFor: 'tests' stamp: 'HAW 7/22/2020 14:32:30'!
test06IsNotExpiredOnExpirationMonth

	| expirationMonth creditCard |
	
	expirationMonth := Month month: #January year: 2020. 
	creditCard := CreditCard 
		numbered: '1234567890123456' 
		ownedBy: self validOwnerName 
		expiringOn: expirationMonth.
		
	self deny: (creditCard isExpiredOn: expirationMonth)! !
!CreditCardTest methodsFor: 'tests' stamp: 'HAW 7/22/2020 14:39:10'!
test07CanGetCreditCardInfoFromIt

	| expirationMonth creditCard creditCardNumber creditCardOwner |
	
	expirationMonth := Month month: #January year: 2020. 
	creditCardNumber := self validCreditCardNumber.
	creditCardOwner := self validOwnerName.
	
	creditCard := CreditCard 
		numbered: creditCardNumber 
		ownedBy: creditCardOwner 
		expiringOn: expirationMonth.
		
	self assert: creditCardNumber equals: creditCard number.
	self assert: creditCardOwner equals: creditCard ownerName.
	self assert: expirationMonth equals: creditCard expiration! !
!CreditCardTest methodsFor: 'tests' stamp: 'HAW 7/22/2020 14:33:46'!
validCreditCardNumber

	^ '1234567890123456'! !
!CreditCardTest methodsFor: 'tests' stamp: 'HAW 7/22/2020 14:28:21'!
validOwnerName
	
	^'Pepe Sanchez'! !

!classDefinition: #TusLibrosSystemFacadeTest category: 'TusLibros-Tests' stamp: 'ldmaf 6/15/2022 17:07:46'!
TestCase subclass: #TusLibrosSystemFacadeTest
	instanceVariableNames: 'testObjectsFactory clock systemFacade merchantProcessorTransactionId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

!classDefinition: #TusLibrosSystemFacadeTest category: 'TusLibros-Tests' stamp: 'ldmaf 6/15/2022 17:07:46'!
TestCase subclass: #TusLibrosSystemFacadeTest
	instanceVariableNames: 'testObjectsFactory clock systemFacade merchantProcessorTransactionId'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!
!TusLibrosSystemFacadeTest methodsFor: 'tests - add to cart' stamp: 'HAW 7/23/2020 15:59:09'!
test04CanAddItemsToACreatedCart

	| cartId cartContent |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 1 of: self validBook toCartIdentifiedAs: cartId.
	
	cartContent := systemFacade listCartIdentifiedAs: cartId.
	
	self assert: 1 equals: (cartContent occurrencesOf: self validBook).
	self assert: 1 equals: cartContent size! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - add to cart' stamp: 'HAW 7/23/2020 15:55:18'!
test05CanNotAddItemToNotCreatedCart

	self
		should: [systemFacade add: 1 of: self validBook toCartIdentifiedAs: self invalidCartId]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError | 
			self assertMessageTextOf: anError is: systemFacade invalidCartIdErrorDescription ]
		! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - add to cart' stamp: 'HAW 7/23/2020 15:56:49'!
test06CanNotAddItemNotSellByTheStore

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	self
		should: [systemFacade add: 1 of: self invalidBook toCartIdentifiedAs: cartId ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError | 
			self assertMessageTextOf: anError is: systemFacade invalidItemErrorMessage.
			self assertIsEmptyCartIdentifiedAs: cartId]
		! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - add to cart' stamp: 'HAW 7/23/2020 15:57:13'!
test17CanNotAddToCartWhenSessionIsExpired

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	self advanceTime: (systemFacade sessionDuration + 1 minutes) . 
	self 
		should: [systemFacade add: 2 of: self validBook toCartIdentifiedAs: cartId]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assertMessageTextOf: anError is: systemFacade sessionHasExpiredErrorDescription.
			self revertTime: systemFacade sessionDuration.
			self assertIsEmptyCartIdentifiedAs: cartId ]
! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - performance' stamp: 'NR 6/9/2022 20:51:15'!
should: aBlock notTakeMoreThanMilliseconds: aTimeInMillis

	self assert: aBlock timeToRun <= aTimeInMillis! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - performance' stamp: 'NR 6/13/2022 09:05:18'!
test20BookPerformanceShouldNotTakeTooLong

	| cartId bookPerformance quantity total |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 2 of: self validBook toCartIdentifiedAs: cartId.
	systemFacade 
		checkOutCartIdentifiedAs: cartId 
		withCreditCardNumbered: testObjectsFactory validCreditCardNumber 
		ownedBy: testObjectsFactory validOwnerName 
		expiringOn: testObjectsFactory notExpiredMonthOfYear.
		
	cartId := systemFacade createCartFor: self anotherValidUser authenticatedWith: self anotherValidUserPassword.
	systemFacade add: 5 of: self validBook toCartIdentifiedAs: cartId.
	systemFacade 
		checkOutCartIdentifiedAs: cartId 
		withCreditCardNumbered: testObjectsFactory validCreditCardNumber 
		ownedBy: testObjectsFactory validOwnerName 
		expiringOn: testObjectsFactory notExpiredMonthOfYear.
		
	self should: [bookPerformance := systemFacade bookPerformance: self validBook ] 
		notTakeMoreThanMilliseconds: 1100.	

	quantity := bookPerformance at: 'quantity'.
	total := bookPerformance at: 'total'.
	self assert: 7 equals: quantity.
	self assert: (testObjectsFactory itemSellByTheStorePrice * 7) equals: total.
	self assert: 
		self validBook,' was selled ',quantity asString, ' times and raised a total amount of money equal to: ', total asString
		equals: (bookPerformance at: 'summary')
	! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - performance' stamp: 'NR 6/13/2022 08:00:04'!
test21StorePerformanceShouldNotTakeTooLong

	| cartId storePerformance quantity total |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 2 of: self validBook toCartIdentifiedAs: cartId.
	systemFacade add: 1 of: self anotherValidBook toCartIdentifiedAs: cartId.
	systemFacade 
		checkOutCartIdentifiedAs: cartId 
		withCreditCardNumbered: testObjectsFactory validCreditCardNumber 
		ownedBy: testObjectsFactory validOwnerName 
		expiringOn: testObjectsFactory notExpiredMonthOfYear.
	
	cartId := systemFacade createCartFor: self anotherValidUser authenticatedWith: self anotherValidUserPassword.
	systemFacade add: 5 of: self validBook toCartIdentifiedAs: cartId.
	systemFacade add: 10 of: self anotherValidBook toCartIdentifiedAs: cartId.
	systemFacade 
		checkOutCartIdentifiedAs: cartId 
		withCreditCardNumbered: testObjectsFactory validCreditCardNumber 
		ownedBy: testObjectsFactory validOwnerName 
		expiringOn: testObjectsFactory notExpiredMonthOfYear.
			
	self should: [storePerformance := systemFacade storePerformance] 
		notTakeMoreThanMilliseconds: 1100.	

	quantity := storePerformance at: 'quantity'.
	total := storePerformance at: 'total'.

	self assert: 18 equals: quantity.
	self assert: (testObjectsFactory itemSellByTheStorePrice * 7) + (testObjectsFactory anotherItemSellByTheStorePrice * 11) equals: total.
	self assert:
		'The store selled a total of ',quantity asString, ' books and raised a total amount of money equal to: ', total asString
		equals: (storePerformance at: 'summary')
		! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - list purchases' stamp: 'HAW 7/23/2020 16:06:04'!
test14ListPurchasesIncludesBoughtItems

	| cartId purchases soldItems total |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 2 of: self validBook toCartIdentifiedAs: cartId.
	systemFacade add: 1 of: self anotherValidBook toCartIdentifiedAs: cartId.
	systemFacade 
		checkOutCartIdentifiedAs: cartId 
		withCreditCardNumbered: testObjectsFactory validCreditCardNumber 
		ownedBy: testObjectsFactory validOwnerName 
		expiringOn: testObjectsFactory notExpiredMonthOfYear.
		
	purchases := systemFacade listPurchasesOf: self validUser authenticatingWith: self validUserPassword.
	soldItems := purchases first.
	total := purchases second.

	self assert: 2 equals: (soldItems at: self validBook).
	self assert: 1 equals: (soldItems at: self anotherValidBook).
	self 
		assert: (testObjectsFactory itemSellByTheStorePrice * 2 + testObjectsFactory anotherItemSellByTheStorePrice)
		equals: total! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - list purchases' stamp: 'HAW 7/23/2020 16:06:33'!
test15CanNotListPurchasesOfInvalidCustomer

	self 
		should: [systemFacade listPurchasesOf: self invalidUser authenticatingWith: self validUserPassword ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assertMessageTextOf: anError is: systemFacade invalidUserAndOrPasswordErrorDescription ]! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - list purchases' stamp: 'HAW 7/23/2020 16:06:46'!
test16CanNotListPurchasesOfValidCustomerWithInvalidPassword

	self 
		should: [systemFacade listPurchasesOf: self validUser authenticatingWith: self invalidPassword ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assertMessageTextOf: anError is: systemFacade invalidUserAndOrPasswordErrorDescription ]! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - create cart' stamp: 'HAW 7/23/2020 15:56:11'!
test01CanCreateCartWithValidUserAndPassword

	| cartId |
	
	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	
	self assertIsEmptyCartIdentifiedAs: cartId ! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - create cart' stamp: 'HAW 7/23/2020 15:53:41'!
test02CanNotCreateCartWithInvalidUser

	self
		should: [ systemFacade createCartFor: self invalidUser authenticatedWith: self validUserPassword ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError | 
			self assertMessageTextOf: anError is: systemFacade invalidUserAndOrPasswordErrorDescription ]! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - create cart' stamp: 'HAW 7/23/2020 15:54:39'!
test03CanNotCreateCartWithInvalidPassword

	self
		should: [ systemFacade createCartFor: self validUser authenticatedWith: self invalidPassword ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError | 
			self assertMessageTextOf: anError is: systemFacade invalidUserAndOrPasswordErrorDescription ]! !
!TusLibrosSystemFacadeTest methodsFor: 'merchant processor protocol' stamp: 'HAW 7/23/2020 16:07:46'!
debit: anAmount from: aCreditCard 

	^merchantProcessorTransactionId ! !
!TusLibrosSystemFacadeTest methodsFor: 'setup' stamp: 'HernanWilkinson 6/22/2013 11:42'!
createSalesBook
	
	^OrderedCollection new! !
!TusLibrosSystemFacadeTest methodsFor: 'setup' stamp: 'HernanWilkinson 6/22/2013 11:47'!
merchantProcessor 

	^self! !
!TusLibrosSystemFacadeTest methodsFor: 'setup' stamp: 'HernanWilkinson 6/17/2015 20:53' overrides: 16961394!
setUp 

	testObjectsFactory := StoreTestObjectsFactory new.
	clock := ManualClock now: testObjectsFactory today.
	systemFacade := TusLibrosSystemFacade 
		authenticatingWith: self validUsersAndPasswords 
		acceptingItemsOf: testObjectsFactory defaultCatalog 
		registeringOn: self createSalesBook
		debitingThrought: self merchantProcessor 
		measuringTimeWith: clock
! !
!TusLibrosSystemFacadeTest methodsFor: 'test objects' stamp: 'HernanWilkinson 6/22/2013 00:15'!
anotherValidBook
	
	^testObjectsFactory anotherItemSellByTheStore ! !
!TusLibrosSystemFacadeTest methodsFor: 'test objects' stamp: 'NR 6/9/2022 20:18:52'!
anotherValidUser
	
	^'anotherValidUser'! !
!TusLibrosSystemFacadeTest methodsFor: 'test objects' stamp: 'NR 6/9/2022 20:19:12'!
anotherValidUserPassword
	
	^'anotherValidUserPassword'! !
!TusLibrosSystemFacadeTest methodsFor: 'test objects' stamp: 'HernanWilkinson 6/21/2013 23:49'!
invalidBook

	^testObjectsFactory itemNotSellByTheStore ! !
!TusLibrosSystemFacadeTest methodsFor: 'test objects' stamp: 'HAW 7/24/2020 11:08:48'!
invalidCartId
	
	"Devuelvo un objeto nuevo cada vez y de esa forma me aseguro que no pueda ser un id usado - Hernan"
	^Object new! !
!TusLibrosSystemFacadeTest methodsFor: 'test objects' stamp: 'HernanWilkinson 6/21/2013 23:06'!
invalidPassword
	
	^'invalidPassword'! !
!TusLibrosSystemFacadeTest methodsFor: 'test objects' stamp: 'HernanWilkinson 6/21/2013 22:30'!
invalidUser

	^'invalidUser'! !
!TusLibrosSystemFacadeTest methodsFor: 'test objects' stamp: 'HernanWilkinson 6/21/2013 23:50'!
validBook
	
	^testObjectsFactory itemSellByTheStore ! !
!TusLibrosSystemFacadeTest methodsFor: 'test objects' stamp: 'HernanWilkinson 6/21/2013 22:27'!
validUser
	
	^'validUser'! !
!TusLibrosSystemFacadeTest methodsFor: 'test objects' stamp: 'HernanWilkinson 6/21/2013 22:28'!
validUserPassword
	
	^'validUserPassword'! !
!TusLibrosSystemFacadeTest methodsFor: 'test objects' stamp: 'NR 6/9/2022 20:20:12'!
validUsersAndPasswords
	
	^Dictionary new
		at: self validUser put: self validUserPassword;
		at: self anotherValidUser put: self anotherValidUserPassword;
		yourself! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'HAW 7/23/2020 16:07:46'!
test10CheckOutReturnsTransactionIdAndImpactsCustomerPurchases

	| cartId  currentTransactionId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 1 of: testObjectsFactory itemSellByTheStore toCartIdentifiedAs: cartId.
	
	merchantProcessorTransactionId := Random new nextInteger: 1000.
	
	currentTransactionId := systemFacade 
		checkOutCartIdentifiedAs: cartId 
		withCreditCardNumbered: testObjectsFactory validCreditCardNumber 
		ownedBy: testObjectsFactory validOwnerName 
		expiringOn: testObjectsFactory notExpiredMonthOfYear.
	
	self assert: merchantProcessorTransactionId equals: currentTransactionId.
	self assertValidUserBougthOnlyItemSellByTheStore
	
	
		! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'HAW 7/23/2020 16:03:56'!
test10_1_CanNotCheckoutAnAlreadyCheckedOutCart

	| cartId  |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 1 of: testObjectsFactory itemSellByTheStore toCartIdentifiedAs: cartId.
	systemFacade 
		checkOutCartIdentifiedAs: cartId 
		withCreditCardNumbered: testObjectsFactory validCreditCardNumber 
		ownedBy: testObjectsFactory validOwnerName 
		expiringOn: testObjectsFactory notExpiredMonthOfYear.
			
	self 
		should: [ 
			systemFacade 
				checkOutCartIdentifiedAs: cartId 
				withCreditCardNumbered: testObjectsFactory validCreditCardNumber 
				ownedBy: testObjectsFactory validOwnerName 
				expiringOn: testObjectsFactory notExpiredMonthOfYear ]		
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError | 
			self assertMessageTextOf: anError is: systemFacade invalidCartIdErrorDescription.
			self assertValidUserBougthOnlyItemSellByTheStore ]! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'HAW 7/23/2020 16:04:14'!
test11CanNotCheckoutANotCreatedCart

	self
		should: [systemFacade 
			checkOutCartIdentifiedAs: self invalidCartId  
			withCreditCardNumbered: testObjectsFactory validCreditCardNumber 
			ownedBy: testObjectsFactory validOwnerName 
			expiringOn: testObjectsFactory notExpiredMonthOfYear ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assertMessageTextOf: anError is: systemFacade invalidCartIdErrorDescription ]
		
		! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'HAW 7/23/2020 16:04:29'!
test12CanNotCheckoutAnEmptyCart

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	self
		should: [systemFacade 
			checkOutCartIdentifiedAs: cartId 
			withCreditCardNumbered: testObjectsFactory validCreditCardNumber 
			ownedBy: testObjectsFactory validOwnerName 
			expiringOn: testObjectsFactory notExpiredMonthOfYear ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError | 
			self assertMessageTextOf: anError is: systemFacade cartCanNotBeEmptyErrorMessage.
			self assertThereAreNoPurchasesForValidUser ]
		
		! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'HAW 7/23/2020 16:08:24'!
test13CanNotCheckoutWithAnExpiredCreditCard

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 1 of: self validBook toCartIdentifiedAs: cartId.
	self
		should: [systemFacade 
			checkOutCartIdentifiedAs: cartId 
			withCreditCardNumbered: testObjectsFactory validCreditCardNumber 
			ownedBy: testObjectsFactory validOwnerName 
			expiringOn: testObjectsFactory expiredMonthOfYear ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assertMessageTextOf: anError is: systemFacade canNotChargeAnExpiredCreditCardErrorMessage.
			self assertThereAreNoPurchasesForValidUser ]
		
		! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - checkout' stamp: 'HAW 7/23/2020 16:08:40'!
test19CanNotCheckOutCartWhenSessionIsExpired

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 2 of: self validBook toCartIdentifiedAs: cartId.
	self advanceTime: (systemFacade sessionDuration + 1 minutes). 
	
	self 
		should: [systemFacade 
			checkOutCartIdentifiedAs: cartId 
			withCreditCardNumbered: testObjectsFactory validCreditCardNumber 
			ownedBy: testObjectsFactory validOwnerName 
			expiringOn: testObjectsFactory notExpiredMonthOfYear ]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assertMessageTextOf: anError is: systemFacade sessionHasExpiredErrorDescription.
			self assertThereAreNoPurchasesForValidUser ].

	! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - list cart' stamp: 'HAW 7/23/2020 15:58:09'!
test08CanNotListCartOfInvalidCartId

	self 
		should: [systemFacade listCartIdentifiedAs: self invalidCartId] 
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError | 
			self assertMessageTextOf: anError is: systemFacade invalidCartIdErrorDescription ]
	! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - list cart' stamp: 'HAW 7/23/2020 16:00:20'!
test09ListCartReturnsTheRightNumberOfItems

	| cartId cartContent |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	systemFacade add: 1 of: self validBook toCartIdentifiedAs: cartId.
	systemFacade add: 2 of: self anotherValidBook toCartIdentifiedAs: cartId.
	cartContent := systemFacade listCartIdentifiedAs: cartId.
	
	self assert: 1 equals: (cartContent occurrencesOf: self validBook). 
	self assert: 2 equals: (cartContent occurrencesOf: self anotherValidBook).
	self assert: 3 equals: cartContent size
! !
!TusLibrosSystemFacadeTest methodsFor: 'tests - list cart' stamp: 'HAW 7/23/2020 16:10:25'!
test18CanNotListCartWhenSessionIsExpired

	| cartId |

	cartId := systemFacade createCartFor: self validUser authenticatedWith: self validUserPassword.
	self advanceTime: (systemFacade sessionDuration + 1 minutes).
	 
	self 
		should: [systemFacade listCartIdentifiedAs: cartId]
		raise: Error - MessageNotUnderstood
		withExceptionDo: [ :anError |
			self assertMessageTextOf: anError is: systemFacade sessionHasExpiredErrorDescription ].

! !
!TusLibrosSystemFacadeTest methodsFor: 'time' stamp: 'HernanWilkinson 6/22/2013 12:53'!
advanceTime: aDuration 
	
	clock advanceTime: aDuration ! !
!TusLibrosSystemFacadeTest methodsFor: 'time' stamp: 'HernanWilkinson 6/22/2013 13:07'!
revertTime: aDuration 
	
	clock revertTime: aDuration ! !
!TusLibrosSystemFacadeTest methodsFor: 'assertions' stamp: 'HAW 7/23/2020 15:55:56'!
assertIsEmptyCartIdentifiedAs: cartId

	^ self assert: (systemFacade listCartIdentifiedAs: cartId) isEmpty! !
!TusLibrosSystemFacadeTest methodsFor: 'assertions' stamp: 'HAW 7/23/2020 15:54:17'!
assertMessageTextOf: anError is: anExpectedMessageText 
	
	self assert: anExpectedMessageText equals: anError messageText! !
!TusLibrosSystemFacadeTest methodsFor: 'assertions' stamp: 'HAW 7/23/2020 15:47:06'!
assertThereAreNoPurchasesForValidUser

	| purchases soldItems total |
	
	purchases := systemFacade listPurchasesOf: self validUser authenticatingWith: self validUserPassword.
	soldItems := purchases first.
	total := purchases second.

	self assert: soldItems isEmpty.
	self assert: 0 equals: total.! !
!TusLibrosSystemFacadeTest methodsFor: 'assertions' stamp: 'HAW 7/23/2020 16:03:38'!
assertValidUserBougthOnlyItemSellByTheStore
	
	| purchases soldItems total |
	purchases := systemFacade listPurchasesOf: self validUser authenticatingWith: self validUserPassword.
	soldItems := purchases first.
	total := purchases second.
	
	self assert: 1 equals: (soldItems at: self validBook).
	self assert: 1 equals: soldItems size.
	self assert: testObjectsFactory itemSellByTheStorePrice equals: total.
! !

!classDefinition: 'TusLibrosSystemFacadeTest class' category: 'TusLibros-Tests' stamp: 'ldmaf 6/15/2022 17:07:50'!
TusLibrosSystemFacadeTest class
	instanceVariableNames: ''!

!classDefinition: 'TusLibrosSystemFacadeTest class' category: 'TusLibros-Tests' stamp: 'ldmaf 6/15/2022 17:07:50'!
TusLibrosSystemFacadeTest class
	instanceVariableNames: ''!
!TusLibrosSystemFacadeTest class methodsFor: 'fileOut' stamp: 'HAW 5/6/2020 14:06:42' overrides: 16810622!
fileOut

	"self fileOut"

	DirectoryEntry smalltalkImageDirectory // 'TusLibros.st' writeStreamDo: [ :fileStream |
		SystemOrganization fileOutCategory: 'TusLibros-Model' on: fileStream initializing: true.
		SystemOrganization fileOutCategory: 'TusLibros-Test' on: fileStream initializing: true ]! !

!classDefinition: #ManualClock category: 'TusLibros-Tests' stamp: 'ldmaf 6/15/2022 17:07:50'!
ProtoObject subclass: #ManualClock
	instanceVariableNames: 'now'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

!classDefinition: #ManualClock category: 'TusLibros-Tests' stamp: 'ldmaf 6/15/2022 17:07:50'!
ProtoObject subclass: #ManualClock
	instanceVariableNames: 'now'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!
!ManualClock methodsFor: 'time change' stamp: 'HernanWilkinson 6/22/2013 12:54'!
advanceTime: aDuration 
	
	now := now + aDuration ! !
!ManualClock methodsFor: 'time change' stamp: 'HernanWilkinson 6/22/2013 13:08'!
revertTime: aDuration 
	
	now := now + aDuration negated ! !
!ManualClock methodsFor: 'time' stamp: 'HernanWilkinson 6/22/2013 12:56'!
now
	
	^ now! !
!ManualClock methodsFor: 'time' stamp: 'HernanWilkinson 6/22/2013 12:53'!
today
	
	^now date! !
!ManualClock methodsFor: 'initialization' stamp: 'HernanWilkinson 6/22/2013 12:52'!
initializeNow: aTime 

	now := aTime ! !

!classDefinition: 'ManualClock class' category: 'TusLibros-Tests' stamp: 'ldmaf 6/15/2022 17:07:51'!
ManualClock class
	instanceVariableNames: ''!

!classDefinition: 'ManualClock class' category: 'TusLibros-Tests' stamp: 'ldmaf 6/15/2022 17:07:51'!
ManualClock class
	instanceVariableNames: ''!
!ManualClock class methodsFor: 'instance creation' stamp: 'HernanWilkinson 6/22/2013 12:52'!
now: aTime 
	
	^self new initializeNow: aTime ! !

!classDefinition: #StoreTestObjectsFactory category: 'TusLibros-Tests' stamp: 'ldmaf 6/15/2022 17:07:51'!
Object subclass: #StoreTestObjectsFactory
	instanceVariableNames: 'today'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!

!classDefinition: #StoreTestObjectsFactory category: 'TusLibros-Tests' stamp: 'ldmaf 6/15/2022 17:07:51'!
Object subclass: #StoreTestObjectsFactory
	instanceVariableNames: 'today'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Tests'!
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'HernanWilkinson 6/22/2013 00:16'!
anotherItemSellByTheStore
	
	^'anotherValidBook'! !
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'HernanWilkinson 6/22/2013 00:16'!
anotherItemSellByTheStorePrice
	
	^15! !
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'HernanWilkinson 6/17/2013 18:08'!
itemNotSellByTheStore
	
	^'invalidBook'! !
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'HernanWilkinson 6/17/2013 18:08'!
itemSellByTheStore
	
	^ 'validBook'! !
!StoreTestObjectsFactory methodsFor: 'items' stamp: 'HernanWilkinson 6/17/2013 18:08'!
itemSellByTheStorePrice
	
	^10! !
!StoreTestObjectsFactory methodsFor: 'cart' stamp: 'HernanWilkinson 6/17/2013 18:08'!
createCart
	
	^Cart acceptingItemsOf: self defaultCatalog! !
!StoreTestObjectsFactory methodsFor: 'cart' stamp: 'HernanWilkinson 6/22/2013 00:16'!
defaultCatalog
	
	^ Dictionary new
		at: self itemSellByTheStore put: self itemSellByTheStorePrice;
		at: self anotherItemSellByTheStore put: self anotherItemSellByTheStorePrice;
		yourself ! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'HAW 7/22/2020 14:26:34'!
expiredCreditCard
	
	^CreditCard numbered: self validCreditCardNumber ownedBy: self validOwnerName expiringOn: self expiredMonthOfYear ! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'HernanWilkinson 6/22/2013 11:24'!
expiredMonthOfYear 

	^ Month month: today monthIndex year: today yearNumber - 1! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'HAW 7/22/2020 14:26:34'!
notExpiredCreditCard
	
	^CreditCard numbered: self validCreditCardNumber ownedBy: self validOwnerName expiringOn: self notExpiredMonthOfYear! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'HernanWilkinson 6/22/2013 11:06'!
notExpiredMonthOfYear

	^ Month month: today monthIndex year: today yearNumber + 1! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'HAW 7/23/2020 15:25:37'!
validCreditCardNumber
	
	^'1234567890123456'! !
!StoreTestObjectsFactory methodsFor: 'credit card' stamp: 'HAW 7/23/2020 15:25:51'!
validOwnerName
	
	^'Pepe Sanchez'! !
!StoreTestObjectsFactory methodsFor: 'initialization' stamp: 'HernanWilkinson 6/17/2013 18:37' overrides: 16920235!
initialize

	today := DateAndTime now! !
!StoreTestObjectsFactory methodsFor: 'date' stamp: 'HernanWilkinson 6/17/2013 18:37'!
today
	
	^ today! !
!StoreTestObjectsFactory methodsFor: 'customer' stamp: 'HernanWilkinson 6/22/2013 12:02'!
customer
	
	^'aCustomer'! !

!classDefinition: #Float32PointArray category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
Float32Array variableWordSubclass: #Float32PointArray
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Collections-CompactArrays'!

!classDefinition: #Float32PointArray category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
Float32Array variableWordSubclass: #Float32PointArray
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Collections-CompactArrays'!

!classDefinition: 'Float32PointArray class' category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
Float32PointArray class
	instanceVariableNames: ''!

!classDefinition: 'Float32PointArray class' category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
Float32PointArray class
	instanceVariableNames: ''!

!classDefinition: #PointArray category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
IntegerArray variableWordSubclass: #PointArray
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Collections-CompactArrays'!

!classDefinition: #PointArray category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
IntegerArray variableWordSubclass: #PointArray
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Collections-CompactArrays'!

!classDefinition: 'PointArray class' category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
PointArray class
	instanceVariableNames: ''!

!classDefinition: 'PointArray class' category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
PointArray class
	instanceVariableNames: ''!

!classDefinition: #ShortIntegerArray category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
ArrayedCollection variableWordSubclass: #ShortIntegerArray
	instanceVariableNames: ''
	classVariableNames: 'LastSaveOrder'
	poolDictionaries: ''
	category: 'Collections-CompactArrays'!

!classDefinition: #ShortIntegerArray category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
ArrayedCollection variableWordSubclass: #ShortIntegerArray
	instanceVariableNames: ''
	classVariableNames: 'LastSaveOrder'
	poolDictionaries: ''
	category: 'Collections-CompactArrays'!

!classDefinition: 'ShortIntegerArray class' category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
ShortIntegerArray class
	instanceVariableNames: ''!

!classDefinition: 'ShortIntegerArray class' category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
ShortIntegerArray class
	instanceVariableNames: ''!

!classDefinition: #ShortPointArray category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
ShortIntegerArray variableWordSubclass: #ShortPointArray
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Collections-CompactArrays'!

!classDefinition: #ShortPointArray category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
ShortIntegerArray variableWordSubclass: #ShortPointArray
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Collections-CompactArrays'!

!classDefinition: 'ShortPointArray class' category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
ShortPointArray class
	instanceVariableNames: ''!

!classDefinition: 'ShortPointArray class' category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
ShortPointArray class
	instanceVariableNames: ''!

!classDefinition: #ShortWordArray category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
ShortIntegerArray variableWordSubclass: #ShortWordArray
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Collections-CompactArrays'!

!classDefinition: #ShortWordArray category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
ShortIntegerArray variableWordSubclass: #ShortWordArray
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Collections-CompactArrays'!

!classDefinition: 'ShortWordArray class' category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
ShortWordArray class
	instanceVariableNames: ''!

!classDefinition: 'ShortWordArray class' category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
ShortWordArray class
	instanceVariableNames: ''!

!classDefinition: #ShortRunArray category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
ArrayedCollection variableWordSubclass: #ShortRunArray
	instanceVariableNames: ''
	classVariableNames: 'LastSaveOrder'
	poolDictionaries: ''
	category: 'Collections-CompactArrays'!

!classDefinition: #ShortRunArray category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
ArrayedCollection variableWordSubclass: #ShortRunArray
	instanceVariableNames: ''
	classVariableNames: 'LastSaveOrder'
	poolDictionaries: ''
	category: 'Collections-CompactArrays'!

!classDefinition: 'ShortRunArray class' category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
ShortRunArray class
	instanceVariableNames: ''!

!classDefinition: 'ShortRunArray class' category: 'Collections-CompactArrays' stamp: 'ldmaf 6/15/2022 17:07:52'!
ShortRunArray class
	instanceVariableNames: ''!
!Float32PointArray commentStamp: '<historical>' prior: 0!
This class stores points with 32 bit Floating point elements.

{1@2. 3@4} as: Float32PointArray!
!PointArray commentStamp: '<historical>' prior: 0!
This class stores 32bit Integer points in place. It is used to pass data efficiently to the primitive level during high-bandwidth 2D graphics operations.!
!ShortIntegerArray commentStamp: '<historical>' prior: 0!
ShortIntegerArray is an array for efficiently representing signed integers in the 16bit range, i.e. between -16r8000 and 16r7FFF.

Additionaly, using #unsignedAt:put: and #signedAt:put:, it supports unsigned 16 bits integers, between 0 and 16rFFFF. You can also alternatively ShortWordArray to store unsigned 16 bit integers with the usual #at: and #at:put: protocol.

Array size must be even, as two vales are stored in each word.!
!ShortPointArray commentStamp: '<historical>' prior: 0!
This class stores points that are in short integer range (e.g., -32767 <= value <= 32768). It is used to pass data efficiently to the primitive level during high-bandwidth 2D graphics operations.!
!ShortWordArray commentStamp: '<historical>' prior: 0!
ShortWordArrays store 16-bit unsigned Integer values, between 0 and 16rFFFF.!
!ShortRunArray commentStamp: '<historical>' prior: 0!
This class is run-length encoded representation of short integer (e.g., 16bit signed integer values)!
!ShortIntegerArray class methodsFor: 'class initialization' stamp: 'jmv 12/18/2015 15:29' overrides: 16787193!
initClassCachedState
	"Check if the word order has changed from the last save"

	((LastSaveOrder at: 1) = 42 and:[(LastSaveOrder at: 2) = 13]) 
		ifTrue:[^self]. "Okay"
	((LastSaveOrder at: 2) = 42 and:[(LastSaveOrder at: 1) = 13]) 
		ifTrue:[^self swapShortObjects]. "Reverse guys"
	^self error:'This must never happen'! !
!ShortRunArray class methodsFor: 'class initialization' stamp: 'jmv 12/18/2015 15:29' overrides: 16787193!
initClassCachedState
	"Check if the word order has changed from the last save"

	((LastSaveOrder valueAtRun: 1) = 42 and:[(LastSaveOrder lengthAtRun: 1) = 3]) 
		ifTrue:[^self]. "Okay"
	((LastSaveOrder lengthAtRun: 1) = 42 and:[(LastSaveOrder valueAtRun: 1) = 3]) 
		ifTrue:[^self swapRuns]. "Reverse guys"
	^self error:'This must never happen'! !
!ShortRunArray methodsFor: 'printing' stamp: 'ar 11/3/1998 17:41' overrides: 16823635!
printOn: aStream
	aStream nextPutAll: self class name; nextPutAll:' ( '.
	self lengthsAndValuesDo:[:runLength :runValue |
		aStream
			nextPutAll:' (';
			print: runLength;
			space;
			print: runValue;
			nextPut:$).
	].
	aStream nextPutAll:' )'.! !
!Float32PointArray methodsFor: 'accessing' stamp: 'jmv 2/28/2020 12:11:30' overrides: 16859850!
at: index
	"Return the element (e.g., point) at the given index"
	^(self floatAt: index * 2 - 1) @ (self floatAt: index * 2)! !
!Float32PointArray methodsFor: 'accessing' stamp: 'jmv 2/28/2020 12:11:49' overrides: 16859854!
at: index put: aPoint
	"Store the argument aPoint at the given index"
	self floatAt: index * 2 - 1 put: aPoint x.
	self floatAt: index * 2 put: aPoint y.
	^aPoint! !
!Float32PointArray methodsFor: 'accessing' stamp: 'jmv 2/28/2020 12:11:57'!
at: index putX: aNumber
	"Store the argument aPoint at the given index"
	self floatAt: index * 2 - 1 put: aNumber! !
!Float32PointArray methodsFor: 'accessing' stamp: 'jmv 2/28/2020 12:12:05'!
at: index putY: aNumber
	"Store the argument aPoint at the given index"
	self floatAt: index * 2 put: aNumber! !
!Float32PointArray methodsFor: 'accessing' stamp: 'jmv 2/28/2020 12:04:36' overrides: 16781647!
bytesPerElement

	^ 8! !
!Float32PointArray methodsFor: 'accessing' stamp: 'jmv 2/28/2020 12:02:36' overrides: 16859858!
defaultElement
	"Return the default element of the receiver"
	^`0.0@0.0`! !
!Float32PointArray methodsFor: 'accessing' stamp: 'jmv 2/28/2020 12:12:17' overrides: 16781372!
size
	"Return the number of elements in the receiver"
	^ super size // 2! !
!Float32PointArray methodsFor: 'printing' stamp: 'jmv 2/28/2020 14:59:07' overrides: 16859649!
printElementsOn: aStream
	"FloatArray elements are answered as 64 bit Float, but are really 32 bit Float.
	When printing, print them as 32 bit Float."
	aStream nextPut: ${.
	self do: [ :point |
		point x printAsIEEE32BitPrecisionFloatOn: aStream base: 10.
		aStream nextPut: $@.
		point y printAsIEEE32BitPrecisionFloatOn: aStream base: 10.
		aStream nextPut: $..
		aStream space].
	self isEmpty ifFalse: [aStream skip: -2].
	aStream nextPut: $}! !
!Float32PointArray class methodsFor: 'instance creation' stamp: 'jmv 2/28/2020 12:13:28' overrides: 16785654!
new: n
	^super new: n*2! !
!PointArray methodsFor: 'accessing' stamp: 'jmv 2/28/2020 12:26:03' overrides: 16876581!
at: index
	"Return the element (e.g., point) at the given index"
	^(self integerAt: index * 2 - 1) @ (self integerAt: index * 2)! !
!PointArray methodsFor: 'accessing' stamp: 'jmv 2/28/2020 12:26:16' overrides: 16876585!
at: index put: aPoint
	"Store the argument aPoint at the given index"
	self integerAt: index * 2 - 1 put: aPoint x asInteger.
	self integerAt: index * 2 put: aPoint y asInteger.
	^aPoint! !
!PointArray methodsFor: 'accessing' stamp: 'jmv 5/16/2019 16:20:10'!
at: index putX: aNumber
	"Store the argument aPoint at the given index"
	super at: index * 2 - 1 put: aNumber asInteger! !
!PointArray methodsFor: 'accessing' stamp: 'jmv 5/16/2019 16:19:55'!
at: index putY: aNumber
	"Store the argument aPoint at the given index"
	super at: index * 2 put: aNumber asInteger! !
!PointArray methodsFor: 'accessing' stamp: 'ar 11/10/1998 19:41'!
bounds
	| min max |
	min _ max _ self at: 1.
	self do:[:pt|
		min _ min min: pt.
		max _ max max: pt].
	^min corner: max
		! !
!PointArray methodsFor: 'accessing' stamp: 'jmv 2/28/2020 12:04:33' overrides: 16781647!
bytesPerElement

	^ 8! !
!PointArray methodsFor: 'accessing' stamp: 'ar 11/2/1998 12:19' overrides: 16876599!
defaultElement
	"Return the default element of the receiver"
	^0@0! !
!PointArray methodsFor: 'accessing' stamp: 'ar 11/2/1998 12:21' overrides: 16781372!
size
	"Return the number of elements in the receiver"
	^super size // 2! !
!PointArray class methodsFor: 'instance creation' stamp: 'ar 10/16/1998 00:04' overrides: 16785654!
new: n
	^super new: n*2! !
!ShortIntegerArray methodsFor: 'accessing' stamp: 'jmv 2/27/2013 07:21' overrides: 16901507!
at: index
	"Return the 16-bit signed integer value at the given index of the receiver."

	^self signedAt: index! !
!ShortIntegerArray methodsFor: 'accessing' stamp: 'jmv 2/28/2020 12:31:26' overrides: 16901525!
at: index put: value
	"Store the given 16-bit signed integer at the given index in the receiver."

	^self signedAt: index put: value! !
!ShortIntegerArray methodsFor: 'accessing' stamp: 'ar 11/3/1998 15:41' overrides: 16781406!
defaultElement
	^0! !
!ShortIntegerArray methodsFor: 'accessing' stamp: 'jmv 2/27/2013 07:21'!
signedAt: index
	"Return the 16-bit signed integer value at the given index of the receiver."

	<primitive: 143>
	index isInteger ifTrue: [self errorSubscriptBounds: index].
	index isNumber ifTrue: [^ self at: index truncated].
	self errorNonIntegerIndex.
! !
!ShortIntegerArray methodsFor: 'accessing' stamp: 'jmv 2/28/2020 12:30:51'!
signedAt: index put: value
	"Store the given 16-bit signed integer at the given index in the receiver."

	<primitive: 144>
	index isInteger
		ifTrue: [
			(index >= 1 and: [index <= self size])
				ifTrue: [self errorImproperStore]
				ifFalse: [self errorSubscriptBounds: index]].
	index isNumber ifTrue: [^ self at: index truncated put: value].
	self errorNonIntegerIndex.
! !
!ShortIntegerArray methodsFor: 'accessing' stamp: 'ar 11/3/1998 15:41' overrides: 16781372!
size
	^super size * 2! !
!ShortIntegerArray methodsFor: 'accessing' stamp: 'jmv 2/28/2013 16:52'!
unsignedAt: index
	"Return the 16-bit unsigned integer value at the given index of the receiver."

	| primValue |
	primValue _ self signedAt: index.
	^primValue < 0
		ifTrue: [
			primValue + 16r10000.		"Faster. No need for LargeInteger arithmetic"
			"(primValue + 1) negated bitInvert16" ]
		ifFalse: [ primValue ]! !
!ShortIntegerArray methodsFor: 'accessing' stamp: 'jmv 2/28/2020 12:33:29'!
unsignedAt: index put: value
	"Store the given 16-bit unsigned integer at the given index in the receiver."

	| primValue |
	value < 0 ifTrue: [ self errorImproperStore ].
	value > 16rFFFF ifTrue: [ self errorImproperStore ].
	primValue _ value > 16r7FFF
			ifTrue: [
				value - 16r10000.		"Faster. No need for LargeInteger arithmetic"
				"(value bitInvert16 + 1) negated" ]
			ifFalse: [ value ].
	self signedAt: index put: primValue.
	^value! !
!ShortIntegerArray methodsFor: 'objects from disk' stamp: 'nk 3/7/2004 13:54' overrides: 16781647!
bytesPerElement
	^2! !
!ShortIntegerArray methodsFor: 'objects from disk' stamp: 'jmv 2/15/2008 00:48' overrides: 16781652!
restoreEndianness
	"This word object was just read in from a stream.  It was stored in Big Endian (Mac) format.  Swap each pair of bytes (16-bit word), if the current machine is Little Endian.
	Why is this the right thing to do?  We are using memory as a byteStream.  High and low bytes are reversed in each 16-bit word, but the stream of words ascends through memory.  Different from a Bitmap."

	| hack blt |
	Smalltalk isLittleEndian ifTrue: [
		"The implementation is a hack, but fast for large ranges"
		hack _ Form new hackBits: self.
		blt _ (BitBlt toForm: hack) sourceForm: hack.
		blt combinationRule: Form reverse.  "XOR"
		blt sourceY: 0; destY: 0; height: hack height; width: 1.
		blt sourceX: 0; destX: 1; copyBits.  "Exchange bytes 0 and 1"
		blt sourceX: 1; destX: 0; copyBits.
		blt sourceX: 0; destX: 1; copyBits.
		blt sourceX: 2; destX: 3; copyBits.  "Exchange bytes 2 and 3"
		blt sourceX: 3; destX: 2; copyBits.
		blt sourceX: 2; destX: 3; copyBits
	].
! !
!ShortIntegerArray methodsFor: 'objects from disk' stamp: 'jmv 2/26/2016 17:08' overrides: 16781668!
writeOn: aStream 

	| w |
	aStream nextSignedInt32Put: self basicSize bigEndian: true.

	1 to: self basicSize do: [ :i |
		w _ self basicAt: i.
		Smalltalk isLittleEndian
			ifFalse: [ aStream nextUnsignedInt32Put: w bigEndian: true ]
			ifTrue: [ aStream
				nextPut: (w digitAt: 2);
				nextPut: (w digitAt: 1);
				nextPut: (w digitAt: 4);
				nextPut: (w digitAt: 3) ]].! !
!ShortIntegerArray class methodsFor: 'class initialization' stamp: 'jmv 12/12/2014 16:56' overrides: 16904184!
initialize
	"
	ShortIntegerArray initialize.
	SystemDictionary initialize.
	"
	LastSaveOrder _ self new: 2.
	LastSaveOrder at: 1 put: 42.
	LastSaveOrder at: 2 put: 13! !
!ShortIntegerArray class methodsFor: 'class initialization' stamp: 'jmv 2/25/2016 10:51'!
swapShortObjects
	self allSubInstancesDo: [ :inst |
		BitBlt swapHalvesIn32BitWords: inst ]! !
!ShortIntegerArray class methodsFor: 'instance creation' stamp: 'jmv 9/4/2015 13:09' overrides: 16785654!
new: n
	"Instances are always of even size. Only accept those."
	n even ifFalse: [
		self error: 'ShortIntegerArray>>#new: must be called with an even argument' ].
	^ super new: n // 2! !
!ShortPointArray methodsFor: 'accessing' stamp: 'jmv 2/28/2020 12:14:47' overrides: 50520430!
at: index
	"Return the element (e.g., point) at the given index"
	^(self signedAt: index * 2 - 1) @ (self signedAt: index * 2)! !
!ShortPointArray methodsFor: 'accessing' stamp: 'jmv 2/28/2020 12:31:56' overrides: 50520437!
at: index put: aPoint
	"Store the argument aPoint at the given index"
	self signedAt: index * 2 - 1 put: aPoint x asInteger.
	self signedAt: index * 2 put: aPoint y asInteger.
	^aPoint! !
!ShortPointArray methodsFor: 'accessing' stamp: 'jmv 2/28/2020 12:32:06'!
at: index putX: aNumber
	"Store the argument aPoint at the given index"
	self signedAt: index * 2 - 1 put: aNumber asInteger! !
!ShortPointArray methodsFor: 'accessing' stamp: 'jmv 2/28/2020 12:32:13'!
at: index putY: aNumber
	"Store the argument aPoint at the given index"
	self signedAt: index * 2 put: aNumber asInteger! !
!ShortPointArray methodsFor: 'accessing' stamp: 'ar 11/10/1998 19:41'!
bounds
	| min max |
	min _ max _ self at: 1.
	self do:[:pt|
		min _ min min: pt.
		max _ max max: pt].
	^min corner: max
		! !
!ShortPointArray methodsFor: 'accessing' stamp: 'yo 3/6/2004 12:56' overrides: 50520509!
bytesPerElement

	^ 4.
	! !
!ShortPointArray methodsFor: 'accessing' stamp: 'ar 11/3/1998 15:43' overrides: 50520445!
defaultElement
	"Return the default element of the receiver"
	^0@0! !
!ShortPointArray methodsFor: 'accessing' stamp: 'ar 11/3/1998 15:43' overrides: 50520474!
size
	^self basicSize! !
!ShortPointArray class methodsFor: 'instance creation' stamp: 'ar 1/15/1999 17:40' overrides: 50520579!
new: n
	^super new: n * 2! !
!ShortWordArray methodsFor: 'accessing' stamp: 'jmv 2/27/2013 07:23' overrides: 50520430!
at: index
	"Return the 16-bit unsigned integer value at the given index of the receiver."

	^self unsignedAt: index! !
!ShortWordArray methodsFor: 'accessing' stamp: 'jmv 2/28/2020 12:33:43' overrides: 50520437!
at: index put: value
	"Store the given 16-bit unsigned integer at the given index in the receiver."

	^self unsignedAt: index put: value! !
!ShortRunArray methodsFor: 'accessing' stamp: 'ar 11/3/1998 17:26' overrides: 16901507!
at: index
	"Return the short value at the given index"
	| rlIndex |
	index < 1 ifTrue:[^self errorSubscriptBounds: index].
	rlIndex _ index.
	self lengthsAndValuesDo:[:runLength :runValue|
		rlIndex <= runLength ifTrue:[^runValue].
		rlIndex _ rlIndex - runLength].
	"Not found. Must be out of range"
	^self errorSubscriptBounds: index! !
!ShortRunArray methodsFor: 'accessing' stamp: 'ar 11/3/1998 17:18' overrides: 16901525!
at: index put: value
	"ShortRunArrays are read-only"
	^self shouldNotImplement.! !
!ShortRunArray methodsFor: 'accessing' stamp: 'yo 3/6/2004 14:19' overrides: 16781647!
bytesPerElement

	^ 4
! !
!ShortRunArray methodsFor: 'accessing' stamp: 'ar 11/3/1998 17:39'!
compressionRatio
	"Return the compression ratio.
	The compression ratio is computed based
	on how much space would be needed to
	store the receiver in a ShortIntegerArray"
	^(self size asFloat * 0.5) "Would need only half of the amount in ShortIntegerArray"
		/ (self runSize max: 1)! !
!ShortRunArray methodsFor: 'accessing' stamp: 'ar 11/3/1998 17:21'!
lengthAtRun: index
	"Return the length of the run starting at the given index"
	^(self basicAt: index) bitShift: -16! !
!ShortRunArray methodsFor: 'accessing' stamp: 'ar 11/3/1998 17:28'!
runSize
	"Return the number of runs in the receiver"
	^self basicSize! !
!ShortRunArray methodsFor: 'accessing' stamp: 'ar 11/3/1998 17:28' overrides: 16781372!
size
	"Return the number of elements stored in the receiver"
	| n |
	n _ 0.
	"Note: The following loop is open-coded for speed"
	1 to: self basicSize do:[:i|
		n _ n + ((self basicAt: i) bitShift: -16).
	].
	^n! !
!ShortRunArray methodsFor: 'accessing' stamp: 'ar 11/3/1998 17:29' overrides: 16823689!
species
	"Answer the preferred class for reconstructing the receiver."
	^ShortIntegerArray! !
!ShortRunArray methodsFor: 'accessing' stamp: 'ar 11/3/1998 17:22'!
valueAtRun: index
	"Return the value of the run starting at the given index"
	| uShort |
	uShort _ (self basicAt: index) bitAnd: 16rFFFF.
	^(uShort bitAnd: 16r7FFF) - (uShort bitAnd: 16r8000)! !
!ShortRunArray methodsFor: 'enumerating' stamp: 'ar 11/3/1998 17:31' overrides: 16934379!
do: aBlock
	"Evaluate aBlock with all elements of the receiver"
	self lengthsAndValuesDo:[:runLength :runValue|
		"Use to:do: instead of timesRepeat: for compiler optimization"
		1 to: runLength do:[:i|
			aBlock value: runValue.
		].
	].! !
!ShortRunArray methodsFor: 'enumerating' stamp: 'ar 12/27/1999 13:44'!
lengthsAndValuesDo: aBlock
	"Evaluate aBlock with the length and value of each run in the receiver"
	^self runsAndValuesDo: aBlock! !
!ShortRunArray methodsFor: 'enumerating' stamp: 'ar 12/27/1999 13:44'!
runsAndValuesDo: aBlock
	"Evaluate aBlock with the length and value of each run in the receiver"
	| basicValue length value |
	1 to: self basicSize do:[:i|
		basicValue _ self basicAt: i.
		length _ basicValue bitShift: -16.
		value _ basicValue bitAnd: 16rFFFF.
		value _ (value bitAnd: 16r7FFF) - (value bitAnd: 16r8000).
		aBlock value: length value: value.
	].! !
!ShortRunArray methodsFor: 'enumerating' stamp: 'ar 11/3/1998 21:05'!
valuesCollect: aBlock
	"Evaluate aBlock with each of the receiver's values as the argument. 
	Collect the resulting values into a collection like the receiver. Answer 
	the new collection."
	| newArray newValue |
	newArray _ self class basicNew: self basicSize.
	1 to: self runSize do:[:i|
		newValue _ aBlock value: (self valueAtRun: i).
		newArray setRunAt: i toLength: (self lengthAtRun: i) value: newValue.
	].
	^newArray! !
!ShortRunArray methodsFor: 'enumerating' stamp: 'ar 11/15/1998 17:22'!
valuesDo: aBlock
	self lengthsAndValuesDo:[:runLength :runValue| aBlock value: runValue]! !
!ShortRunArray methodsFor: 'objects from disk' stamp: 'jmv 2/15/2008 00:49' overrides: 16781652!
restoreEndianness
	"This word object was just read in from a stream.  It was stored in Big Endian (Mac) format.  Swap each pair of bytes (16-bit word), if the current machine is Little Endian.
	Why is this the right thing to do?  We are using memory as a byteStream.  High and low bytes are reversed in each 16-bit word, but the stream of words ascends through memory.  Different from a Bitmap."

	| w b1 b2 b3 b4 |
	Smalltalk isLittleEndian ifTrue: [
		1 to: self basicSize do: [:i |
			w _ self basicAt: i.
			b1 _ w digitAt: 1.
			b2 _ w digitAt: 2.
			b3 _ w digitAt: 3.
			b4 _ w digitAt: 4.
			w _ (b1 << 24) + (b2 << 16) + (b3 << 8) + b4.
			self basicAt: i put: w.
		]
	].

! !
!ShortRunArray methodsFor: 'private' stamp: 'ar 11/3/1998 21:02'!
setRunAt: i toLength: runLength value: value
	(value < -16r7FFF or:[value > 16r8000]) ifTrue:[^self errorImproperStore].
	(runLength < 0 or:[runLength > 16rFFFF]) ifTrue:[^self errorImproperStore].
	self basicAt: i put: (runLength bitShift: 16) + 
		((value bitAnd: 16r7FFF) - (value bitAnd: -16r8000)).! !
!ShortRunArray methodsFor: 'private' stamp: 'ar 11/3/1998 21:00'!
setRuns: runArray values: valueArray
	| runLength value |
	1 to: runArray size do:[:i|
		runLength _ runArray at: i.
		value _ valueArray at: i.
		self setRunAt: i toLength: runLength value: value.
	].! !
!ShortRunArray class methodsFor: 'class initialization' stamp: 'jmv 12/12/2014 16:56' overrides: 16904184!
initialize
	"
	ShortRunArray initialize
	SystemDictionary initialize.
	"
	LastSaveOrder _ #(42 42 42) as: self! !
!ShortRunArray class methodsFor: 'class initialization' stamp: 'jmv 2/25/2016 10:52'!
swapRuns
	self allSubInstancesDo: [ :inst |
		BitBlt swapHalvesIn32BitWords: inst ]! !
!ShortRunArray class methodsFor: 'instance creation' stamp: 'ar 11/3/1998 17:12' overrides: 16785654!
new: n
	"ShortRunArrays must be created with either
		someCollection as: ShortRunArray
	or by using
		ShortRunArray runs: runCollection values: valueCollection.
	"
	^self shouldNotImplement! !
!ShortRunArray class methodsFor: 'instance creation' stamp: 'jmv 12/12/2014 17:12' overrides: 16781750!
newFrom: aCollection
	"Compress aCollection into a ShortRunArray"
	| lastValue lastRun runs values valueCount |
	aCollection isEmpty ifTrue: [ ^self runs:#() values: #() ].
	runs _ WriteStream on: (WordArray new: 100).
	values _ WriteStream on: (ShortIntegerArray new: 100).
	lastValue _ aCollection first.
	lastRun _ 0.
	valueCount _ 0.
	aCollection do: [ :item |
		(item = lastValue and:[lastRun < 16r8000]) ifTrue:[
			lastRun _ lastRun + 1.
		] ifFalse:[
			runs nextPut: lastRun.
			values nextPut: lastValue.
			lastRun _ 1.
			lastValue _ item.
			valueCount _ valueCount + 1.
		].
	].
	runs nextPut: lastRun.
	values nextPut: lastValue.
	valueCount _ valueCount + 1.
	valueCount odd ifTrue: [
		values nextPut: 0 ].
	^ self runs: runs contents values: values contents! !
!ShortRunArray class methodsFor: 'instance creation' stamp: 'ar 11/3/1998 17:12'!
runs: runCollection values: valueCollection
	^(self basicNew: runCollection size) setRuns: runCollection values: valueCollection! !
!Collection methodsFor: '*Collections-CompactArrays' stamp: 'jmv 12/18/2015 15:01'!
asPointArray
	"Answer a PointArray whose elements are the elements of the receiver"

	^self as: PointArray! !

!classDefinition: #GZipConstants category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:57'!
SharedPool subclass: #GZipConstants
	instanceVariableNames: ''
	classVariableNames: 'GZipAsciiFlag GZipCommentFlag GZipContinueFlag GZipDeflated GZipEncryptFlag GZipExtraField GZipMagic GZipNameFlag GZipReservedFlags'
	poolDictionaries: ''
	category: 'Compression-System'!

!classDefinition: #GZipConstants category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:57'!
SharedPool subclass: #GZipConstants
	instanceVariableNames: ''
	classVariableNames: 'GZipAsciiFlag GZipCommentFlag GZipContinueFlag GZipDeflated GZipEncryptFlag GZipExtraField GZipMagic GZipNameFlag GZipReservedFlags'
	poolDictionaries: ''
	category: 'Compression-System'!

!classDefinition: 'GZipConstants class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:57'!
GZipConstants class
	instanceVariableNames: ''!

!classDefinition: 'GZipConstants class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:57'!
GZipConstants class
	instanceVariableNames: ''!

!classDefinition: #ZipConstants category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:57'!
SharedPool subclass: #ZipConstants
	instanceVariableNames: ''
	classVariableNames: 'BaseDistance BaseLength BitLengthOrder DistanceCodes DynamicBlock EndBlock ExtraBitLengthBits ExtraDistanceBits ExtraLengthBits FixedBlock FixedDistanceTree FixedLiteralTree HashBits HashMask HashShift MatchLengthCodes MaxBitLengthBits MaxBitLengthCodes MaxBits MaxDistCodes MaxDistance MaxLengthCodes MaxLiteralCodes MaxMatch MinMatch NumLiterals Repeat11To138 Repeat3To10 Repeat3To6 StoredBlock WindowMask WindowSize'
	poolDictionaries: ''
	category: 'Compression-System'!

!classDefinition: #ZipConstants category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:57'!
SharedPool subclass: #ZipConstants
	instanceVariableNames: ''
	classVariableNames: 'BaseDistance BaseLength BitLengthOrder DistanceCodes DynamicBlock EndBlock ExtraBitLengthBits ExtraDistanceBits ExtraLengthBits FixedBlock FixedDistanceTree FixedLiteralTree HashBits HashMask HashShift MatchLengthCodes MaxBitLengthBits MaxBitLengthCodes MaxBits MaxDistCodes MaxDistance MaxLengthCodes MaxLiteralCodes MaxMatch MinMatch NumLiterals Repeat11To138 Repeat3To10 Repeat3To6 StoredBlock WindowMask WindowSize'
	poolDictionaries: ''
	category: 'Compression-System'!

!classDefinition: 'ZipConstants class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:57'!
ZipConstants class
	instanceVariableNames: ''!

!classDefinition: 'ZipConstants class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:57'!
ZipConstants class
	instanceVariableNames: ''!

!classDefinition: #ZipFileConstants category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:57'!
SharedPool subclass: #ZipFileConstants
	instanceVariableNames: ''
	classVariableNames: 'CentralDirectoryFileHeaderSignature CompressionDeflated CompressionLevelDefault CompressionLevelNone CompressionStored DataDescriptorLength DefaultDirectoryPermissions DefaultFilePermissions DeflatingCompressionFast DeflatingCompressionMaximum DeflatingCompressionNormal DeflatingCompressionSuperFast DirectoryAttrib EndOfCentralDirectorySignature FaMsdos FaUnix FileAttrib IfaBinaryFile IfaTextFile LocalFileHeaderSignature'
	poolDictionaries: ''
	category: 'Compression-Archives'!

!classDefinition: #ZipFileConstants category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:57'!
SharedPool subclass: #ZipFileConstants
	instanceVariableNames: ''
	classVariableNames: 'CentralDirectoryFileHeaderSignature CompressionDeflated CompressionLevelDefault CompressionLevelNone CompressionStored DataDescriptorLength DefaultDirectoryPermissions DefaultFilePermissions DeflatingCompressionFast DeflatingCompressionMaximum DeflatingCompressionNormal DeflatingCompressionSuperFast DirectoryAttrib EndOfCentralDirectorySignature FaMsdos FaUnix FileAttrib IfaBinaryFile IfaTextFile LocalFileHeaderSignature'
	poolDictionaries: ''
	category: 'Compression-Archives'!

!classDefinition: 'ZipFileConstants class' category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:57'!
ZipFileConstants class
	instanceVariableNames: ''!

!classDefinition: 'ZipFileConstants class' category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:57'!
ZipFileConstants class
	instanceVariableNames: ''!

!classDefinition: #InflateStream category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
ReadStream subclass: #InflateStream
	instanceVariableNames: 'state bitBuf bitPos source sourcePos sourceLimit litTable distTable sourceStream crc'
	classVariableNames: 'BlockProceedBit BlockTypes FixedDistCodes FixedLitCodes MaxBits StateNewBlock StateNoMoreData'
	poolDictionaries: ''
	category: 'Compression-System'!

!classDefinition: #InflateStream category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
ReadStream subclass: #InflateStream
	instanceVariableNames: 'state bitBuf bitPos source sourcePos sourceLimit litTable distTable sourceStream crc'
	classVariableNames: 'BlockProceedBit BlockTypes FixedDistCodes FixedLitCodes MaxBits StateNewBlock StateNoMoreData'
	poolDictionaries: ''
	category: 'Compression-System'!

!classDefinition: 'InflateStream class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
InflateStream class
	instanceVariableNames: ''!

!classDefinition: 'InflateStream class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
InflateStream class
	instanceVariableNames: ''!

!classDefinition: #FastInflateStream category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
InflateStream subclass: #FastInflateStream
	instanceVariableNames: ''
	classVariableNames: 'DistanceMap FixedDistTable FixedLitTable LiteralLengthMap'
	poolDictionaries: ''
	category: 'Compression-System'!

!classDefinition: #FastInflateStream category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
InflateStream subclass: #FastInflateStream
	instanceVariableNames: ''
	classVariableNames: 'DistanceMap FixedDistTable FixedLitTable LiteralLengthMap'
	poolDictionaries: ''
	category: 'Compression-System'!

!classDefinition: 'FastInflateStream class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
FastInflateStream class
	instanceVariableNames: ''!

!classDefinition: 'FastInflateStream class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
FastInflateStream class
	instanceVariableNames: ''!

!classDefinition: #GZipReadStream category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
FastInflateStream subclass: #GZipReadStream
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: 'GZipConstants'
	category: 'Compression-System'!

!classDefinition: #GZipReadStream category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
FastInflateStream subclass: #GZipReadStream
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: 'GZipConstants'
	category: 'Compression-System'!

!classDefinition: 'GZipReadStream class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
GZipReadStream class
	instanceVariableNames: ''!

!classDefinition: 'GZipReadStream class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
GZipReadStream class
	instanceVariableNames: ''!

!classDefinition: #ZLibReadStream category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
FastInflateStream subclass: #ZLibReadStream
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-System'!

!classDefinition: #ZLibReadStream category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
FastInflateStream subclass: #ZLibReadStream
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-System'!

!classDefinition: 'ZLibReadStream class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZLibReadStream class
	instanceVariableNames: ''!

!classDefinition: 'ZLibReadStream class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZLibReadStream class
	instanceVariableNames: ''!

!classDefinition: #ZipReadStream category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
FastInflateStream subclass: #ZipReadStream
	instanceVariableNames: 'expectedCrc'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-System'!

!classDefinition: #ZipReadStream category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
FastInflateStream subclass: #ZipReadStream
	instanceVariableNames: 'expectedCrc'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-System'!

!classDefinition: 'ZipReadStream class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipReadStream class
	instanceVariableNames: ''!

!classDefinition: 'ZipReadStream class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipReadStream class
	instanceVariableNames: ''!

!classDefinition: #DeflateStream category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
WriteStream subclass: #DeflateStream
	instanceVariableNames: 'hashHead hashTail hashValue blockPosition blockStart'
	classVariableNames: ''
	poolDictionaries: 'ZipConstants'
	category: 'Compression-System'!

!classDefinition: #DeflateStream category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
WriteStream subclass: #DeflateStream
	instanceVariableNames: 'hashHead hashTail hashValue blockPosition blockStart'
	classVariableNames: ''
	poolDictionaries: 'ZipConstants'
	category: 'Compression-System'!

!classDefinition: 'DeflateStream class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
DeflateStream class
	instanceVariableNames: ''!

!classDefinition: 'DeflateStream class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
DeflateStream class
	instanceVariableNames: ''!

!classDefinition: #ZipWriteStream category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
DeflateStream subclass: #ZipWriteStream
	instanceVariableNames: 'literals distances literalFreq distanceFreq litCount matchCount encoder crc crcPosition bytesWritten'
	classVariableNames: 'CrcTable VerboseLevel'
	poolDictionaries: 'ZipConstants'
	category: 'Compression-System'!

!classDefinition: #ZipWriteStream category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
DeflateStream subclass: #ZipWriteStream
	instanceVariableNames: 'literals distances literalFreq distanceFreq litCount matchCount encoder crc crcPosition bytesWritten'
	classVariableNames: 'CrcTable VerboseLevel'
	poolDictionaries: 'ZipConstants'
	category: 'Compression-System'!

!classDefinition: 'ZipWriteStream class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipWriteStream class
	instanceVariableNames: ''!

!classDefinition: 'ZipWriteStream class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipWriteStream class
	instanceVariableNames: ''!

!classDefinition: #GZipWriteStream category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipWriteStream subclass: #GZipWriteStream
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: 'GZipConstants'
	category: 'Compression-System'!

!classDefinition: #GZipWriteStream category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipWriteStream subclass: #GZipWriteStream
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: 'GZipConstants'
	category: 'Compression-System'!

!classDefinition: 'GZipWriteStream class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
GZipWriteStream class
	instanceVariableNames: ''!

!classDefinition: 'GZipWriteStream class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
GZipWriteStream class
	instanceVariableNames: ''!

!classDefinition: #ZLibWriteStream category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipWriteStream subclass: #ZLibWriteStream
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-System'!

!classDefinition: #ZLibWriteStream category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipWriteStream subclass: #ZLibWriteStream
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-System'!

!classDefinition: 'ZLibWriteStream class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZLibWriteStream class
	instanceVariableNames: ''!

!classDefinition: 'ZLibWriteStream class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZLibWriteStream class
	instanceVariableNames: ''!

!classDefinition: #ZipEncoder category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
WriteStream subclass: #ZipEncoder
	instanceVariableNames: 'bitBuffer bitPosition encodedStream'
	classVariableNames: ''
	poolDictionaries: 'ZipConstants'
	category: 'Compression-System'!

!classDefinition: #ZipEncoder category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
WriteStream subclass: #ZipEncoder
	instanceVariableNames: 'bitBuffer bitPosition encodedStream'
	classVariableNames: ''
	poolDictionaries: 'ZipConstants'
	category: 'Compression-System'!

!classDefinition: 'ZipEncoder class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipEncoder class
	instanceVariableNames: ''!

!classDefinition: 'ZipEncoder class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipEncoder class
	instanceVariableNames: ''!

!classDefinition: #CRCError category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
Error subclass: #CRCError
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-System'!

!classDefinition: #CRCError category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
Error subclass: #CRCError
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-System'!

!classDefinition: 'CRCError class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
CRCError class
	instanceVariableNames: ''!

!classDefinition: 'CRCError class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
CRCError class
	instanceVariableNames: ''!

!classDefinition: #GZipSurrogateStream category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
Object subclass: #GZipSurrogateStream
	instanceVariableNames: 'gZipStream zippedFileStream bufferStream positionThusFar'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-System'!

!classDefinition: #GZipSurrogateStream category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
Object subclass: #GZipSurrogateStream
	instanceVariableNames: 'gZipStream zippedFileStream bufferStream positionThusFar'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-System'!

!classDefinition: 'GZipSurrogateStream class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
GZipSurrogateStream class
	instanceVariableNames: ''!

!classDefinition: 'GZipSurrogateStream class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
GZipSurrogateStream class
	instanceVariableNames: ''!

!classDefinition: #ZipEncoderNode category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
Object subclass: #ZipEncoderNode
	instanceVariableNames: 'value frequency height bitLength code parent left right'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-System'!

!classDefinition: #ZipEncoderNode category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
Object subclass: #ZipEncoderNode
	instanceVariableNames: 'value frequency height bitLength code parent left right'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-System'!

!classDefinition: 'ZipEncoderNode class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipEncoderNode class
	instanceVariableNames: ''!

!classDefinition: 'ZipEncoderNode class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipEncoderNode class
	instanceVariableNames: ''!

!classDefinition: #ZipEncoderTree category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
Object subclass: #ZipEncoderTree
	instanceVariableNames: 'bitLengths codes maxCode'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-System'!

!classDefinition: #ZipEncoderTree category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
Object subclass: #ZipEncoderTree
	instanceVariableNames: 'bitLengths codes maxCode'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-System'!

!classDefinition: 'ZipEncoderTree class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipEncoderTree class
	instanceVariableNames: ''!

!classDefinition: 'ZipEncoderTree class' category: 'Compression-System' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipEncoderTree class
	instanceVariableNames: ''!

!classDefinition: #Archive category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
Object subclass: #Archive
	instanceVariableNames: 'members'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-Archives'!

!classDefinition: #Archive category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
Object subclass: #Archive
	instanceVariableNames: 'members'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-Archives'!

!classDefinition: 'Archive class' category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
Archive class
	instanceVariableNames: ''!

!classDefinition: 'Archive class' category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
Archive class
	instanceVariableNames: ''!

!classDefinition: #ZipArchive category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
Archive subclass: #ZipArchive
	instanceVariableNames: 'centralDirectorySize centralDirectoryOffsetWRTStartingDiskNumber zipFileComment writeCentralDirectoryOffset writeEOCDOffset'
	classVariableNames: ''
	poolDictionaries: 'ZipFileConstants'
	category: 'Compression-Archives'!

!classDefinition: #ZipArchive category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
Archive subclass: #ZipArchive
	instanceVariableNames: 'centralDirectorySize centralDirectoryOffsetWRTStartingDiskNumber zipFileComment writeCentralDirectoryOffset writeEOCDOffset'
	classVariableNames: ''
	poolDictionaries: 'ZipFileConstants'
	category: 'Compression-Archives'!

!classDefinition: 'ZipArchive class' category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipArchive class
	instanceVariableNames: ''!

!classDefinition: 'ZipArchive class' category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipArchive class
	instanceVariableNames: ''!

!classDefinition: #ArchiveMember category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
Object subclass: #ArchiveMember
	instanceVariableNames: 'fileName isCorrupt'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-Archives'!

!classDefinition: #ArchiveMember category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
Object subclass: #ArchiveMember
	instanceVariableNames: 'fileName isCorrupt'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-Archives'!

!classDefinition: 'ArchiveMember class' category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ArchiveMember class
	instanceVariableNames: ''!

!classDefinition: 'ArchiveMember class' category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ArchiveMember class
	instanceVariableNames: ''!

!classDefinition: #ZipArchiveMember category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ArchiveMember subclass: #ZipArchiveMember
	instanceVariableNames: 'lastModFileDateTime fileAttributeFormat versionMadeBy versionNeededToExtract bitFlag compressionMethod desiredCompressionMethod desiredCompressionLevel internalFileAttributes externalFileAttributes cdExtraField localExtraField fileComment crc32 compressedSize uncompressedSize writeLocalHeaderRelativeOffset readDataRemaining'
	classVariableNames: ''
	poolDictionaries: 'ZipFileConstants'
	category: 'Compression-Archives'!

!classDefinition: #ZipArchiveMember category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ArchiveMember subclass: #ZipArchiveMember
	instanceVariableNames: 'lastModFileDateTime fileAttributeFormat versionMadeBy versionNeededToExtract bitFlag compressionMethod desiredCompressionMethod desiredCompressionLevel internalFileAttributes externalFileAttributes cdExtraField localExtraField fileComment crc32 compressedSize uncompressedSize writeLocalHeaderRelativeOffset readDataRemaining'
	classVariableNames: ''
	poolDictionaries: 'ZipFileConstants'
	category: 'Compression-Archives'!

!classDefinition: 'ZipArchiveMember class' category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipArchiveMember class
	instanceVariableNames: ''!

!classDefinition: 'ZipArchiveMember class' category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipArchiveMember class
	instanceVariableNames: ''!

!classDefinition: #ZipFileMember category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipArchiveMember subclass: #ZipFileMember
	instanceVariableNames: 'externalFileName stream localHeaderRelativeOffset dataOffset'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-Archives'!

!classDefinition: #ZipFileMember category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipArchiveMember subclass: #ZipFileMember
	instanceVariableNames: 'externalFileName stream localHeaderRelativeOffset dataOffset'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-Archives'!

!classDefinition: 'ZipFileMember class' category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipFileMember class
	instanceVariableNames: ''!

!classDefinition: 'ZipFileMember class' category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipFileMember class
	instanceVariableNames: ''!

!classDefinition: #ZipDirectoryMember category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipFileMember subclass: #ZipDirectoryMember
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-Archives'!

!classDefinition: #ZipDirectoryMember category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipFileMember subclass: #ZipDirectoryMember
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-Archives'!

!classDefinition: 'ZipDirectoryMember class' category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipDirectoryMember class
	instanceVariableNames: ''!

!classDefinition: 'ZipDirectoryMember class' category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipDirectoryMember class
	instanceVariableNames: ''!

!classDefinition: #ZipNewFileMember category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipArchiveMember subclass: #ZipNewFileMember
	instanceVariableNames: 'externalFileName stream'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-Archives'!

!classDefinition: #ZipNewFileMember category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipArchiveMember subclass: #ZipNewFileMember
	instanceVariableNames: 'externalFileName stream'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-Archives'!

!classDefinition: 'ZipNewFileMember class' category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipNewFileMember class
	instanceVariableNames: ''!

!classDefinition: 'ZipNewFileMember class' category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipNewFileMember class
	instanceVariableNames: ''!

!classDefinition: #ZipStringMember category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipArchiveMember subclass: #ZipStringMember
	instanceVariableNames: 'contents stream'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-Archives'!

!classDefinition: #ZipStringMember category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipArchiveMember subclass: #ZipStringMember
	instanceVariableNames: 'contents stream'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Compression-Archives'!

!classDefinition: 'ZipStringMember class' category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipStringMember class
	instanceVariableNames: ''!

!classDefinition: 'ZipStringMember class' category: 'Compression-Archives' stamp: 'ldmaf 6/15/2022 17:07:58'!
ZipStringMember class
	instanceVariableNames: ''!
!InflateStream commentStamp: '<historical>' prior: 0!
This class implements the Inflate decompression algorithm as defined by RFC1951 and used in PKZip, GZip and ZLib (and many, many more). It is a variant of the LZ77 compression algorithm described in

[LZ77] Ziv J., Lempel A., "A Universal Algorithm for Sequential Data Compression", IEEE Transactions on Information Theory", Vol. 23, No. 3, pp. 337-343.

[RFC1951] Deutsch. P, "DEFLATE Compressed Data Format Specification version 1.3"

For more information see the above mentioned RFC 1951 which can for instance be found at

	http://www.leo.org/pub/comp/doc/standards/rfc/index.html

Huffman Tree Implementation Notes:
===========================================
The huffman tree used for decoding literal, distance and length codes in the inflate algorithm has been encoded in a single Array. The tree is made up of subsequent tables storing all entries at the current bit depth. Each entry in the table (e.g., a 32bit Integer value) is either a leaf or a non-leaf node. Leaf nodes store the immediate value in its low 16 bits whereas non-leaf nodes store the offset of the subtable in its low 16bits. The high 8 bits of non-leaf nodes contain the number of additional bits needed for the sub table (the high 8 bits of leaf-nodes are always zero). The first entry in each table is always a non-leaf node indicating how many bits we need to fetch initially. We can thus travel down the tree as follows (written in sort-of-pseudocode the actual implementation can be seen in InflateStream>>decodeValueFrom:):

	table _ initialTable.
	bitsNeeded _ high 8 bits of (table at: 1).		"Determine initial bits"
	table _ initialTable + (low 16 bits of (table at: 1)). "Determine start of first real table"
	[bits _ fetch next bitsNeeded bits.			"Grab the bits"
	value _ table at: bits.						"Lookup the value"
	value has high 8 bit set] whileTrue:[		"Check if it's leaf"
		table _ initialTable + (low 16 bits of value).	"No - compute new sub table start"
		bitsNeeded _ high 8 bit of value].		"Compute additional number of bits needed"
	^value
!
!FastInflateStream commentStamp: '<historical>' prior: 0!
This class adds the following optimizations to the basic Inflate decompression:

a) Bit reversed access
If we want to fetch the bits efficiently then we have them in the wrong bit order (e.g., when we should fetch 2r100 we would get 2r001). But since the huffman tree lookup determines the efficiency of the decompression, reversing the bits before traversal is expensive. Therefore the entries in each table are stored in REVERSE BIT ORDER. This is achieved by a reverse increment of the current table index in the huffman table construction phase (see method increment:bits:). According to my measures this speeds up the implementation by about 30-40%.

b) Inplace storage of code meanings and extra bits
Rather than looking up the meaning for each code during decompression of blocks we store the appropriate values directly in the huffman tables, using a pre-defined mapping. Even though this does not make a big difference in speed, it cleans up the code and allows easier translation into primitive code (which is clearly one goal of this implementation).

c) Precomputed huffman tables for fixed blocks
So we don't have to compute the huffman tables from scratch. The precomputed tables are not in our superclass to avoid double storage (and my superclass is more intended for documentation anyways).!
!ZipReadStream commentStamp: 'nk 3/7/2004 18:54' prior: 0!
ZipReadStream is intended for uncompressing the compressed contents of Zip archive members.

Since Zip archive members keep their expected CRC value separately in Zip headers, this class does not attempt to read the CRC from its input stream.

Instead, if you want the CRC verification to work you have to call #expectedCrc: with the expected CRC-32 value from the Zip member header.!
!GZipSurrogateStream commentStamp: 'jmv 6/17/2015 11:47' prior: 0!
A pseudo stream that allows SmartRefStream to write directly to a gzipped file. There are some peculiarities of the project exporting process that require:

1. We ignore #close since the file is closed and may be reopened to continue writing. We implement #reallyClose for when we know that all writing is over.

2. We use a BitBlt to write WordArrayForSegment objects. Bit of a hack, but there it is.

| fileStream wa |

wa _ WordArrayForSegment new: 30000.
1 to: wa size do: [ :i | wa at: i put: i].
fileStream _ GZipSurrogateStream newFileNamed: 'xxx3.gz' inDirectory: FileDirectory smalltalkImageDirectory.
fileStream nextPutAll: 'this is a test'.
fileStream nextPutAll: wa.
fileStream reallyClose.
!
!ZipEncoderNode commentStamp: '<historical>' prior: 0!
ZipEncoderNode represents a node in a huffman tree for encoding ZipStreams.

Instance variables:
	value 		<Integer>	- Encoded value
	frequency	<Integer>	- Number of occurences of the encoded value
	height 		<Integer>	- Height of the node in the tree
	bitLength 	<Integer>	- bit length of the code
	code		<Integer>	- Assigned code for this node
	parent		<ZipEncoderNode>		- Parent of this node
	left			<ZipEncoderNode>		- First child of this node
	right		<ZipEncoderNode>		- Second child of this node
!
!ZipEncoderTree commentStamp: '<historical>' prior: 0!
ZipEncoderTree represents a huffman tree for encoding ZipStreams.

Instance variables:
	bitLengths	<WordArray>	 - Bit lengths of each generated code
	codes		<WordArray>	 - Codes for each value
	maxCode		<Integer>	- Maximum value with non-zero frequency!
!Archive commentStamp: '<historical>' prior: 0!
This is the abstract superclass for file archives. Archives can be read from or written to files, and contain members that represent files and directories.!
!ZipArchive commentStamp: '<historical>' prior: 0!
A ZipArchive represents an archive that is read and/or written using the PKZIP file format.

ZipArchive instances know how to read and write such archives; their members are subinstances of ZipArchiveMember.!
!ArchiveMember commentStamp: '<historical>' prior: 0!
This is the abstract superclass for archive members, which are files or directories stored in archives.!
!ZipArchiveMember commentStamp: '<historical>' prior: 0!
Subinstances of me are members in a ZipArchive.
They represent different data sources:
	* ZipDirectoryMember -- a directory to be added to a zip file
	* ZipFileMember -- a file or directory that is already in a zip file
	* ZipNewFilemember -- a file that is to be added to a zip file
	* ZipStringMember -- a string that is to be added to a zip file

They can write their data to another stream either copying, compressing,
or decompressing as desired.!
!ZipFileMember commentStamp: '<historical>' prior: 0!
ZipNewFileMember instances are used to represent files that have been read from a ZipArchive.
Their data stays in the file on disk, so the original Zip file cannot be directly overwritten.!
!ZipDirectoryMember commentStamp: '<historical>' prior: 0!
ZipFileMember instances represent directories inside ZipArchives.
They don't do much other than hold names and permissions (and extra fields).

You can add files in subdirectories to a ZipArchive without using any ZipDirectoryMembers.!
!ZipNewFileMember commentStamp: '<historical>' prior: 0!
ZipNewFileMember instances are used to represent files that are going to be written to a ZipArchive.
Their data comes from external file streams.!
!ZipStringMember commentStamp: '<historical>' prior: 0!
ZipStringMember instances are used to represent files that are going to be written to a ZipArchive.
Their data comes from in-image strings, though.!
!ZipEncoderNode methodsFor: 'printing' stamp: 'ar 12/26/1999 10:46' overrides: 16902975!
printOn: aStream
	super printOn: aStream.
	aStream nextPut:$(;
		nextPutAll:'value = '; print: value;
		nextPutAll:', freq = '; print: frequency;
		nextPutAll:', bitLength = '; print: bitLength;
		nextPutAll:', code = '; print: code;
		nextPutAll:', height = '; print: height; 
	nextPut:$).! !
!ArchiveMember methodsFor: 'printing' stamp: 'nk 12/20/2002 15:11' overrides: 16902975!
printOn: aStream
	super printOn: aStream.
	aStream nextPut: $(;
		nextPutAll: self fileName;
		nextPut: $)! !
!GZipConstants class methodsFor: 'pool initialization' stamp: 'ar 5/18/2003 19:00'!
gzipMagic
	^GZipMagic! !
!GZipConstants class methodsFor: 'pool initialization' stamp: 'ar 5/18/2003 19:00' overrides: 16904184!
initialize
	"GZipConstants initialize"
	GZipMagic := 16r8B1F.		"GZIP magic number"
	GZipDeflated := 8.			"Compression method"

	GZipAsciiFlag := 16r01.		"Contents is ASCII"
	GZipContinueFlag := 16r02.	"Part of a multi-part archive"
	GZipExtraField := 16r04.		"Archive has extra fields"
	GZipNameFlag := 16r08.		"Archive has original file name"
	GZipCommentFlag := 16r10.	"Archive has comment"
	GZipEncryptFlag := 16r20.	"Archive is encrypted"
	GZipReservedFlags := 16rC0.	"Reserved" ! !
!ZipConstants class methodsFor: 'pool initialization' stamp: 'ar 5/18/2003 19:09' overrides: 16904184!
initialize
	"ZipConstants initialize"
	self initializeDeflateConstants.
	self initializeWriteStreamConstants.! !
!ZipConstants class methodsFor: 'pool initialization' stamp: 'ar 5/18/2003 19:06'!
initializeDeflateConstants

	WindowSize _ 16r8000.
	WindowMask _ WindowSize - 1.
	MaxDistance _ WindowSize.

	MinMatch _ 3.
	MaxMatch _ 258.

	HashBits _ 15.
	HashMask _ (1 << HashBits) - 1.
	HashShift _ (HashBits + MinMatch - 1) // MinMatch.
! !
!ZipConstants class methodsFor: 'pool initialization' stamp: 'ar 5/18/2003 19:08'!
initializeDistanceCodes
	| dist |
	BaseDistance _ WordArray new: MaxDistCodes.
	DistanceCodes _ WordArray new: 512.
	dist _ 0.
	1 to: 16 do:[:code|
		BaseDistance at: code put: dist.
		1 to: (1 bitShift: (ExtraDistanceBits at: code)) do:[:n|
			dist _ dist + 1.
			DistanceCodes at: dist put: code-1]].
	dist = 256 ifFalse:[self error:'Whoops?!!'].
	dist _ dist >> 7.
	17 to: MaxDistCodes do:[:code|
		BaseDistance at: code put: dist << 7.
		1 to: (1 bitShift: (ExtraDistanceBits at: code)-7) do:[:n|
			dist _ dist + 1.
			DistanceCodes at: 256 + dist put: code-1]].
! !
!ZipConstants class methodsFor: 'pool initialization' stamp: 'ar 5/18/2003 19:07'!
initializeExtraBits
	ExtraLengthBits _ 
		WordArray withAll: #(0 0 0 0 0 0 0 0 1 1 1 1 2 2 2 2 3 3 3 3 4 4 4 4 5 5 5 5 0).
	ExtraDistanceBits _ 
		WordArray withAll: #(0 0 0 0 1 1 2 2 3 3 4 4 5 5 6 6 7 7 8 8 9 9 10 10 11 11 12 12 13 13).
	ExtraBitLengthBits _ 
		WordArray withAll: #(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 2 3 7).
	BitLengthOrder _
		WordArray withAll: #(16 17 18 0 8 7 9 6 10 5 11 4 12 3 13 2 14 1 15).
! !
!ZipConstants class methodsFor: 'pool initialization' stamp: 'ar 5/18/2003 19:08'!
initializeFixedTrees
	"ZipWriteStream initializeFixedTrees"
	| counts nodes |
	FixedLiteralTree _ ZipEncoderTree new.
	FixedLiteralTree maxCode: 287.
	counts _ WordArray new: MaxBits+1.
	counts at: 7+1 put: 24.
	counts at: 8+1 put: 144+8.
	counts at: 9+1 put: 112.
	nodes _ Array new: 288.
	1 to: 288 do:[:i| nodes at: i put: (ZipEncoderNode value: i-1 frequency: 0 height: 0)].
	0 to: 143 do:[:i| (nodes at: i+1) setBitLengthTo: 8].
	144 to: 255 do:[:i| (nodes at: i+1) setBitLengthTo: 9].
	256 to: 279 do:[:i| (nodes at: i+1) setBitLengthTo: 7].
	280 to: 287 do:[:i| (nodes at: i+1) setBitLengthTo: 8].
	FixedLiteralTree buildCodes: nodes counts: counts maxDepth: MaxBits.
	FixedLiteralTree setValuesFrom: nodes.

	FixedDistanceTree _ ZipEncoderTree new.
	FixedDistanceTree maxCode: MaxDistCodes.
	FixedDistanceTree
		bitLengths: ((WordArray new: MaxDistCodes+1) atAllPut: 5)
		codes: ((0 to: MaxDistCodes) collect:[:i| FixedDistanceTree reverseBits: i length: 5]).! !
!ZipConstants class methodsFor: 'pool initialization' stamp: 'ar 5/18/2003 19:07'!
initializeLengthCodes
	| length |
	BaseLength _ WordArray new: MaxLengthCodes.
	MatchLengthCodes _ WordArray new: MaxMatch - MinMatch + 1.
	length _ 0.
	1 to: MaxLengthCodes - 1 do:[:code|
		BaseLength at: code put: length.
		1 to: (1 bitShift: (ExtraLengthBits at: code)) do:[:n|
			length _ length + 1.
			MatchLengthCodes at: length put: NumLiterals + code]].
! !
!ZipConstants class methodsFor: 'pool initialization' stamp: 'ar 5/18/2003 19:09'!
initializeWriteStreamConstants

	MaxBits _ 15.
	MaxBitLengthBits _ 7.
	EndBlock _ 256.

	StoredBlock _ 0.
	FixedBlock _ 1.
	DynamicBlock _ 2.

	NumLiterals _ 256.
	MaxLengthCodes _ 29.
	MaxDistCodes _ 30.
	MaxBitLengthCodes _ 19.
	MaxLiteralCodes _ NumLiterals + MaxLengthCodes + 1. "+ End of Block"

	Repeat3To6 _ 16. "Repeat previous bit length 3-6 times (2 bits repeat count)"
	Repeat3To10 _ 17. "Repeat previous bit length 3-10 times (3 bits repeat count)"
	Repeat11To138 _ 18. "Repeat previous bit length 11-138 times (7 bits repeat count)"

	self initializeExtraBits.
	self initializeLengthCodes.
	self initializeDistanceCodes.
	self initializeFixedTrees.
! !
!ZipFileConstants class methodsFor: 'pool initialization' stamp: 'ar 5/18/2003 19:20' overrides: 16904184!
initialize
	"ZipFileConstants initialize"
	FaMsdos		:= 0.
	FaUnix 		:= 3.
	DeflatingCompressionNormal		:= 0.
	DeflatingCompressionMaximum	:= 2.
	DeflatingCompressionFast		:= 4.
	DeflatingCompressionSuperFast	:= 6.
	CompressionStored				:= 0.
	CompressionDeflated				:= 8.
	CompressionLevelNone			:= 0.
	CompressionLevelDefault			:= 6.
	IfaTextFile						:= 1.
	IfaBinaryFile					:= 0.
	CentralDirectoryFileHeaderSignature	:= 0.
	LocalFileHeaderSignature 			:= 0.
	EndOfCentralDirectorySignature 		:= 0.
	DataDescriptorLength 				:= 12.

	"Unix permission bits"
	DefaultDirectoryPermissions		:= 8r040755.
	DefaultFilePermissions			:= 8r0100666.
	DirectoryAttrib 					:= 8r040000.
	FileAttrib 						:= 8r0100000.

	CentralDirectoryFileHeaderSignature _ 
		(ByteArray with: 16r50 with: 16r4B with: 16r01 with: 16r02) asString.
	LocalFileHeaderSignature _
		(ByteArray with: 16r50 with: 16r4B with: 16r03 with: 16r04) asString.
	EndOfCentralDirectorySignature _
		(ByteArray with: 16r50 with: 16r4B with: 16r05 with: 16r06) asString.! !
!InflateStream methodsFor: 'testing' stamp: 'jmv 3/1/2010 11:28' overrides: 16914201!
atEnd
	"Note: It is possible that we have a few bits left,
	representing just the EOB marker. To check for
	this we must force decompression of the next
	block if at end of data."
	super atEnd ifFalse:[^false]. "Primitive test"
	(position >= readLimit and:[state = StateNoMoreData]) ifTrue:[^true].
	"Force decompression, by calling #next. Since #moveContentsToFront
	will never move data to the beginning of the buffer it is safe to
	skip back the read position afterwards"
	self next
		ifNil: [^ true].
	position _ position - 1.
	^false! !
!InflateStream methodsFor: 'bit access' stamp: 'jmv 3/1/2010 11:28'!
bitPosition
	"Return the current bit position of the source"
	^sourceStream
		ifNil: [sourcePos * 8 + bitPos]
		ifNotNil: [sourceStream position + sourcePos * 8 + bitPos]! !
!InflateStream methodsFor: 'bit access' stamp: 'ar 12/4/1998 02:00'!
nextBits: n
	| bits |
	[bitPos < n] whileTrue:[
		bitBuf _ bitBuf + (self nextByte bitShift: bitPos).
		bitPos _ bitPos + 8].
	bits _ bitBuf bitAnd: (1 bitShift: n)-1.
	bitBuf _ bitBuf bitShift: 0 - n.
	bitPos _ bitPos - n.
	^bits! !
!InflateStream methodsFor: 'bit access' stamp: 'ar 12/5/1998 14:54'!
nextByte
	^source byteAt: (sourcePos _ sourcePos + 1)! !
!InflateStream methodsFor: 'bit access' stamp: 'ar 12/4/1998 02:01'!
nextSingleBits: n
	| out |
	out _ 0.
	1 to: n do:[:i| out _ (out bitShift: 1) + (self nextBits: 1)].
	^out! !
!InflateStream methodsFor: 'accessing' stamp: 'ar 12/23/1999 15:31' overrides: 16945886!
close
	sourceStream ifNotNil:[sourceStream close].! !
!InflateStream methodsFor: 'accessing' stamp: 'jmv 7/12/2016 10:11:19' overrides: 16913831!
contents
	"Use a copy to avoid modifying receiver.
	The copy is shallow, i.e. cheap."
	^ self copy upToEnd! !
!InflateStream methodsFor: 'accessing' stamp: 'ar 12/22/1999 01:29' overrides: 16922435!
next
	"Answer the next decompressed object in the Stream represented by the
	receiver."

	<primitive: 65>
	position >= readLimit
		ifTrue: [^self pastEndRead]
		ifFalse: [^collection at: (position _ position + 1)]! !
!InflateStream methodsFor: 'accessing' stamp: 'nk 3/7/2004 18:45' overrides: 16922442!
next: anInteger 
	"Answer the next anInteger elements of my collection.  overriden for simplicity"
	| newArray |

	"try to do it the fast way"
	position + anInteger < readLimit ifTrue: [
		newArray _ collection copyFrom: position + 1 to: position + anInteger.
		position _ position + anInteger.
		^newArray
	].

	"oh, well..."
	newArray _ collection species new: anInteger.
	1 to: anInteger do: [:index | newArray at: index put: (self next ifNil: [ ^newArray copyFrom: 1 to: index - 1]) ].
	^newArray! !
!InflateStream methodsFor: 'accessing' stamp: 'jmv 3/1/2010 11:29' overrides: 16922453!
next: n into: buffer startingAt: startIndex
	"Read n objects into the given collection. 
	Return aCollection or a partial copy if less than
	n elements have been read."
	| c numRead count |
	numRead _ 0.
	["Force decompression if necessary"
	(c _ self next)
		ifNil: [ ^buffer copyFrom: 1 to: startIndex+numRead-1 ].
	"Store the first value which provoked decompression"
	buffer at: startIndex + numRead put: c.
	numRead _ numRead + 1.
	"After collection has been filled copy as many objects as possible"
	count _ (readLimit - position) min: (n - numRead).
	buffer 
		replaceFrom: startIndex + numRead 
		to: startIndex + numRead + count - 1 
		with: collection 
		startingAt: position+1.
	position _ position + count.
	numRead _ numRead + count.
	numRead = n] whileFalse.
	^buffer! !
!InflateStream methodsFor: 'accessing' stamp: 'ar 12/3/1998 16:19' overrides: 16922493!
size
	"This is a compressed stream - we don't know the size beforehand"
	^self shouldNotImplement! !
!InflateStream methodsFor: 'accessing' stamp: 'ar 12/21/1999 23:54'!
sourceLimit
	^sourceLimit! !
!InflateStream methodsFor: 'accessing' stamp: 'ar 12/21/1999 23:52'!
sourcePosition
	^sourcePos! !
!InflateStream methodsFor: 'accessing' stamp: 'ar 12/23/1999 15:31'!
sourceStream
	^sourceStream! !
!InflateStream methodsFor: 'accessing' stamp: 'ar 12/3/1998 16:19' overrides: 16914102!
upTo: anObject 
	"Answer a subcollection from the current access position to the 
	occurrence (if any, but not inclusive) of anObject in the receiver. If 
	anObject is not in the collection, answer the entire rest of the receiver."
	| newStream element |
	newStream _ WriteStream on: (collection species new: 100).
	[self atEnd or: [(element _ self next) = anObject]]
		whileFalse: [newStream nextPut: element].
	^newStream contents! !
!InflateStream methodsFor: 'accessing' stamp: 'ar 12/22/1999 02:04' overrides: 16922517!
upToEnd
	"Answer a subcollection from the current access position through the last element of the receiver."

	| newStream buffer |
	buffer _ collection species new: 1000.
	newStream _ WriteStream on: (collection species new: 100).
	[self atEnd] whileFalse: [newStream nextPutAll: (self nextInto: buffer)].
	^ newStream contents! !
!InflateStream methodsFor: 'huffman trees' stamp: 'ar 12/21/1999 22:59'!
computeHuffmanValues: aCollection counts: counts from: minBits to: maxBits
	"Assign numerical values to all codes.
	Note: The values are stored according to the bit length"
	| offsets values baseOffset codeLength |
	offsets _ Array new: maxBits.
	offsets atAllPut: 0.
	baseOffset _ 1.
	minBits to: maxBits do:[:bits|
		offsets at: bits put: baseOffset.
		baseOffset _ baseOffset + (counts at: bits+1)].
	values _ WordArray new: aCollection size.
	1 to: aCollection size do:[:i|
		codeLength _ aCollection at: i.
		codeLength > 0 ifTrue:[
			baseOffset _ offsets at: codeLength.
			values at: baseOffset put: i-1.
			offsets at: codeLength put: baseOffset + 1]].
	^values! !
!InflateStream methodsFor: 'huffman trees' stamp: 'sma 5/12/2000 10:49'!
createHuffmanTables: values counts: counts from: minBits to: maxBits
	"Create the actual tables"
	| table tableStart tableSize tableEnd 
	valueIndex tableStack numValues deltaBits maxEntries
	lastTable lastTableStart tableIndex lastTableIndex |

	table _ WordArray new: ((4 bitShift: minBits) max: 16).

	"Create the first entry - this is a dummy.
	It gives us information about how many bits to fetch initially."
	table at: 1 put: (minBits bitShift: 24) + 2. "First actual table starts at index 2"

	"Create the first table from scratch."
	tableStart _ 2. "See above"
	tableSize _ 1 bitShift: minBits.
	tableEnd _ tableStart + tableSize.
	"Store the terminal symbols"
	valueIndex _ (counts at: minBits+1).
	tableIndex _ 0.
	1 to: valueIndex do:[:i|
		table at: tableStart + tableIndex put: (values at: i).
		tableIndex _ self increment: tableIndex bits: minBits].
	"Fill up remaining entries with invalid entries"
	tableStack _ OrderedCollection new: 10. "Should be more than enough"
	tableStack addLast: 
		(Array 
			with: minBits	"Number of bits (e.g., depth) for this table"
			with: tableStart	"Start of table"
			with: tableIndex "Next index in table"
			with: minBits	"Number of delta bits encoded in table"
			with: tableSize - valueIndex "Entries remaining in table").
	"Go to next value index"
	valueIndex _ valueIndex + 1.
	"Walk over remaining bit lengths and create new subtables"
	minBits+1 to: maxBits do:[:bits|
		numValues _ counts at: bits+1.
		[numValues > 0] whileTrue:["Create a new subtable"
			lastTable _ tableStack last.
			lastTableStart _ lastTable at: 2.
			lastTableIndex _ lastTable at: 3.
			deltaBits _ bits - (lastTable at: 1).
			"Make up a table of deltaBits size"
			tableSize _ 1 bitShift: deltaBits.
			tableStart _ tableEnd.
			tableEnd _ tableEnd + tableSize.
			[tableEnd > table size ]
				whileTrue:[table _ self growHuffmanTable: table].
			"Connect to last table"
			self assert:[(table at: lastTableStart + lastTableIndex) = 0]."Entry must be unused"
			table at: lastTableStart + lastTableIndex put: (deltaBits bitShift: 24) + tableStart.
			lastTable at: 3 put: (self increment: lastTableIndex bits: (lastTable at: 4)).
			lastTable at: 5 put: (lastTable at: 5) - 1.
			self assert:[(lastTable at: 5) >= 0]. "Don't exceed tableSize"
			"Store terminal values"
			maxEntries _ numValues min: tableSize.
			tableIndex _ 0.
			1 to: maxEntries do:[:i|
				table at: tableStart + tableIndex put: (values at: valueIndex).
				valueIndex _ valueIndex + 1.
				numValues _ numValues - 1.
				tableIndex _ self increment: tableIndex bits: deltaBits].
			"Check if we have filled up the current table completely"
			maxEntries = tableSize ifTrue:[
				"Table has been filled. Back up to the last table with space left."
				[tableStack isEmpty not and:[(tableStack last at: 5) = 0]]
						whileTrue:[tableStack removeLast].
			] ifFalse:[
				"Table not yet filled. Put it back on the stack."
				tableStack addLast:
					(Array
						with: bits		"Nr. of bits in this table"
						with: tableStart	"Start of table"
						with: tableIndex "Index in table"
						with: deltaBits	"delta bits of table"
						with: tableSize - maxEntries "Unused entries in table").
			].
		].
	].
	 ^table copyFrom: 1 to: tableEnd-1! !
!InflateStream methodsFor: 'huffman trees' stamp: 'ar 12/4/1998 02:25'!
decodeDynamicTable: nItems from: aHuffmanTable
	"Decode the code length of the literal/length and distance table
	in a block compressed with dynamic huffman trees"
	| values index value repCount theValue |
	values _ Array new: nItems.
	index _ 1.
	theValue _ 0.
	[index <= nItems] whileTrue:[
		value _ self decodeValueFrom: aHuffmanTable.
		value < 16 ifTrue:[
			"Immediate values"
			theValue _ value.
			values at: index put: value.
			index _ index+1.
		] ifFalse:[
			"Repeated values"
			value = 16 ifTrue:[
				"Repeat last value"
				repCount _ (self nextBits: 2) + 3.
			] ifFalse:[
				"Repeat zero value"
				theValue _ 0.
				value = 17 
					ifTrue:[repCount _ (self nextBits: 3) + 3]
					ifFalse:[value = 18 
								ifTrue:[repCount _ (self nextBits: 7) + 11]
								ifFalse:[^self error:'Invalid bits tree value']]].
			0 to: repCount-1 do:[:i| values at: index+i put: theValue].
			index _ index + repCount].
	].
	^values! !
!InflateStream methodsFor: 'huffman trees' stamp: 'ar 12/4/1998 01:51'!
distanceMap
	"This is used by the fast decompressor"
	^nil! !
!InflateStream methodsFor: 'huffman trees' stamp: 'ar 12/3/1998 13:16'!
growHuffmanTable: table
	| newTable |
	newTable _ table species new: table size * 2.
	newTable replaceFrom: 1 to: table size with: table startingAt: 1.
	^newTable! !
!InflateStream methodsFor: 'huffman trees' stamp: 'ar 12/4/1998 02:27'!
huffmanTableFrom: aCollection mappedBy: valueMap
	"Create a new huffman table from the given code lengths.
	Map the actual values by valueMap if it is given.
	See the class comment for a documentation of the huffman
	tables used in this decompressor."
	| counts  values table minBits maxBits |
	minBits _ MaxBits + 1.
	maxBits _ 0.
	"Count the occurences of each code length and compute minBits and maxBits"
	counts _ Array new: MaxBits+1.
	counts atAllPut: 0.
	aCollection do:[:length| 
		length > 0 ifTrue:[
			length < minBits ifTrue:[minBits _ length].
			length > maxBits ifTrue:[maxBits _ length].
			counts at: length+1 put: (counts at: length+1)+1]].
	maxBits = 0 ifTrue:[^nil]. "Empty huffman table"

	"Assign numerical values to all codes."
	values _ self computeHuffmanValues: aCollection counts: counts from: minBits to: maxBits.

	"Map the values if requested"
	self mapValues: values by: valueMap.

	"Create the actual tables"
	table _ self createHuffmanTables: values counts: counts from: minBits to: maxBits.

	^table! !
!InflateStream methodsFor: 'huffman trees' stamp: 'ar 12/4/1998 01:48'!
increment: value bits: nBits
	"Increment a value of nBits length.
	The fast decompressor will do this differently"
	^value+1! !
!InflateStream methodsFor: 'huffman trees' stamp: 'ar 12/4/1998 01:50'!
literalLengthMap
	"This is used by the fast decompressor"
	^nil! !
!InflateStream methodsFor: 'huffman trees' stamp: 'jmv 3/2/2010 16:07'!
mapValues: values by: valueMap
	| oldValue |
	valueMap ifNil:[^values].
	1 to: values size do:[:i|
		oldValue _ values at: i.
		"Note: there may be nil values if not all values are used"
		oldValue
			ifNil: [ ^values]
			ifNotNil: [ values at: i put: (valueMap at: oldValue+1)]]! !
!InflateStream methodsFor: 'crc' stamp: 'ar 2/29/2004 04:04'!
crcError: aString
	^CRCError signal: aString! !
!InflateStream methodsFor: 'crc' stamp: 'ar 2/29/2004 03:49'!
updateCrc: oldCrc from: start to: stop in: aCollection
	"Answer an updated CRC for the range of bytes in aCollection.
	Subclasses can implement the appropriate means for the check sum they wish to use."
	^oldCrc! !
!InflateStream methodsFor: 'crc' stamp: 'ar 2/29/2004 04:22'!
verifyCrc
	"Verify the crc checksum in the input"! !
!InflateStream methodsFor: 'inflating' stamp: 'ar 12/4/1998 02:24'!
decodeValueFrom: table
	"Decode the next value in the receiver using the given huffman table."
	| bits bitsNeeded tableIndex value |
	bitsNeeded _ (table at: 1) bitShift: -24.	"Initial bits needed"
	tableIndex _ 2.							"First real table"
	[bits _ self nextSingleBits: bitsNeeded.	"Get bits"
	value _ table at: (tableIndex + bits).		"Lookup entry in table"
	(value bitAnd: 16r3F000000) = 0] 			"Check if it is a non-leaf node"
		whileFalse:["Fetch sub table"
			tableIndex _ value bitAnd: 16rFFFF.	"Table offset in low 16 bit"
			bitsNeeded _ (value bitShift: -24) bitAnd: 255. "Additional bits in high 8 bit"
			bitsNeeded > MaxBits ifTrue:[^self error:'Invalid huffman table entry']].
	^value! !
!InflateStream methodsFor: 'inflating' stamp: 'yo 5/9/2014 15:19'!
decompressBlock: llTable with: dTable
	"Process the compressed data in the block.
	llTable is the huffman table for literal/length codes
	and dTable is the huffman table for distance codes."
	| value extra length distance oldPos oldBits oldBitPos |
	[readLimit < collection size and: [sourcePos <= sourceLimit]] whileTrue: [
		"Back up stuff if we're running out of space"
		oldBits _ bitBuf.
		oldBitPos _ bitPos.
		oldPos _ sourcePos.
		value _ self decodeValueFrom: llTable.
		value < 256 ifTrue:[ "A literal"
			collection byteAt: (readLimit _ readLimit + 1) put: value.
		] ifFalse: ["length/distance or end of block"
			value = 256 ifTrue:["End of block"
				state _ state bitAnd: StateNoMoreData.
				^self].
			"Compute the actual length value (including possible extra bits)"
			extra _ #(0 0 0 0 0 0 0 0 1 1 1 1 2 2 2 2 3 3 3 3 4 4 4 4 5 5 5 5 0) at: value - 256.
			length _ #(3 4 5 6 7 8 9 10 11 13 15 17 19 23 27 31 35 43 51 59 67 83 99 115 131 163 195 227 258) at: value - 256.
			extra > 0 ifTrue:[length _ length + (self nextBits: extra)].
			"Compute the distance value"
			value _ self decodeValueFrom: dTable.
			extra _ #(0 0 0 0 1 1 2 2 3 3 4 4 5 5 6 6 7 7 8 8 9 9 10 10 11 11 12 12 13 13) at: value+1.
			distance _ #(1 2 3 4 5 7 9 13 17 25 33 49 65 97 129 193 257 385 513 769
						1025 1537 2049 3073 4097 6145 8193 12289 16385 24577) at: value+1.
			extra > 0 ifTrue: [distance _ distance + (self nextBits: extra)].
			(readLimit + length >= collection size) ifTrue:[
				bitBuf _ oldBits.
				bitPos _ oldBitPos.
				sourcePos _ oldPos.
				^self].
			collection 
					replaceFrom: readLimit+1 
					to: readLimit + length
					with: collection 
					startingAt: readLimit - distance + 1.
			readLimit _ readLimit + length.
		].
	].! !
!InflateStream methodsFor: 'inflating' stamp: 'ar 12/3/1998 20:49'!
proceedDynamicBlock
	self decompressBlock: litTable with: distTable! !
!InflateStream methodsFor: 'inflating' stamp: 'ar 12/3/1998 20:49'!
proceedFixedBlock
	self decompressBlock: litTable with: distTable! !
!InflateStream methodsFor: 'inflating' stamp: 'jmv 3/1/2010 11:29'!
proceedStoredBlock
	"Proceed decompressing a stored (e.g., uncompressed) block"
	| length decoded |
	"Literal table must be nil for a stored block"
	litTable
		ifNotNil: [^ self error: 'Bad state'].
	length _ distTable.
	[length > 0 and:[readLimit < collection size and:[sourcePos < sourceLimit]]] 
		whileTrue:[
			collection at: (readLimit _ readLimit + 1) put: 
				(source at: (sourcePos _ sourcePos + 1)).
			length _ length - 1].
	length = 0 ifTrue:[state _ state bitAnd: StateNoMoreData].
	decoded _ length - distTable.
	distTable _ length.
	^decoded! !
!InflateStream methodsFor: 'inflating' stamp: 'ar 12/4/1998 01:46'!
processDynamicBlock
	| nLit nDist nLen codeLength lengthTable bits |
	nLit _ (self nextBits: 5) + 257.
	nDist _ (self nextBits: 5) + 1.
	nLen _ (self nextBits: 4) + 4.
	codeLength _ Array new: 19.
	codeLength atAllPut: 0.
	1 to: nLen do:[:i|
		bits _ #(16 17 18 0 8 7 9 6 10 5 11 4 12 3 13 2 14 1 15) at: i.
		codeLength at: bits+1 put: (self nextBits: 3).
	].
	lengthTable _ self huffmanTableFrom: codeLength mappedBy: nil.
	"RFC 1951: In other words, all code lengths form a single sequence..."
	codeLength _ self decodeDynamicTable: nLit+nDist from: lengthTable.
	litTable _ self 
				huffmanTableFrom: (codeLength copyFrom: 1 to: nLit)
				mappedBy: self literalLengthMap.
	distTable _ self 
				huffmanTableFrom: (codeLength copyFrom: nLit+1 to: codeLength size)
				mappedBy: self distanceMap.
	state _ state bitOr: BlockProceedBit.
	self proceedDynamicBlock.! !
!InflateStream methodsFor: 'inflating' stamp: 'ar 12/4/1998 19:13'!
processFixedBlock
	litTable _ self 
				huffmanTableFrom: FixedLitCodes
				mappedBy: self literalLengthMap.
	distTable _ self 
				huffmanTableFrom: FixedDistCodes
				mappedBy: self distanceMap.
	state _ state bitOr: BlockProceedBit.
	self proceedFixedBlock.! !
!InflateStream methodsFor: 'inflating' stamp: 'ar 12/27/1999 13:49'!
processStoredBlock
	| chkSum length |
	"Skip to byte boundary"
	self nextBits: (bitPos bitAnd: 7).
	length _ self nextBits: 16.
	chkSum _ self nextBits: 16.
	(chkSum bitXor: 16rFFFF) = length
		ifFalse:[^self error:'Bad block length'].
	litTable _ nil.
	distTable _ length.
	state _ state bitOr: BlockProceedBit.
	^self proceedStoredBlock! !
!InflateStream methodsFor: 'private' stamp: 'ar 12/4/1998 02:03'!
decompressAll
	"Profile the decompression speed"
	[self atEnd] whileFalse:[
		position _ readLimit.
		self next "Provokes decompression"
	].! !
!InflateStream methodsFor: 'private' stamp: 'jmv 3/1/2010 11:29'!
getFirstBuffer
	"Get the first source buffer after initialization has been done"
	sourceStream
		ifNil: [^ self].
	source _ sourceStream next: 1 << 16. "This is more than enough..."
	sourceLimit _ source size! !
!InflateStream methodsFor: 'private' stamp: 'ar 12/3/1998 17:32'!
getNextBlock
	^self nextBits: 3! !
!InflateStream methodsFor: 'private' stamp: 'ar 12/23/1999 15:17'!
moveContentsToFront
	"Move the decoded contents of the receiver to the front so that we have enough space for decoding more data."
	| delta |
	readLimit > 32768 ifTrue:[
		delta _ readLimit - 32767.
		collection 
			replaceFrom: 1 
			to: collection size - delta + 1 
			with: collection 
			startingAt: delta.
		position _ position - delta + 1.
		readLimit _ readLimit - delta + 1].! !
!InflateStream methodsFor: 'private' stamp: 'ar 12/23/1999 15:27'!
moveSourceToFront
	"Move the encoded contents of the receiver to the front so that we have enough space for decoding more data."
	(sourceStream == nil or:[sourceStream atEnd]) ifTrue:[^self].
	sourcePos > 10000 ifTrue:[
		source 
			replaceFrom: 1 
			to: source size - sourcePos
			with: source 
			startingAt: sourcePos + 1.
		source _ sourceStream 
			next: sourcePos 
			into: source 
			startingAt: source size - sourcePos + 1.
		sourcePos _ 0.
		sourceLimit _ source size].! !
!InflateStream methodsFor: 'private' stamp: 'ar 2/29/2004 04:18'!
pastEndRead
	"A client has attempted to read beyond the read limit.
	Check in what state we currently are and perform
	the appropriate action"
	| blockType bp oldLimit |
	state = StateNoMoreData ifTrue:[^nil]. "Get out early if possible"
	"Check if we can move decoded data to front"
	self moveContentsToFront.
	"Check if we can fetch more source data"
	self moveSourceToFront.
	state = StateNewBlock ifTrue:[state _ self getNextBlock].
	blockType _ state bitShift: -1.
	bp _ self bitPosition.
	oldLimit := readLimit.
	self perform: (BlockTypes at: blockType+1).
	"Note: if bit position hasn't advanced then nothing has been decoded."
	bp = self bitPosition 
		ifTrue:[^self primitiveFailed].
	"Update crc for the decoded contents"
	readLimit > oldLimit 
		ifTrue:[crc _ self updateCrc: crc from: oldLimit+1 to: readLimit in: collection].
	state = StateNoMoreData ifTrue:[self verifyCrc].
	^self next! !
!InflateStream methodsFor: 'private' stamp: 'ar 12/4/1998 02:03'!
profile
	"Profile the decompression speed"
	MessageTally spyOn:[self decompressAll].! !
!InflateStream methodsFor: 'initialization' stamp: 'jmv 1/12/2010 11:51' overrides: 16914565!
on: aCollectionOrStream
	(aCollectionOrStream is: #Stream)
		ifTrue: [	aCollectionOrStream binary.
				sourceStream _ aCollectionOrStream.
				self getFirstBuffer]
		ifFalse: [ source _ aCollectionOrStream].
	^self on: source from: 1 to: source size.! !
!InflateStream methodsFor: 'initialization' stamp: 'ar 12/23/1999 15:35' overrides: 16922523!
on: aCollection from: firstIndex to: lastIndex
	bitBuf _ bitPos _ 0.
	"The decompression buffer has a size of at 64k,
	since we may have distances up to 32k back and
	repetitions of at most 32k length forward"
	collection _ aCollection species new: 1 << 16.
	readLimit _ 0. "Not yet initialized"
	position _ 0.
	source _ aCollection.
	sourceLimit _ lastIndex.
	sourcePos _ firstIndex-1.
	state _ StateNewBlock.! !
!InflateStream methodsFor: 'initialization' stamp: 'ar 12/3/1998 16:32' overrides: 16914327!
reset
	"Position zero - nothing decoded yet"
	position _ readLimit _ 0.
	sourcePos _ 0.
	bitBuf _ bitPos _ 0.
	state _ 0.! !
!InflateStream class methodsFor: 'class initialization' stamp: 'ar 12/4/1998 19:12' overrides: 16904184!
initialize
	"InflateStream initialize"
	MaxBits _ 16.
	StateNewBlock _ 0.
	StateNoMoreData _ 1.
	BlockProceedBit _ 8.
	BlockTypes _ #(	processStoredBlock	"New block in stored format"
					processFixedBlock	"New block with fixed huffman tables"
					processDynamicBlock	"New block with dynamic huffman tables"
					errorBadBlock		"Bad block format"
					proceedStoredBlock	"Continue block in stored format"
					proceedFixedBlock	"Continue block in fixed format"
					proceedDynamicBlock	"Continue block in dynamic format"
					errorBadBlock		"Bad block format").
	"Initialize fixed block values"
	FixedLitCodes _ 	((1 to: 144) collect:[:i| 8]),
					((145 to: 256) collect:[:i| 9]),
					((257 to: 280) collect:[:i| 7]),
					((281 to: 288) collect:[:i| 8]).
	FixedDistCodes _ ((1 to: 32) collect:[:i| 5]).! !
!FastInflateStream methodsFor: 'inflating' stamp: 'yo 5/9/2014 15:19' overrides: 50522552!
decompressBlock: llTable with: dTable
	"Process the compressed data in the block.
	llTable is the huffman table for literal/length codes
	and dTable is the huffman table for distance codes."
	| value extra length distance oldPos oldBits oldBitPos |
	<primitive: 'primitiveInflateDecompressBlock' module: 'ZipPlugin'>
	[readLimit < collection size and:[sourcePos <= sourceLimit]] whileTrue:[
		"Back up stuff if we're running out of space"
		oldBits _ bitBuf.
		oldBitPos _ bitPos.
		oldPos _ sourcePos.
		value _ self decodeValueFrom: llTable.
		value < 256 ifTrue:[ "A literal"
			collection byteAt: (readLimit _ readLimit + 1) put: value.
		] ifFalse: ["length/distance or end of block"
			value = 256 ifTrue:["End of block"
				state _ state bitAnd: StateNoMoreData.
				^self].
			"Compute the actual length value (including possible extra bits)"
			extra _ (value bitShift: -16) - 1.
			length _ value bitAnd: 16rFFFF.
			extra > 0 ifTrue:[length _ length + (self nextBits: extra)].
			"Compute the distance value"
			value _ self decodeValueFrom: dTable.
			extra _ (value bitShift: -16).
			distance _ value bitAnd: 16rFFFF.
			extra > 0 ifTrue: [distance _ distance + (self nextBits: extra)].
			(readLimit + length >= collection size) ifTrue:[
				bitBuf _ oldBits.
				bitPos _ oldBitPos.
				sourcePos _ oldPos.
				^self].
			collection 
					replaceFrom: readLimit+1 
					to: readLimit + length
					with: collection 
					startingAt: readLimit - distance + 1.
			readLimit _ readLimit + length.
		].
	].! !
!FastInflateStream methodsFor: 'inflating' stamp: 'ar 12/4/1998 19:15' overrides: 50522670!
processFixedBlock
	litTable _ FixedLitTable.
	distTable _ FixedDistTable.
	state _ state bitOr: BlockProceedBit.
	self proceedFixedBlock.! !
!FastInflateStream methodsFor: 'huffman trees' stamp: 'ar 12/4/1998 02:26' overrides: 50522440!
distanceMap
	^DistanceMap! !
!FastInflateStream methodsFor: 'huffman trees' stamp: 'ar 12/4/1998 01:48' overrides: 50522488!
increment: value bits: nBits
	"Increment value in reverse bit order, e.g. 
	for a 3 bit value count as follows:
		000 / 100 / 010 / 110
		001 / 101 / 011 / 111
	See the class comment why we need this."
	| result bit |
	result _ value.
	"Test the lowest bit first"
	bit _ 1 << (nBits - 1).
	"If the currently tested bit is set then we need to
	turn this bit off and test the next bit right to it"
	[(result bitAnd: bit) = 0] whileFalse:[ 
		"Turn off current bit"
		result _ result bitXor: bit.
		"And continue testing the next bit"
		bit _ bit bitShift: -1].
	"Turn on the right-most bit that we haven't touched in the loop above"
	^result bitXor: bit! !
!FastInflateStream methodsFor: 'huffman trees' stamp: 'ar 12/4/1998 02:26' overrides: 50522495!
literalLengthMap
	^LiteralLengthMap! !
!FastInflateStream methodsFor: 'bit access' stamp: 'ar 12/4/1998 02:02' overrides: 50522156!
nextSingleBits: n
	"Fetch the bits all at once"
	^self nextBits: n.! !
!FastInflateStream class methodsFor: 'class initialization' stamp: 'ar 12/21/1999 23:00' overrides: 50522819!
initialize
	"FastInflateStream initialize"
	| low high |

	"Init literal/length map"
	low _ #(3 4 5 6 7 8 9 10 11 13 15 17 19 23 27 31 35 43 51 59 67 83 99 115 131 163 195 227 258 ).
	high _ #(0 0 0 0 0 0 0 0 1 1 1 1 2 2 2 2 3 3 3 3 4 4 4 4 5 5 5 5 0 0).
	LiteralLengthMap _ WordArray new: 256 + 32.
	1 to: 257 do:[:i| LiteralLengthMap at: i put: i-1].
	1 to: 29 do:[:i| LiteralLengthMap at: 257+i put: (low at:i) + ( (high at: i) + 1 << 16)].

	"Init distance map"
	high _ #(0 0 0 0 1 1 2 2 3 3 4 4 5 5 6 6 7 7 8 8 9 9 10 10 11 11 12 12 13 13).
	low _ #(1 2 3 4 5 7 9 13 17 25 33 49 65 97 129 193 257 385 513 769
			1025 1537 2049 3073 4097 6145 8193 12289 16385 24577).
	DistanceMap _ WordArray new: 32.
	1 to: 30 do:[:i| DistanceMap at: i put: (low at: i) + ( (high at: i) << 16)].

	"Init fixed block huffman tables"
	FixedLitTable _ self basicNew
				huffmanTableFrom: FixedLitCodes
				mappedBy: LiteralLengthMap.
	FixedDistTable _ self basicNew
				huffmanTableFrom: FixedDistCodes
				mappedBy: DistanceMap.! !
!GZipReadStream methodsFor: 'initialization' stamp: 'ar 2/29/2004 03:32' overrides: 50522795!
on: aCollection from: firstIndex to: lastIndex
	"Check the header of the GZIP stream."
	| method magic flags length |
	super on: aCollection from: firstIndex to: lastIndex.
	crc _ 16rFFFFFFFF.
	magic _ self nextBits: 16.
	(magic = GZipMagic) 
		ifFalse:[^self error:'Not a GZipped stream'].
	method _ self nextBits: 8.
	(method = GZipDeflated)
		ifFalse:[^self error:'Bad compression method'].
	flags _ self nextBits: 8.
	(flags anyMask: GZipEncryptFlag) 
		ifTrue:[^self error:'Cannot decompress encrypted stream'].
	(flags anyMask: GZipReservedFlags)
		ifTrue:[^self error:'Cannot decompress stream with unknown flags'].
	"Ignore stamp, extra flags, OS type"
	self nextBits: 16; nextBits: 16. "stamp"
	self nextBits: 8. "extra flags"
	self nextBits: 8. "OS type"
	(flags anyMask: GZipContinueFlag) "Number of multi-part archive - ignored"
		ifTrue:[self nextBits: 16]. 
	(flags anyMask: GZipExtraField) "Extra fields - ignored"
		ifTrue:[	length _ self nextBits: 16.
				1 to: length do:[:i| self nextBits: 8]].
	(flags anyMask: GZipNameFlag) "Original file name - ignored"
		ifTrue:[[(self nextBits: 8) = 0] whileFalse].
	(flags anyMask: GZipCommentFlag) "Comment - ignored"
		ifTrue:[[(self nextBits: 8) = 0] whileFalse].
! !
!GZipReadStream methodsFor: 'crc' stamp: 'ar 2/29/2004 03:30' overrides: 50522515!
updateCrc: oldCrc from: start to: stop in: aCollection
	"Answer an updated CRC for the range of bytes in aCollection"
	^ZipWriteStream updateCrc: oldCrc from: start to: stop in: aCollection.! !
!GZipReadStream methodsFor: 'crc' stamp: 'ar 2/29/2004 04:20' overrides: 50522524!
verifyCrc
	| stored |
	stored := 0.
	0 to: 24 by: 8 do: [ :i |
		sourcePos >= sourceLimit ifTrue: [ ^ self crcError: 'No checksum (proceed to ignore)' ].
		stored := stored + (self nextByte bitShift: i) ].
	stored := stored bitXor: 16rFFFFFFFF.
	stored = crc ifFalse: [ ^ self crcError: 'Wrong checksum (proceed to ignore)' ].
	^stored! !
!GZipReadStream class methodsFor: 'fileIn/Out' stamp: 'pb 2/26/2020 13:51:16'!
fileReaderServicesForFileEntry: aFileEntry suffix: suffix
	"FileList buttons that are serviced by us."

	^suffix = 'gz'
		ifTrue: [ {self serviceViewDecompress. self serviceDecompressToFile} ]
		ifFalse: [ #() ]! !
!GZipReadStream class methodsFor: 'fileIn/Out' stamp: 'jmv 6/24/2020 16:07:05'!
saveContents: aFileEntry
	"Save the contents of a gzipped file"
	| zipped buffer newFile |
	newFile := aFileEntry parent // aFileEntry baseName.
	newFile writeStreamDo: [ :unzipped |
		unzipped binary.
		aFileEntry readStreamDo: [ :zipContents |
			zipped _ GZipReadStream on: zipContents.
			buffer _ ByteArray new: 50000.
			'Extracting ' , aFileEntry asString
				displayProgressAt: Sensor mousePoint
				from: 0
				to: zipped sourceStream size
				during: [ :barBlock | 
					[ zipped atEnd ]
						whileFalse: [
							barBlock value: zipped sourceStream position.
							unzipped nextPutAll: (zipped nextInto: buffer) ]]]].
	^ newFile ! !
!GZipReadStream class methodsFor: 'fileIn/Out' stamp: 'HAW 1/2/2019 18:36:16'!
serviceDecompressToFile

	^ (SimpleServiceEntry 
		provider: self 
		label: 'decompress to file'
		selector: #saveContents:
		description: 'decompress to file'
		icon: #goTopIcon) triggerFileListChanged! !
!GZipReadStream class methodsFor: 'fileIn/Out' stamp: 'HAW 1/2/2019 18:37:36'!
serviceViewDecompress

	^ SimpleServiceEntry 
		provider: self 
		label: 'view decompressed'
		selector: #viewContents:
		description: 'view decompressed'
		icon: #findIcon! !
!GZipReadStream class methodsFor: 'fileIn/Out' stamp: 'pb 2/26/2020 13:44:18'!
viewContents: aFileEntry
	"Open the decompressed contents of the .gz file with the given name.  This method is only required for the registering-file-list of Squeak 3.3a and beyond, but does no harm in an earlier system"

	(aFileEntry readStream ) ifNotNil: [ :aStream | 
		aStream viewGZipContents]! !
!ZLibReadStream methodsFor: 'initialization' stamp: 'ar 2/29/2004 03:31' overrides: 50522795!
on: aCollection from: firstIndex to: lastIndex
	"Check the header of the ZLib stream."
	| method byte |
	super on: aCollection from: firstIndex to: lastIndex.
	crc _ 1.
	method _ self nextBits: 8.
	(method bitAnd: 15) = 8 ifFalse:[^self error:'Unknown compression method'].
	(method bitShift: -4) + 8 > 15 ifTrue:[^self error:'Invalid window size'].
	byte _ self nextBits: 8.
	(method bitShift: 8) + byte \\ 31 = 0 ifFalse:[^self error:'Incorrect header'].
	(byte anyMask: 32) ifTrue:[^self error:'Need preset dictionary'].
! !
!ZLibReadStream methodsFor: 'crc' stamp: 'ar 2/29/2004 03:30' overrides: 50522515!
updateCrc: oldCrc from: start to: stop in: aCollection
	"Answer an updated CRC for the range of bytes in aCollection"
	^ZLibWriteStream updateAdler32: oldCrc from: start to: stop in: aCollection.! !
!ZLibReadStream methodsFor: 'crc' stamp: 'ar 2/29/2004 04:21' overrides: 50522524!
verifyCrc
	| stored |
	stored := 0.
	24 to: 0 by: -8 do: [ :i |
		sourcePos >= sourceLimit ifTrue: [ ^ self crcError: 'No checksum (proceed to ignore)' ].
		stored := stored + (self nextByte bitShift: i) ].
	stored = crc ifFalse: [ ^ self crcError: 'Wrong checksum (proceed to ignore)' ].
	^stored! !
!ZipReadStream methodsFor: 'crc' stamp: 'nk 3/7/2004 18:55'!
expectedCrc: aNumberOrNil
	"If expectedCrc is set, it will be compared against the calculated CRC32 in verifyCrc.
	This number should be the number read from the Zip header (which is the bitwise complement of my crc if all is working correctly)"
	expectedCrc _ aNumberOrNil! !
!ZipReadStream methodsFor: 'crc' stamp: 'nk 3/7/2004 15:32' overrides: 50522515!
updateCrc: oldCrc from: start to: stop in: aCollection
	^ZipWriteStream updateCrc: oldCrc from: start to: stop in: aCollection! !
!ZipReadStream methodsFor: 'crc' stamp: 'jmv 2/22/2011 22:55' overrides: 50522524!
verifyCrc
	"Verify the CRC-32 checksum calculated from the input against the expected CRC-32, if any.
	Answer the calculated CRC-32 in any case.
	Note that the CRC-32 used in Zip files is actually the bit inverse of the calculated value, so that is what is returned."

	| invertedCrc |
	invertedCrc _ crc bitXor: 16rFFFFFFFF.
	(expectedCrc notNil and: [ expectedCrc ~= invertedCrc ])
		ifTrue: [ ^ self crcError: ('Wrong CRC-32 (expected {1} got {2}) (proceed to ignore)' format: { expectedCrc hex. invertedCrc hex }) ].
	^invertedCrc! !
!ZipReadStream methodsFor: 'initialization' stamp: 'nk 3/7/2004 15:31' overrides: 50522795!
on: aCollection from: firstIndex to: lastIndex
	super on: aCollection from: firstIndex to: lastIndex.
	crc _ 16rFFFFFFFF.
	expectedCrc _ nil.! !
!DeflateStream methodsFor: 'deflating' stamp: 'ar 12/29/1999 20:24'!
compare: here with: matchPos min: minLength
	"Compare the two strings and return the length of matching characters.
	minLength is a lower bound for match lengths that will be accepted.
	Note: here and matchPos are zero based."
	| length |
	"First test if we can actually get longer than minLength"
	(collection at: here+minLength+1) = (collection at: matchPos+minLength+1)
		ifFalse:[^0].
	(collection at: here+minLength) = (collection at: matchPos+minLength)
		ifFalse:[^0].
	"Then test if we have an initial match at all"
	(collection at: here+1) = (collection at: matchPos+1)
		ifFalse:[^0].
	(collection at: here+2) = (collection at: matchPos+2)
		ifFalse:[^1].
	"Finally do the real comparison"
	length _ 3.
	[length <= MaxMatch and:[
		(collection at: here+length) = (collection at: matchPos+length)]]
			whileTrue:[length _ length + 1].
	^length - 1! !
!DeflateStream methodsFor: 'deflating' stamp: 'jmv 3/1/2010 09:56'!
deflateBlock
	"Deflate the current contents of the stream"
	| flushNeeded lastIndex |
	blockStart ifNil: [
		"One time initialization for the first block"
		1 to: MinMatch-1 do:[:i| self updateHashAt: i].
		blockStart _ 0].

	[blockPosition < position] whileTrue:[
		(position + MaxMatch > writeLimit)
			ifTrue:[lastIndex _ writeLimit - MaxMatch]
			ifFalse:[lastIndex _ position].
		flushNeeded _ self deflateBlock: lastIndex-1
							chainLength: self hashChainLength
							goodMatch: self goodMatchLength.
		flushNeeded ifTrue:[
			self flushBlock.
			blockStart _ blockPosition].
		"Make room for more data"
		self moveContentsToFront].
! !
!DeflateStream methodsFor: 'deflating' stamp: 'ar 12/29/1999 18:05'!
deflateBlock: lastIndex chainLength: chainLength goodMatch: goodMatch
	"Continue deflating the receiver's collection from blockPosition to lastIndex.
	Note that lastIndex must be at least MaxMatch away from the end of collection"
	| here matchResult flushNeeded hereMatch hereLength newMatch newLength hasMatch |
	blockPosition > lastIndex ifTrue:[^false]. "Nothing to deflate"
	hasMatch _ false.
	here _ blockPosition.
	[here <= lastIndex] whileTrue:[
		hasMatch ifFalse:[
			"Find the first match"
			matchResult _ self findMatch: here
								lastLength: MinMatch-1
								lastMatch: here
								chainLength: chainLength
								goodMatch: goodMatch.
			self insertStringAt: here. "update hash table"
			hereMatch _ matchResult bitAnd: 16rFFFF.
			hereLength _ matchResult bitShift: -16].

		"Look ahead if there is a better match at the next position"
		matchResult _ self findMatch: here+1
							lastLength: hereLength
							lastMatch: hereMatch
							chainLength: chainLength
							goodMatch: goodMatch.
		newMatch _ matchResult bitAnd: 16rFFFF.
		newLength _ matchResult bitShift: -16.

		"Now check if the next match is better than the current one.
		If not, output the current match (provided that the current match
		is at least MinMatch long)"
		(hereLength >= newLength and:[hereLength >= MinMatch]) ifTrue:[
			self assert:[self validateMatchAt: here
							from: hereMatch to: hereMatch + hereLength - 1].
			"Encode the current match"
			flushNeeded _ self
				encodeMatch: hereLength
				distance: here - hereMatch.
			"Insert all strings up to the end of the current match.
			Note: The first string has already been inserted."
			1 to: hereLength-1 do:[:i| self insertStringAt: (here _ here + 1)].
			hasMatch _ false.
			here _ here + 1.
		] ifFalse:[
			"Either the next match is better than the current one or we didn't
			have a good match after all (e.g., current match length < MinMatch).
			Output a single literal."
			flushNeeded _ self encodeLiteral: (collection byteAt: (here + 1)).
			here _ here + 1.
			(here <= lastIndex and:[flushNeeded not]) ifTrue:[
				"Cache the results for the next round"
				self insertStringAt: here.
				hasMatch _ true.
				hereMatch _ newMatch.
				hereLength _ newLength].
		].
		flushNeeded ifTrue:[blockPosition _ here. ^true].
	].
	blockPosition _ here.
	^false! !
!DeflateStream methodsFor: 'deflating' stamp: 'ar 12/29/1999 17:45'!
findMatch: here lastLength: lastLength lastMatch: lastMatch chainLength: maxChainLength goodMatch: goodMatch
	"Find the longest match for the string starting at here.
	If there is no match longer than lastLength return lastMatch/lastLength.
	Traverse at most maxChainLength entries in the hash table.
	Stop if a match of at least goodMatch size has been found."
	| matchResult matchPos distance chainLength limit bestLength length |
	"Compute the default match result"
	matchResult _ (lastLength bitShift: 16) bitOr: lastMatch.

	"There is no way to find a better match than MaxMatch"
	lastLength >= MaxMatch ifTrue:[^matchResult].

	"Start position for searches"
	matchPos _ hashHead at: (self updateHashAt: here + MinMatch) + 1.

	"Compute the distance to the (possible) match"
	distance _ here - matchPos.

	"Note: It is required that 0 < distance < MaxDistance"
	(distance > 0 and:[distance < MaxDistance]) ifFalse:[^matchResult].

	chainLength _ maxChainLength.	"Max. nr of match chain to search"
	here > MaxDistance	"Limit for matches that are too old"
		ifTrue:[limit _ here - MaxDistance]
		ifFalse:[limit _ 0].

	"Best match length so far (current match must be larger to take effect)"
	bestLength _ lastLength.

	["Compare the current string with the string at match position"
	length _ self compare: here with: matchPos min: bestLength.
	"Truncate accidental matches beyound stream position"
	(here + length > position) ifTrue:[length _ position - here].
	"Ignore very small matches if they are too far away"
	(length = MinMatch and:[(here - matchPos) > (MaxDistance // 4)])
		ifTrue:[length _ MinMatch - 1].
	length > bestLength ifTrue:["We have a new (better) match than before"
		"Compute the new match result"
		matchResult _ (length bitShift: 16) bitOr: matchPos.
		bestLength _ length.
		"There is no way to find a better match than MaxMatch"
		bestLength >= MaxMatch ifTrue:[^matchResult].
		"But we may have a good, fast match"
		bestLength > goodMatch ifTrue:[^matchResult].
	].
	(chainLength _ chainLength - 1) > 0] whileTrue:[
		"Compare with previous entry in hash chain"
		matchPos _ hashTail at: (matchPos bitAnd: WindowMask) + 1.
		matchPos <= limit ifTrue:[^matchResult]. "Match position is too old"
	].
	^matchResult! !
!DeflateStream methodsFor: 'deflating' stamp: 'ar 12/28/1999 17:37'!
flushBlock
	"Flush a deflated block"! !
!DeflateStream methodsFor: 'deflating' stamp: 'ar 12/29/1999 17:46'!
insertStringAt: here
	"Insert the string at the given start position into the hash table.
	Note: The hash value is updated starting at MinMatch-1 since
	all strings before have already been inserted into the hash table
	(and the hash value is updated as well)."
	| prevEntry |
	hashValue _ self updateHashAt: (here + MinMatch).
	prevEntry _ hashHead at: hashValue+1.
	hashHead at: hashValue+1 put: here.
	hashTail at: (here bitAnd: WindowMask)+1 put: prevEntry.! !
!DeflateStream methodsFor: 'deflating' stamp: 'ar 12/29/1999 17:48'!
updateHash: nextValue
	"Update the running hash value based on the next input byte.
	Return the new updated hash value."
	^((hashValue bitShift: HashShift) bitXor: nextValue) bitAnd: HashMask.! !
!DeflateStream methodsFor: 'deflating' stamp: 'ar 12/29/1999 17:47'!
updateHashAt: here
	"Update the hash value at position here (one based)"
	^self updateHash: (collection byteAt: here)! !
!DeflateStream methodsFor: 'deflating' stamp: 'ar 12/28/1999 17:43'!
validateMatchAt: pos from: startPos to: endPos
	| here |
	here _ pos.
	startPos+1 to: endPos+1 do:[:i|
		(collection at: i) = (collection at: (here _ here + 1))
			ifFalse:[^self error:'Not a match']].
	^true! !
!DeflateStream methodsFor: 'encoding' stamp: 'ar 12/29/1999 18:04'!
encodeLiteral: literal
	"Encode the given literal.
	Return true if the current block needs to be flushed."
	^false! !
!DeflateStream methodsFor: 'encoding' stamp: 'ar 12/29/1999 18:04'!
encodeMatch: matchLength distance: matchDistance
	"Encode a match of the given length and distance.
	Return true if the current block should be flushed."
	^false! !
!DeflateStream methodsFor: 'initialization' stamp: 'ar 12/29/1999 17:30' overrides: 16945731!
flush
	"Force compression"
	self deflateBlock.! !
!DeflateStream methodsFor: 'initialization' stamp: 'ar 12/31/1999 18:00' overrides: 16920235!
initialize
	blockStart _ nil.
	blockPosition _ 0.
	hashValue _ 0.
	self initializeHashTables.! !
!DeflateStream methodsFor: 'initialization' stamp: 'ar 12/29/1999 17:32'!
initializeHashTables
	hashHead _ WordArray new: 1 << HashBits.
	hashTail _ WordArray new: WindowSize.
! !
!DeflateStream methodsFor: 'initialization' stamp: 'ar 12/29/1999 17:33' overrides: 16983259!
on: aCollection
	self initialize.
	super on: (aCollection species new: WindowSize * 2).! !
!DeflateStream methodsFor: 'initialization' stamp: 'ar 12/28/1999 17:34' overrides: 16983265!
on: aCollection from: firstIndex to: lastIndex
	"Not for DeflateStreams please"
	^self shouldNotImplement! !
!DeflateStream methodsFor: 'accessing' stamp: 'ar 12/29/1999 20:00'!
goodMatchLength
	"Return the length that is considered to be a 'good' match.
	Higher values will result in better compression but take more time."
	^MaxMatch "Best compression"! !
!DeflateStream methodsFor: 'accessing' stamp: 'ar 12/29/1999 20:00'!
hashChainLength
	"Return the max. number of hash chains to traverse.
	Higher values will result in better compression but take more time."
	^4096 "Best compression"! !
!DeflateStream methodsFor: 'accessing' stamp: 'ar 2/19/2004 00:34' overrides: 16982981!
next: bytes putAll: aCollection startingAt: startPos
	(startPos = 1 and:[bytes = aCollection size]) 
		ifTrue:[^self nextPutAll: aCollection].
	^self nextPutAll: (aCollection copyFrom: startPos to: startPos + bytes - 1)! !
!DeflateStream methodsFor: 'accessing' stamp: 'ar 12/29/1999 17:33' overrides: 16983010!
nextPutAll: aCollection
	| start count max |
	aCollection species = collection species
		ifFalse:[
			aCollection do:[:ch| self nextPut: ch].
			^aCollection].
	start _ 1.
	count _ aCollection size.
	[count = 0] whileFalse:[
		position = writeLimit ifTrue:[self deflateBlock].
		max _ writeLimit - position.
		max > count ifTrue:[max _ count].
		collection replaceFrom: position+1
			to: position+max
			with: aCollection
			startingAt: start.
		start _ start + max.
		count _ count - max.
		position _ position + max].
	^aCollection! !
!DeflateStream methodsFor: 'accessing' stamp: 'ar 12/28/1999 17:35' overrides: 16983276!
pastEndPut: anObject
	self deflateBlock.
	^self nextPut: anObject! !
!DeflateStream methodsFor: 'private' stamp: 'ar 12/29/1999 17:50'!
moveContentsToFront
	"Move the contents of the receiver to the front"
	| delta |
	delta _ (blockPosition - WindowSize).
	delta <= 0 ifTrue:[^self].
	"Move collection"
	collection 
		replaceFrom: 1 
		to: collection size - delta 
		with: collection 
		startingAt: delta+1.
	position _ position - delta.
	"Move hash table entries"
	blockPosition _ blockPosition - delta.
	blockStart _ blockStart - delta.
	self updateHashTable: hashHead delta: delta.
	self updateHashTable: hashTail delta: delta.! !
!DeflateStream methodsFor: 'private' stamp: 'ar 2/2/2001 15:47'!
updateHashTable: table delta: delta
	| pos |
	<primitive: 'primitiveDeflateUpdateHashTable' module: 'ZipPlugin'>
	1 to: table size do:[:i|
		"Discard entries that are out of range"
		(pos _ table at: i) >= delta
			ifTrue:[table at: i put: pos - delta]
			ifFalse:[table at: i put: 0]].! !
!ZipWriteStream methodsFor: 'initialization' stamp: 'ar 2/28/2001 13:39' overrides: 16945886!
close
	self deflateBlock.
	self flushBlock: true.
	encoder close.! !
!ZipWriteStream methodsFor: 'initialization' stamp: 'ar 2/27/2001 13:23'!
finish
	"Finish pending operation. Do not close output stream."
	self deflateBlock.
	self flushBlock: true.
	encoder flush.! !
!ZipWriteStream methodsFor: 'initialization' stamp: 'ar 12/30/1999 00:40' overrides: 50523462!
initialize
	super initialize.
	literals _ ByteArray new: WindowSize.
	distances _ WordArray new: WindowSize.
	literalFreq _ WordArray new: MaxLiteralCodes.
	distanceFreq _ WordArray new: MaxDistCodes.
	self initializeNewBlock.
! !
!ZipWriteStream methodsFor: 'initialization' stamp: 'ar 12/29/1999 18:29'!
initializeNewBlock
	"Initialize the encoder for a new block of data"
	literalFreq atAllPut: 0.
	distanceFreq atAllPut: 0.
	literalFreq at: EndBlock+1 put: 1.
	litCount _ 0.
	matchCount _ 0.! !
!ZipWriteStream methodsFor: 'initialization' stamp: 'ar 2/24/2001 19:43' overrides: 50523475!
on: aCollectionOrStream
	crc _ 16rFFFFFFFF.
	crcPosition _ 1.
	bytesWritten _ 0.
	encoder _ ZipEncoder on: aCollectionOrStream.
	encoder isBinary
		ifTrue:[super on: ByteArray new]
		ifFalse:[super on: String new].
	self writeHeader.
! !
!ZipWriteStream methodsFor: 'initialization' stamp: 'nk 2/17/2004 16:31'!
release
	"We're done with compression. Do some cleanup."
	literals _ distances _ literalFreq _ distanceFreq _ nil.
	self updateCrc.
	encoder flushBits.
	self writeFooter.! !
!ZipWriteStream methodsFor: 'initialization' stamp: 'nk 2/17/2004 16:30'!
writeFooter
	"Write footer information if necessary"
	crc _ crc bitXor: 16rFFFFFFFF.! !
!ZipWriteStream methodsFor: 'initialization' stamp: 'ar 2/24/2001 19:44'!
writeHeader
	"Write header information if necessary"! !
!ZipWriteStream methodsFor: 'accessing' stamp: 'ar 2/24/2001 19:46'!
crc
	^crc! !
!ZipWriteStream methodsFor: 'accessing' stamp: 'ar 12/30/1999 00:37'!
encodedStream
	^encoder encodedStream! !
!ZipWriteStream methodsFor: 'accessing' stamp: 'ar 12/29/1999 18:32'!
forcedMethod
	"Return a symbol describing an enforced method or nil if the method should
	be chosen adaptively. Valid symbols are
		#stored	- store blocks (do not compress)
		#fixed	- use fixed huffman trees
		#dynamic	- use dynamic huffman trees."
	^nil! !
!ZipWriteStream methodsFor: 'deflating' stamp: 'ar 2/2/2001 15:47' overrides: 50523248!
deflateBlock: lastIndex chainLength: chainLength goodMatch: goodMatch
	"^DeflatePlugin doPrimitive:#primitiveDeflateBlock"
	<primitive: 'primitiveDeflateBlock' module: 'ZipPlugin'>
	^super deflateBlock: lastIndex chainLength: chainLength goodMatch: goodMatch! !
!ZipWriteStream methodsFor: 'dynamic blocks' stamp: 'ar 12/30/1999 01:55'!
dynamicBlockSizeFor: lTree and: dTree using: blTree and: blFreq
	"Compute the length for the current block using dynamic huffman trees"
	| bits index extra treeBits freq |
	bits _ 3 "block type" + 5 "literal codes length" + 5 "distance codes length".

	"Compute the # of bits for sending the bit length tree"
	treeBits _ 4. "Max index for bit length tree"
	index _ MaxBitLengthCodes.
	[index >= 4] whileTrue:[
		(index = 4 or:[(blFreq at: (BitLengthOrder at: index)+1) > 0])
			ifTrue:[treeBits _ treeBits + (index * 3).
					index _ -1]
			ifFalse:[index _ index - 1]].

	"Compute the # of bits for sending the literal/distance tree.
	Note: The frequency are already stored in the blTree"
	0 to: 15 do:[:i| "First, the non-repeating values"
		freq _ blFreq at: i+1.
		freq > 0 ifTrue:[treeBits _ treeBits + (freq * (blTree bitLengthAt: i))]].
	"Now the repeating values"
	(Repeat3To6 to: Repeat11To138) with: #(2 3 7) do:[:i :addl|
		freq _ blFreq at: i+1.
		freq > 0 ifTrue:[
			treeBits _ treeBits + (freq * ((blTree bitLengthAt: i) + addl "addl bits"))]].
	VerboseLevel > 1 ifTrue:[
		Transcript show:'['; print: treeBits; show:' bits for dynamic tree]'].
	bits _ bits + treeBits.

	"Compute the size of the compressed block"
	0 to: NumLiterals do:[:i| "encoding of literals"
		freq _ literalFreq at: i+1.
		freq > 0 ifTrue:[bits _ bits + (freq * (lTree bitLengthAt: i))]].
	NumLiterals+1 to: lTree maxCode do:[:i| "encoding of match lengths"
		freq _ literalFreq at: i+1.
		extra _ ExtraLengthBits at: i-NumLiterals.
		freq > 0 ifTrue:[bits _ bits + (freq * ((lTree bitLengthAt: i) + extra))]].
	0 to: dTree maxCode do:[:i| "encoding of distances"
		freq _ distanceFreq at: i+1.
		extra _ ExtraDistanceBits at: i+1.
		freq > 0 ifTrue:[bits _ bits + (freq * ((dTree bitLengthAt: i) + extra))]].

	^bits! !
!ZipWriteStream methodsFor: 'dynamic blocks' stamp: 'ar 12/30/1999 11:55'!
scanBitLength: bitLength repeatCount: repeatCount into: anArray
	"Update the frequency for the aTree based on the given values"
	| count |
	count _ repeatCount.
	bitLength = 0 ifTrue:[
		[count >= 11] whileTrue:[
			anArray at: Repeat11To138+1 put: (anArray at: Repeat11To138+1) + 1.
			count _ (count - 138) max: 0].
		[count >= 3] whileTrue:[
			anArray at: Repeat3To10+1 put: (anArray at: Repeat3To10+1) + 1.
			count _ (count - 10) max: 0].
		count > 0 ifTrue:[anArray at: bitLength+1 put: (anArray at: bitLength+1) + count].
	] ifFalse:[
		anArray at: bitLength+1 put: (anArray at: bitLength+1) + 1.
		count _ count - 1.
		[count >= 3] whileTrue:[
			anArray at: Repeat3To6+1 put: (anArray at: Repeat3To6+1) + 1.
			count _ (count - 6) max: 0].
		count > 0 ifTrue:[anArray at: bitLength+1 put: (anArray at: bitLength+1) + count].
	].! !
!ZipWriteStream methodsFor: 'dynamic blocks' stamp: 'ar 12/30/1999 11:55'!
scanBitLengths: bits into: anArray
	"Scan the trees and determine the frequency of the bit lengths.
	For repeating codes, emit a repeat count."
	| lastValue lastCount value |
	bits size = 0 ifTrue:[^self].
	lastValue _ bits at: 1.
	lastCount _ 1.
	2 to: bits size do:[:i|
		value _ bits at: i.
		value = lastValue 
			ifTrue:[lastCount _ lastCount + 1]
			ifFalse:[self scanBitLength: lastValue repeatCount: lastCount into: anArray.
					lastValue _ value.
					lastCount _ 1]].
	self scanBitLength: lastValue repeatCount: lastCount into: anArray.! !
!ZipWriteStream methodsFor: 'dynamic blocks' stamp: 'ar 12/30/1999 11:40'!
sendBitLength: bitLength repeatCount: repeatCount tree: aTree
	"Send the given bitLength, repeating repeatCount times"
	| count |
	count _ repeatCount.
	bitLength = 0 ifTrue:[
		[count >= 11] whileTrue:[
			self sendBitLength: Repeat11To138 tree: aTree.
			encoder nextBits: 7 put: (count min: 138) - 11.
			count _ (count - 138) max: 0].
		[count >= 3] whileTrue:[
			self sendBitLength: Repeat3To10 tree: aTree.
			encoder nextBits: 3 put: (count min: 10) - 3.
			count _ (count - 10) max: 0].
		count timesRepeat:[self sendBitLength: bitLength tree: aTree].
	] ifFalse:[
		self sendBitLength: bitLength tree: aTree.
		count _ count - 1.
		[count >= 3] whileTrue:[
			self sendBitLength: Repeat3To6 tree: aTree.
			encoder nextBits: 2 put: (count min: 6) - 3.
			count _ (count - 6) max: 0].
		count timesRepeat:[self sendBitLength: bitLength tree: aTree].
	].! !
!ZipWriteStream methodsFor: 'dynamic blocks' stamp: 'ar 12/30/1999 11:40'!
sendBitLength: bitLength tree: aTree
	"Send the given bitLength"
	encoder nextBits: (aTree bitLengthAt: bitLength) 
		put: (aTree codeAt: bitLength).! !
!ZipWriteStream methodsFor: 'dynamic blocks' stamp: 'ar 12/30/1999 11:40'!
sendBitLengthTree: blTree
	"Send the bit length tree"
	| blIndex bitLength |
	MaxBitLengthCodes to: 4 by: -1 do:[:maxIndex|
		blIndex _ BitLengthOrder at: maxIndex.
		bitLength _ blIndex <= blTree maxCode 
			ifTrue:[blTree bitLengthAt: blIndex] ifFalse:[0].
		(maxIndex = 4 or:[bitLength > 0]) ifTrue:[
			encoder nextBits: 4 put: maxIndex - 4.
			1 to: maxIndex do:[:j|
				blIndex _ BitLengthOrder at: j.
				bitLength _ blIndex <= blTree maxCode 
					ifTrue:[blTree bitLengthAt: blIndex] ifFalse:[0].
				encoder nextBits: 3 put: bitLength].
			^self]].! !
!ZipWriteStream methodsFor: 'dynamic blocks' stamp: 'ar 12/30/1999 00:48'!
sendCompressedBlock: litTree with: distTree
	"Send the current block using the encodings from the given literal/length and distance tree"
	| sum |
	sum _ encoder
			sendBlock: (ReadStream on: literals from: 1 to: litCount)
			with: (ReadStream on: distances from: 1 to: litCount)
			with: litTree
			with: distTree.
	sum = (blockPosition - blockStart) ifFalse:[self error:'Wrong number of bytes'].! !
!ZipWriteStream methodsFor: 'dynamic blocks' stamp: 'ar 12/29/1999 18:19'!
sendDynamicBlock: blTree literalTree: lTree distanceTree: dTree bitLengths: bits
	"Send a block using dynamic huffman trees"
	self sendLiteralTree: lTree distanceTree: dTree using: blTree bitLengths: bits.
	self sendCompressedBlock: lTree with: dTree.! !
!ZipWriteStream methodsFor: 'dynamic blocks' stamp: 'ar 12/30/1999 11:40'!
sendLiteralTree: lTree distanceTree: dTree using: blTree bitLengths: bits
	"Send all the trees needed for dynamic huffman tree encoding"
	| lastValue lastCount value |
	encoder nextBits: 5 put: (lTree maxCode - 256).
	encoder nextBits: 5 put: (dTree maxCode).
	self sendBitLengthTree: blTree.
	bits size = 0 ifTrue:[^self].
	lastValue _ bits at: 1.
	lastCount _ 1.
	2 to: bits size do:[:i|
		value _ bits at: i.
		value = lastValue 
			ifTrue:[lastCount _ lastCount + 1]
			ifFalse:[self sendBitLength: lastValue repeatCount: lastCount tree: blTree.
					lastValue _ value.
					lastCount _ 1]].
	self sendBitLength: lastValue repeatCount: lastCount tree: blTree.! !
!ZipWriteStream methodsFor: 'encoding' stamp: 'ar 12/29/1999 18:05' overrides: 50523442!
encodeLiteral: lit
	"Encode the given literal"
	litCount _ litCount + 1.
	literals at: litCount put: lit.
	distances at: litCount put: 0.
	literalFreq at: lit+1 put: (literalFreq at: lit+1) + 1.
	^self shouldFlush! !
!ZipWriteStream methodsFor: 'encoding' stamp: 'ar 12/29/1999 18:05' overrides: 50523448!
encodeMatch: length distance: dist
	"Encode the given match of length length starting at dist bytes ahead"
	| literal distance |
	dist > 0 
		ifFalse:[^self error:'Distance must be positive'].
	length < MinMatch 
		ifTrue:[^self error:'Match length must be at least ', MinMatch printString].
	litCount _ litCount + 1.
	matchCount _ matchCount + 1.
	literals at: litCount put: length - MinMatch.
	distances at: litCount put: dist.
	literal _ (MatchLengthCodes at: length - MinMatch + 1).
	literalFreq at: literal+1 put: (literalFreq at: literal+1) + 1.
	dist < 257
		ifTrue:[distance _ DistanceCodes at: dist]
		ifFalse:[distance _ DistanceCodes at: 257 + (dist - 1 bitShift: -7)].
	distanceFreq at: distance+1 put: (distanceFreq at: distance+1) + 1.
	^self shouldFlush! !
!ZipWriteStream methodsFor: 'encoding' stamp: 'ar 12/29/1999 18:08' overrides: 50523397!
flushBlock
	^self flushBlock: false! !
!ZipWriteStream methodsFor: 'encoding' stamp: 'jmv 3/13/2012 12:58'!
flushBlock: lastBlock
	"Send the current block"
	| lastFlag bitsRequired method bitsSent
	storedLength fixedLength dynamicLength 
	blTree lTree dTree blBits blFreq |

	lastFlag _ lastBlock ifTrue:[1] ifFalse:[0].

	"Compute the literal/length and distance tree"
	lTree _ ZipEncoderTree buildTreeFrom: literalFreq maxDepth: MaxBits.
	dTree _ ZipEncoderTree buildTreeFrom: distanceFreq maxDepth: MaxBits.

	"Compute the bit length tree"
	blBits _ lTree bitLengths, dTree bitLengths.
	blFreq _ WordArray new: MaxBitLengthCodes.
	self scanBitLengths: blBits into: blFreq.
	blTree _ ZipEncoderTree buildTreeFrom: blFreq maxDepth: MaxBitLengthBits.

	"Compute the bit length for the current block.
	Note: Most of this could be computed on the fly but it's getting
	really ugly in this case so we do it afterwards."
	storedLength _ self storedBlockSize.
	fixedLength _ self fixedBlockSizeFor: lTree and: dTree.
	dynamicLength _ self dynamicBlockSizeFor: lTree and: dTree 
							using: blTree and: blFreq.
	VerboseLevel > 1 ifTrue:[
		Transcript newLine; show:'Block sizes (S/F/D):';
			space; print: storedLength // 8; 
			nextPut:$/; print: fixedLength // 8; 
			nextPut:$/; print: dynamicLength // 8; space; endEntry].

	"Check which method to use"
	method _ self forcedMethod.
	method ifNil: [ 
		method _ (storedLength < fixedLength and:[storedLength < dynamicLength]) 
			ifTrue:[#stored]
			ifFalse:[fixedLength < dynamicLength ifTrue:[#fixed] ifFalse:[#dynamic]]].
	(method == #stored and:[blockStart < 0]) ifTrue:[
		"Cannot use #stored if the block is not available"
		method _ fixedLength < dynamicLength ifTrue:[#fixed] ifFalse:[#dynamic]].

	bitsSent _ encoder bitPosition. "# of bits sent before this block"
	bitsRequired _ nil.

	(method == #stored) ifTrue:[
		VerboseLevel > 0 ifTrue:[Transcript show:'S'].
		bitsRequired _ storedLength.
		encoder nextBits: 3 put: StoredBlock << 1 + lastFlag.
		self sendStoredBlock].

	(method == #fixed) ifTrue:[
		VerboseLevel > 0 ifTrue:[Transcript show:'F'].
		bitsRequired _ fixedLength.
		encoder nextBits: 3 put: FixedBlock << 1 + lastFlag.
		self sendFixedBlock].

	(method == #dynamic) ifTrue:[
		VerboseLevel > 0 ifTrue:[Transcript show:'D'].
		bitsRequired _ dynamicLength.
		encoder nextBits: 3 put: DynamicBlock << 1 + lastFlag.
		self sendDynamicBlock: blTree 
			literalTree: lTree 
			distanceTree: dTree 
			bitLengths: blBits].

	bitsRequired = (encoder bitPosition - bitsSent)
		ifFalse:[self error:'Bits size mismatch'].

	lastBlock 
		ifTrue:[self release]
		ifFalse:[self initializeNewBlock].! !
!ZipWriteStream methodsFor: 'encoding' stamp: 'ar 12/29/1999 18:08'!
shouldFlush
	"Check if we should flush the current block.
	Flushing can be useful if the input characteristics change."
	| nLits |
	litCount = literals size ifTrue:[^true]. "We *must* flush"
	(litCount bitAnd: 16rFFF) = 0 ifFalse:[^false]. "Only check every N kbytes"
	matchCount * 10 <= litCount ifTrue:[
		"This is basically random data. 
		There is no need to flush early since the overhead
		for encoding the trees will add to the overall size"
		^false].
	"Try to adapt to the input data.
	We flush if the ratio between matches and literals
	changes beyound a certain threshold"
	nLits _ litCount - matchCount.
	nLits <= matchCount ifTrue:[^false]. "whow!! so many matches"
	^nLits * 4 <= matchCount! !
!ZipWriteStream methodsFor: 'fixed blocks' stamp: 'ar 12/29/1999 18:18'!
fixedBlockSizeFor: lTree and: dTree
	"Compute the length for the current block using fixed huffman trees"
	| bits extra |
	bits _ 3 "block type".
	"Compute the size of the compressed block"
	0 to: NumLiterals do:[:i| "encoding of literals"
		bits _ bits + ((literalFreq at: i+1) * (FixedLiteralTree bitLengthAt: i))].
	NumLiterals+1 to: lTree maxCode+1 do:[:i| "Encoding of match lengths"
		extra _ ExtraLengthBits at: i-NumLiterals.
		bits _ bits + ((literalFreq at: i+1) * ((FixedLiteralTree bitLengthAt: i) + extra))].
	0 to: dTree maxCode do:[:i| "encoding of distances"
		extra _ ExtraDistanceBits at: i+1.
		bits _ bits + ((distanceFreq at: i+1) * ((FixedDistanceTree bitLengthAt: i) + extra))].

	^bits! !
!ZipWriteStream methodsFor: 'fixed blocks' stamp: 'ar 12/29/1999 18:18'!
sendFixedBlock
	"Send a block using fixed huffman trees"
	self sendCompressedBlock: FixedLiteralTree with: FixedDistanceTree.! !
!ZipWriteStream methodsFor: 'private' stamp: 'ar 2/24/2001 19:45' overrides: 50523538!
moveContentsToFront
	"Need to update crc here"
	self updateCrc.
	super moveContentsToFront.
	crcPosition _ position + 1.! !
!ZipWriteStream methodsFor: 'private' stamp: 'ar 2/24/2001 19:45'!
updateCrc
	crcPosition <= position ifTrue:[
		bytesWritten _ bytesWritten + position - crcPosition + 1.
		crc _ self updateCrc: crc from: crcPosition to: position in: collection.
		crcPosition _ position + 1].! !
!ZipWriteStream methodsFor: 'private' stamp: 'nk 2/17/2004 16:51'!
updateCrc: oldCrc from: start to: stop in: aCollection
	^self class updateCrc: oldCrc from: start to: stop in: aCollection! !
!ZipWriteStream methodsFor: 'stored blocks' stamp: 'ar 1/2/2000 16:36'!
sendStoredBlock
	"Send an uncompressed block"
	| inBytes |
	inBytes _ blockPosition - blockStart.
	encoder flushBits. "Skip to byte boundary"
	encoder nextBits: 16 put: inBytes.
	encoder nextBits: 16 put: (inBytes bitXor: 16rFFFF).
	encoder flushBits.
	1 to: inBytes do:[:i|
		encoder nextBytePut: (collection byteAt: blockStart+i)].! !
!ZipWriteStream methodsFor: 'stored blocks' stamp: 'ar 12/30/1999 00:42'!
storedBlockSize
	"Compute the length for the current block when stored as is"
	^3 "block type bits" 
		+ (8 - (encoder bitPosition + 3 bitAnd: 7) bitAnd: 7)"skipped bits to byte boundary"
			+ 32 "byte length + chksum" 
				+ (blockPosition - blockStart * 8) "actual data bits".! !
!ZipWriteStream class methodsFor: 'accessing' stamp: 'ar 12/30/1999 15:55'!
baseDistance
	^BaseDistance! !
!ZipWriteStream class methodsFor: 'accessing' stamp: 'ar 12/30/1999 15:55'!
baseLength
	^BaseLength! !
!ZipWriteStream class methodsFor: 'accessing' stamp: 'ar 2/24/2001 19:42'!
crcTable
	^CrcTable! !
!ZipWriteStream class methodsFor: 'accessing' stamp: 'ar 12/29/1999 20:42'!
distanceCodes
	^DistanceCodes! !
!ZipWriteStream class methodsFor: 'accessing' stamp: 'ar 12/30/1999 15:55'!
extraDistanceBits
	^ExtraDistanceBits! !
!ZipWriteStream class methodsFor: 'accessing' stamp: 'ar 12/30/1999 15:55'!
extraLengthBits
	^ExtraLengthBits! !
!ZipWriteStream class methodsFor: 'accessing' stamp: 'ar 12/29/1999 20:42'!
matchLengthCodes
	^MatchLengthCodes! !
!ZipWriteStream class methodsFor: 'accessing' stamp: 'ar 12/29/1999 20:53'!
maxDistanceCodes
	^MaxDistCodes! !
!ZipWriteStream class methodsFor: 'accessing' stamp: 'ar 12/29/1999 20:53'!
maxLiteralCodes
	^MaxLiteralCodes! !
!ZipWriteStream class methodsFor: 'regression test' stamp: 'jmv 7/17/2017 15:51:45'!
compressAndDecompress: aFile using: tempName stats: stats
	| fileSize tempFile result |
	aFile
		ifNil: [^ nil].
	fileSize _ aFile size.
	(fileSize < 1"00000" "or:[fileSize > 1000000]") ifTrue:[aFile close. ^nil].
	Transcript newLine; show:'Testing ', aFile name,' ... '.
	tempFile _ StandardFileStream new open: tempName forWrite: true.
	'Compressing ', aFile name,'...' displayProgressAt: Sensor mousePoint
		from: 1 to: aFile size during:[:barBlock|
			result _ self regressionCompress: aFile into: tempFile notifiying: barBlock stats: stats].
	result ifTrue:[
		'Validating ', aFile name,'...' displayProgressAt: Sensor mousePoint
			from: 0 to: aFile size during:[:barBlock|
				result _ self regressionDecompress: aFile from: tempFile notifying: barBlock stats: stats]].
	aFile close.
	tempFile close.
	(DirectoryEntry smalltalkImageDirectory // tempName) delete.
	result ~~ false ifTrue:[
		Transcript show:' ok (', (result * 100 truncateTo: 0.01) printString,')'].
	^result! !
!ZipWriteStream class methodsFor: 'regression test' stamp: 'pb 5/25/2016 01:30'!
logProblem: reason for: aFile

	'problems.log' asFileEntry appendStreamDo: [ :errFile |
		errFile
			newLine;
			nextPutAll: aFile name;
			newLine;
			nextPutAll: reason ].
	Transcript show:' failed (', reason,')'.
	aFile close.
	^false! !
!ZipWriteStream class methodsFor: 'regression test' stamp: 'jmv 1/9/2014 23:32'!
printRegressionStats: stats from: fd
	| raw compressed numFiles |
	raw _ stats at: #rawSize ifAbsent:[0].
	raw = 0 ifTrue:[^self].
	compressed _ stats at: #compressedSize ifAbsent:[0].
	numFiles _ stats at: #numFiles ifAbsent:[0].
	Transcript newLine; nextPutAll: fd pathName.
	Transcript newLine; tab; nextPutAll:'Files compressed: ', numFiles printStringWithCommas.
	Transcript newLine; tab; nextPutAll:'Bytes compressed: ', raw printStringWithCommas.
	Transcript newLine; tab; nextPutAll:'Avg. compression ratio: ';
		print: ((compressed / raw asFloat * 100.0) truncateTo: 0.01).
	Transcript endEntry.! !
!ZipWriteStream class methodsFor: 'regression test' stamp: 'jmv 7/17/2017 15:52:09'!
regressionCompress: aFile into: tempFile notifiying: progressBarBlock stats: stats
	"Compress aFile into tempFile"
	| zip encoded buffer |
	aFile binary.
	aFile position: 0.
	tempFile binary.
	buffer _ ByteArray new: 4096.
	zip _ self on: (ByteArray new: 10000).
	encoded _ zip encodedStream.
	[aFile atEnd] whileFalse:[
		progressBarBlock value: aFile position.
		zip nextPutAll: (aFile nextInto: buffer).
		encoded position > 0 ifTrue:[
			tempFile nextPutAll: encoded contents.
			encoded position: 0]].
	zip close.
	tempFile nextPutAll: encoded contents.
	^true! !
!ZipWriteStream class methodsFor: 'regression test' stamp: 'jmv 7/17/2017 15:52:23'!
regressionDecompress: aFile from: tempFile notifying: progressBarBlock stats: stats
	"Validate aFile as decompressed from tempFile"
	| unzip rawSize compressedSize buffer1 buffer2 |
	rawSize _ aFile size.
	compressedSize _ tempFile size.
	aFile ascii.
	aFile position: 0.
	tempFile ascii.
	tempFile position: 0.
	buffer1 _ ByteArray new: 4096.
	buffer2 _ buffer1 copy.
	unzip _ FastInflateStream on: tempFile.
	[aFile atEnd] whileFalse:[
		progressBarBlock value: aFile position.
		buffer1 _ aFile nextInto: buffer1.
		buffer2 _ unzip nextInto: buffer2.
		buffer1 = buffer2
			ifFalse:[^self logProblem: 'contents ' for: aFile].
	].
	unzip next ifNotNil: [ ^self logProblem: 'EOF' for: aFile].
	stats at: #rawSize put:
		(stats at: #rawSize ifAbsent:[0]) + rawSize.
	stats at: #compressedSize put:
		(stats at: #compressedSize ifAbsent:[0]) + compressedSize.
	^compressedSize asFloat / rawSize asFloat.! !
!ZipWriteStream class methodsFor: 'regression test' stamp: 'pb 5/25/2016 01:16'!
regressionTest 
	"
	ZipWriteStream regressionTest
	"
	"Compress and decompress everything we can 
	find to validate that compression works as expected."
	self regressionTestFrom: DirectoryEntry smalltalkImageDirectory! !
!ZipWriteStream class methodsFor: 'regression test' stamp: 'pb 5/25/2016 01:16'!
regressionTestFrom: fd
	"ZipWriteStream regressionTestFrom: FileDirectory currentDirectory"
	"ZipWriteStream regressionTestFrom: (FileDirectory on:'')"
	"ZipWriteStream regressionTestFrom: (FileDirectory on:'C:')"
	| stats entry |
	Transcript clear.
	stats _ Dictionary new.
	entry _ (DirectoryEntry smalltalkImageDirectory // '$$sqcompress$$').
	entry exists ifTrue: [ entry delete ].
	self regressionTestFrom: fd using: entry pathName stats: stats.! !
!ZipWriteStream class methodsFor: 'regression test' stamp: 'jmv 11/3/2016 10:22:29'!
regressionTestFrom: fd using: tempName stats: stats
	| files file fullName |
	files _ fd fileNames asArray sort.
	files do: [ :fName |
		file _ nil.
		fullName _ (fd // fName) pathName.
		fullName = tempName ifFalse: [
			file _ StandardFileStream new
				open: fullName
				forWrite: false ].
		self
			compressAndDecompress: file
			using: tempName
			stats: stats ].
	stats
		at: #numFiles
		put:
			(stats
				at: #numFiles
				ifAbsent: [ 0 ]) + files size.
	files _ nil.
	self
		printRegressionStats: stats
		from: fd.
	fd directoryNames asArray sort do: [ :dName |
		self
			regressionTestFrom: fd / dName
			using: tempName
			stats: stats ].! !
!ZipWriteStream class methodsFor: 'class initialization' stamp: 'ar 5/18/2003 19:10' overrides: 16904184!
initialize
	"ZipWriteStream initialize"
	VerboseLevel := 0.
	self initializeCrcTable.! !
!ZipWriteStream class methodsFor: 'class initialization' stamp: 'ar 2/24/2001 19:42'!
initializeCrcTable
	"ZipWriteStream initialize"
	CrcTable _ #(16r00000000 16r77073096 16rEE0E612C 16r990951BA 16r076DC419
  16r706AF48F 16rE963A535 16r9E6495A3 16r0EDB8832 16r79DCB8A4
  16rE0D5E91E 16r97D2D988 16r09B64C2B 16r7EB17CBD 16rE7B82D07
  16r90BF1D91 16r1DB71064 16r6AB020F2 16rF3B97148 16r84BE41DE
  16r1ADAD47D 16r6DDDE4EB 16rF4D4B551 16r83D385C7 16r136C9856
  16r646BA8C0 16rFD62F97A 16r8A65C9EC 16r14015C4F 16r63066CD9
  16rFA0F3D63 16r8D080DF5 16r3B6E20C8 16r4C69105E 16rD56041E4
  16rA2677172 16r3C03E4D1 16r4B04D447 16rD20D85FD 16rA50AB56B
  16r35B5A8FA 16r42B2986C 16rDBBBC9D6 16rACBCF940 16r32D86CE3
  16r45DF5C75 16rDCD60DCF 16rABD13D59 16r26D930AC 16r51DE003A
  16rC8D75180 16rBFD06116 16r21B4F4B5 16r56B3C423 16rCFBA9599
  16rB8BDA50F 16r2802B89E 16r5F058808 16rC60CD9B2 16rB10BE924
  16r2F6F7C87 16r58684C11 16rC1611DAB 16rB6662D3D 16r76DC4190
  16r01DB7106 16r98D220BC 16rEFD5102A 16r71B18589 16r06B6B51F
  16r9FBFE4A5 16rE8B8D433 16r7807C9A2 16r0F00F934 16r9609A88E
  16rE10E9818 16r7F6A0DBB 16r086D3D2D 16r91646C97 16rE6635C01
  16r6B6B51F4 16r1C6C6162 16r856530D8 16rF262004E 16r6C0695ED
  16r1B01A57B 16r8208F4C1 16rF50FC457 16r65B0D9C6 16r12B7E950
  16r8BBEB8EA 16rFCB9887C 16r62DD1DDF 16r15DA2D49 16r8CD37CF3
  16rFBD44C65 16r4DB26158 16r3AB551CE 16rA3BC0074 16rD4BB30E2
  16r4ADFA541 16r3DD895D7 16rA4D1C46D 16rD3D6F4FB 16r4369E96A
  16r346ED9FC 16rAD678846 16rDA60B8D0 16r44042D73 16r33031DE5
  16rAA0A4C5F 16rDD0D7CC9 16r5005713C 16r270241AA 16rBE0B1010
  16rC90C2086 16r5768B525 16r206F85B3 16rB966D409 16rCE61E49F
  16r5EDEF90E 16r29D9C998 16rB0D09822 16rC7D7A8B4 16r59B33D17
  16r2EB40D81 16rB7BD5C3B 16rC0BA6CAD 16rEDB88320 16r9ABFB3B6
  16r03B6E20C 16r74B1D29A 16rEAD54739 16r9DD277AF 16r04DB2615
  16r73DC1683 16rE3630B12 16r94643B84 16r0D6D6A3E 16r7A6A5AA8
  16rE40ECF0B 16r9309FF9D 16r0A00AE27 16r7D079EB1 16rF00F9344
  16r8708A3D2 16r1E01F268 16r6906C2FE 16rF762575D 16r806567CB
  16r196C3671 16r6E6B06E7 16rFED41B76 16r89D32BE0 16r10DA7A5A
  16r67DD4ACC 16rF9B9DF6F 16r8EBEEFF9 16r17B7BE43 16r60B08ED5
  16rD6D6A3E8 16rA1D1937E 16r38D8C2C4 16r4FDFF252 16rD1BB67F1
  16rA6BC5767 16r3FB506DD 16r48B2364B 16rD80D2BDA 16rAF0A1B4C
  16r36034AF6 16r41047A60 16rDF60EFC3 16rA867DF55 16r316E8EEF
  16r4669BE79 16rCB61B38C 16rBC66831A 16r256FD2A0 16r5268E236
  16rCC0C7795 16rBB0B4703 16r220216B9 16r5505262F 16rC5BA3BBE
  16rB2BD0B28 16r2BB45A92 16r5CB36A04 16rC2D7FFA7 16rB5D0CF31
  16r2CD99E8B 16r5BDEAE1D 16r9B64C2B0 16rEC63F226 16r756AA39C
  16r026D930A 16r9C0906A9 16rEB0E363F 16r72076785 16r05005713
  16r95BF4A82 16rE2B87A14 16r7BB12BAE 16r0CB61B38 16r92D28E9B
  16rE5D5BE0D 16r7CDCEFB7 16r0BDBDF21 16r86D3D2D4 16rF1D4E242
  16r68DDB3F8 16r1FDA836E 16r81BE16CD 16rF6B9265B 16r6FB077E1
  16r18B74777 16r88085AE6 16rFF0F6A70 16r66063BCA 16r11010B5C
  16r8F659EFF 16rF862AE69 16r616BFFD3 16r166CCF45 16rA00AE278
  16rD70DD2EE 16r4E048354 16r3903B3C2 16rA7672661 16rD06016F7
  16r4969474D 16r3E6E77DB 16rAED16A4A 16rD9D65ADC 16r40DF0B66
  16r37D83BF0 16rA9BCAE53 16rDEBB9EC5 16r47B2CF7F 16r30B5FFE9
  16rBDBDF21C 16rCABAC28A 16r53B39330 16r24B4A3A6 16rBAD03605
  16rCDD70693 16r54DE5729 16r23D967BF 16rB3667A2E 16rC4614AB8
  16r5D681B02 16r2A6F2B94 16rB40BBE37 16rC30C8EA1 16r5A05DF1B
  16r2D02EF8D
).! !
!ZipWriteStream class methodsFor: 'crc' stamp: 'nk 2/17/2004 16:50'!
updateCrc: oldCrc from: start to: stop in: aCollection
	| newCrc |
	<primitive: 'primitiveUpdateGZipCrc32' module: 'ZipPlugin'>
	newCrc _ oldCrc.
	start to: stop do:[:i|
		newCrc _ (CrcTable at: ((newCrc bitXor: (aCollection byteAt: i)) 
				bitAnd: 255) + 1) bitXor: (newCrc bitShift: -8).
	].
	^newCrc! !
!GZipWriteStream methodsFor: 'initialization' stamp: 'nk 2/19/2004 08:31' overrides: 50523617!
writeFooter
	"Write some footer information for the crc"
	super writeFooter.
	0 to: 3 do:[:i| encoder nextBytePut: (crc >> (i*8) bitAnd: 255)].
	0 to: 3 do:[:i| encoder nextBytePut: (bytesWritten >> (i*8) bitAnd: 255)].! !
!GZipWriteStream methodsFor: 'initialization' stamp: 'ar 12/30/1999 11:41' overrides: 50523623!
writeHeader
	"Write the GZip header"
	encoder nextBits: 16 put: GZipMagic.
	encoder nextBits: 8 put: GZipDeflated.
	encoder nextBits: 8 put: 0. "No flags"
	encoder nextBits: 32 put: 0. "no time stamp"
	encoder nextBits: 8 put: 0. "No extra flags"
	encoder nextBits: 8 put: 0. "No OS type"
! !
!GZipWriteStream class methodsFor: 'file list services' stamp: 'pb 2/26/2020 13:44:48'!
compressFile: aFileEntry
	"Create a compressed file from the file of the given name"

	(aFileEntry readStream) compressFile! !
!GZipWriteStream class methodsFor: 'file list services' stamp: 'pb 2/26/2020 13:51:06'!
fileReaderServicesForFileEntry: aFileEntry suffix: suffix
	"FileList buttons that are serviced by us."
	"Don't offer to compress already-compressed files
	sjc 3-May 2003-added jpeg extension"

	^({ 'gz' . 'sar' . 'zip' . 'gif' . 'jpg' . 'jpeg'. 'pr'. 'png' } includes: suffix)
		ifTrue: [ #() ]
		ifFalse: [ { self serviceCompressFile } ]
! !
!GZipWriteStream class methodsFor: 'file list services' stamp: 'HAW 1/2/2019 18:38:24'!
serviceCompressFile

	^ (SimpleServiceEntry 
		provider: self 
		label: 'compress file'
		selector: #compressFile:
		description: 'compress file using gzip compression, making a new file'
		icon: #goBottomIcon) triggerFileListChanged! !
!ZLibWriteStream methodsFor: 'initialization' stamp: 'nk 2/17/2004 16:28' overrides: 50523599!
on: aCollectionOrStream
	super on: aCollectionOrStream.
	crc _ 1.! !
!ZLibWriteStream methodsFor: 'initialization' stamp: 'nk 2/17/2004 16:53' overrides: 50524068!
updateCrc: adler from: start to: stop in: aCollection
	"Update crc using the Adler32 checksum technique from RFC1950"
	^self class updateAdler32: adler from:  start to:  stop in: aCollection! !
!ZLibWriteStream methodsFor: 'initialization' stamp: 'ar 2/29/2004 04:40' overrides: 50523617!
writeFooter
	"Store the Adler32 checksum as the last 4 bytes."
	3 to: 0 by: -1 do:[:i| encoder nextBytePut: (crc >> (i*8) bitAnd: 255)].! !
!ZLibWriteStream methodsFor: 'initialization' stamp: 'nk 2/17/2004 18:23' overrides: 50523623!
writeHeader
	"Write header information"
	encoder nextBits: 8 put: 120. "deflate method with 15bit window size"
	encoder nextBits: 8 put: 94. "checksum; no preset; fast (flevel=1) compression"! !
!ZLibWriteStream class methodsFor: 'crc' stamp: 'ar 4/14/2010 19:50'!
updateAdler32: adler from: start to: stop in: aCollection
	"Update crc using the Adler32 checksum technique from RFC1950"
"
        unsigned long s1 = adler & 0xffff;
        unsigned long s2 = (adler >> 16) & 0xffff;
        int n;

        for (n = 0; n < len; n++) {
          s1 = (s1 + buf[n]) % BASE;
          s2 = (s2 + s1)     % BASE;
        }
        return (s2 << 16) + s1;
"
	| s1 s2 |
	<primitive: 'primitiveUpdateAdler32' module: 'ZipPlugin'>
	s1 := adler bitAnd: 16rFFFF.
	s2 := (adler bitShift: -16) bitAnd: 16rFFFF.
	start to: stop do: [ :n | | b |
		b := aCollection byteAt: n.
		s1 := (s1 + b) \\ 65521.
		s2 := (s2 + s1) \\ 65521. ].
	^(s2 bitShift: 16) + s1! !
!ZipEncoder methodsFor: 'accessing' stamp: 'ar 12/30/1999 00:45'!
bitPosition
	^encodedStream position + position * 8 + bitPosition.! !
!ZipEncoder methodsFor: 'accessing' stamp: 'ar 12/30/1999 00:37'!
encodedStream
	^encodedStream! !
!ZipEncoder methodsFor: 'accessing' stamp: 'ar 1/2/2000 16:34'!
nextBits: nBits put: value
	"Store a value of nBits"
	"self assert:[value >= 0 and:[(1 bitShift: nBits) > value]]."
	bitBuffer _ bitBuffer bitOr: (value bitShift: bitPosition).
	bitPosition _ bitPosition + nBits.
	[bitPosition >= 8] whileTrue:[
		self nextBytePut: (bitBuffer bitAnd: 255).
		bitBuffer _ bitBuffer bitShift: -8.
		bitPosition _ bitPosition - 8].! !
!ZipEncoder methodsFor: 'accessing' stamp: 'ar 1/2/2000 16:34'!
nextBytePut: anObject 
	"Primitive. Insert the argument at the next position in the Stream
	represented by the receiver. Fail if the collection of this stream is not an
	Array or a String. Fail if the stream is positioned at its end, or if the
	position is out of bounds in the collection. Fail if the argument is not
	of the right type for the collection. Optional. See Object documentation
	whatIsAPrimitive."

	<primitive: 66>
	position >= writeLimit
		ifTrue: [^ self pastEndPut: anObject]
		ifFalse: 
			[position _ position + 1.
			^collection byteAt: position put: anObject]! !
!ZipEncoder methodsFor: 'initialization' stamp: 'sd 1/30/2004 15:24' overrides: 16945886!
close
	self flush.
	encodedStream close.! !
!ZipEncoder methodsFor: 'initialization' stamp: 'ar 12/30/1999 15:51'!
commit
	encodedStream next: position putAll: collection.
	position _ readLimit _ 0.! !
!ZipEncoder methodsFor: 'initialization' stamp: 'ar 12/30/1999 15:51' overrides: 16945731!
flush
	self flushBits.
	self commit.! !
!ZipEncoder methodsFor: 'initialization' stamp: 'ar 1/2/2000 16:35'!
flushBits
	"Flush currently unsent bits"
	[bitPosition > 0] whileTrue:[
		self nextBytePut: (bitBuffer bitAnd: 255).
		bitBuffer _ bitBuffer bitShift: -8.
		bitPosition _ bitPosition - 8].
	bitPosition _ 0.! !
!ZipEncoder methodsFor: 'initialization' stamp: 'jmv 2/17/2010 22:09' overrides: 16983259!
on: aCollectionOrStream
	(aCollectionOrStream is: #Stream)
		ifTrue:[encodedStream _ aCollectionOrStream]
		ifFalse:[	encodedStream _ WriteStream on: aCollectionOrStream].
	encodedStream isBinary
		ifTrue:[super on: (ByteArray new: 4096)]
		ifFalse:[super on: (String new: 4096)].
	bitPosition _ bitBuffer _ 0.! !
!ZipEncoder methodsFor: 'private' stamp: 'ar 1/2/2000 16:38' overrides: 16983276!
pastEndPut: anObject
	"Flush the current buffer and store the new object at the beginning"
	self commit.
	^self nextBytePut: anObject asInteger! !
!ZipEncoder methodsFor: 'private' stamp: 'ar 2/2/2001 15:47'!
privateSendBlock: literalStream with: distanceStream with: litTree with: distTree
	"Send the current block using the encodings from the given literal/length and distance tree"
	| lit dist code extra sum |
	<primitive: 'primitiveZipSendBlock' module: 'ZipPlugin'>
	sum _ 0.
	[lit _ literalStream next.
	dist _ distanceStream next.
	lit == nil] whileFalse:[
		dist = 0 ifTrue:["lit is a literal"
			sum _ sum + 1.
			self nextBits: (litTree bitLengthAt: lit)
				put: (litTree codeAt: lit).
		] ifFalse:["lit is match length"
			sum _ sum + lit + MinMatch.
			code _ (MatchLengthCodes at: lit + 1).
			self nextBits: (litTree bitLengthAt: code)
				put: (litTree codeAt: code).
			extra _ ExtraLengthBits at: code-NumLiterals.
			extra = 0 ifFalse:[
				lit _ lit - (BaseLength at: code-NumLiterals).
				self nextBits: extra put: lit.
			].
			dist _ dist - 1.
			dist < 256
				ifTrue:[code _ DistanceCodes at: dist + 1]
				ifFalse:[code _ DistanceCodes at: 257 + (dist bitShift: -7)].
			"self assert:[code < MaxDistCodes]."
			self nextBits: (distTree bitLengthAt: code)
				put: (distTree codeAt: code).
			extra _ ExtraDistanceBits at: code+1.
			extra = 0 ifFalse:[
				dist _ dist - (BaseDistance at: code+1).
				self nextBits: extra put: dist.
			].
		].
	].
	^sum! !
!ZipEncoder methodsFor: 'block encoding' stamp: 'ar 12/30/1999 18:39'!
sendBlock: literalStream with: distanceStream with: litTree with: distTree
	"Send the current block using the encodings from the given literal/length and distance tree"
	| result |
	result _ 0.
	[literalStream atEnd] whileFalse:[
		result _ result + (self privateSendBlock: literalStream
						with: distanceStream with: litTree with: distTree).
		self commit.
	].
	self nextBits: (litTree bitLengthAt: EndBlock) put: (litTree codeAt: EndBlock).
	^result! !
!CRCError methodsFor: 'as yet unclassified' stamp: 'nk 3/7/2004 15:56' overrides: 16848974!
isResumable
	^true! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'RAA 6/23/2000 08:41'!
ascii

	self bufferStream ascii! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'RAA 6/23/2000 08:42'!
binary

	self bufferStream binary! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'RAA 6/23/2000 08:43'!
bufferStream

	^bufferStream ifNil: [bufferStream _ RWBinaryOrTextStream on: (ByteArray new: 5000)].
! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'RAA 6/23/2000 09:26'!
close
	
	"we don't want to until user is really done"
	

! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'RAA 6/23/2000 08:26'!
closed

	^false! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'RAA 6/23/2000 19:18'!
fileOutClass: extraClass andObject: theObject
	"Write a file that has both the source code for the named class and an object as bits.  Any instance-specific object will get its class written automatically."

	| class srefStream |

	self timeStamp.

	extraClass ifNotNil: [
		class _ extraClass.	"A specific class the user wants written"
		class sharedPools size > 0 ifTrue: [
			class shouldFileOutPools ifTrue: [class fileOutSharedPoolsOn: self]
		].
		class fileOutOn: self moveSource: false toFile: 0
	].

	"Append the object's raw data"
	srefStream _ SmartRefStream on: self.
	srefStream nextPut: theObject.  "and all subobjects"
	srefStream close.		"also closes me - well it thinks it does, anyway"
! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'RAA 6/23/2000 19:16'!
flushBuffer

	| data |
	bufferStream ifNil: [^self].
	data _ bufferStream contents asByteArray.
	gZipStream nextPutAll: data.
	positionThusFar _ positionThusFar + data size.
	bufferStream _ nil.
! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'jmv 3/13/2012 12:12'!
newLine
	"Append a newLine character to the receiver.
	The Cuis convention is to use lf on output."

	self bufferStream newLine! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'RAA 6/23/2000 09:23'!
next

	^self bufferStream next! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'RAA 6/23/2000 08:42'!
nextChunkPut: aString

	self bufferStream nextChunkPut: aString! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'RAA 6/23/2000 08:41'!
nextPut: aByte

	^self bufferStream nextPut: aByte
! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'RAA 6/23/2000 08:24'!
nextPutAll: aString

	^aString writeOnGZIPByteStream: self
! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'RAA 6/23/2000 08:41'!
nextPutAllBytes: aString

	^self bufferStream nextPutAll: aString
! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'RAA 7/11/2000 11:36'!
nextPutAllWordArray: aWordArray

	| ba hackwa hackba blt rowsAtATime sourceOrigin rowsRemaining |

	self flag: #bob.		"do we need to be concerned by bytesPerElement??"
	ba _ nil.
	rowsAtATime _ 2000.		"or 8000 bytes"
	hackwa _ Form new hackBits: aWordArray.
	sourceOrigin _ 0@0.
	[(rowsRemaining _ hackwa height - sourceOrigin y) > 0] whileTrue: [
		rowsAtATime _ rowsAtATime min: rowsRemaining.
		(ba isNil or: [ba size ~= (rowsAtATime * 4)]) ifTrue: [
			ba _ ByteArray new: rowsAtATime * 4.
			hackba _ Form new hackBits: ba.
			blt _ (BitBlt toForm: hackba) sourceForm: hackwa.
		].
		blt 
			combinationRule: Form over;
			sourceOrigin: sourceOrigin;
			destX: 0 destY: 0 width: 4 height: rowsAtATime;
			copyBits.
		self bufferStream nextPutAll: ba.
		self flushBuffer.
		sourceOrigin _ sourceOrigin x @ (sourceOrigin y + rowsAtATime).
	].
! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'jmv 2/26/2016 16:19'!
nextSignedInt32Put: int32 bigEndian: bigEndian

	^self bufferStream nextSignedInt32Put: int32 bigEndian: bigEndian! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'RAA 6/22/2000 18:42'!
nextStringPut: s 
	"Append the string, s, to the receiver.  Only used by DataStream.  Max size of 64*256*256*256."

	| length |
	(length _ s size) < 192
		ifTrue: [self nextPut: length]
		ifFalse: 
			[self nextPut: (length digitAt: 4)+192.
			self nextPut: (length digitAt: 3).
			self nextPut: (length digitAt: 2).
			self nextPut: (length digitAt: 1)].
	self nextPutAll: s.
	^s! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'ar 5/17/2001 19:08'!
nextWordsPutAll: aCollection
	"Write the argument a word-like object in big endian format on the receiver.
	May be used to write other than plain word-like objects (such as ColorArray)."
	^self nextPutAllWordArray: aCollection! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'RAA 7/11/2000 11:22'!
originalContents

	^''		"used only to determine if we are byte-structured"! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'RAA 6/23/2000 19:12'!
position

	^self bufferStream position + positionThusFar! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'RAA 6/23/2000 19:13'!
reallyClose

	self flushBuffer.
	gZipStream close.
! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'RAA 6/23/2000 08:30'!
reopen

	"ignore"! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'RAA 6/23/2000 08:30'!
setToEnd

	"ignore"! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'RAA 6/23/2000 09:21'!
skip: aNumber

	^self bufferStream skip: aNumber
! !
!GZipSurrogateStream methodsFor: 'as yet unclassified' stamp: 'jmv 3/13/2012 12:35'!
timeStamp
	"Append the current time to the receiver as a String."
	self bufferStream nextChunkPut:	"double string quotes and !!s"
		(String streamContents: [:s | Smalltalk timeStamp: s]) printString.
	self bufferStream newLine! !
!ZipEncoderNode methodsFor: 'accessing' stamp: 'ar 12/25/1999 19:41'!
bitLength
	^bitLength ifNil:[0]! !
!ZipEncoderNode methodsFor: 'accessing' stamp: 'ar 12/30/1999 14:28'!
code
	^code ifNil:[0]! !
!ZipEncoderNode methodsFor: 'accessing' stamp: 'ar 12/25/1999 21:51'!
code: aCode
	self assert:[aCode >= 0 and:[(1 bitShift: bitLength) > aCode]].
	code _ aCode.! !
!ZipEncoderNode methodsFor: 'accessing' stamp: 'ar 12/24/1999 23:36'!
frequency
	^frequency! !
!ZipEncoderNode methodsFor: 'accessing' stamp: 'ar 12/28/1999 00:56'!
frequency: aNumber
	frequency _ aNumber! !
!ZipEncoderNode methodsFor: 'accessing' stamp: 'ar 12/26/1999 10:44'!
height
	^height! !
!ZipEncoderNode methodsFor: 'accessing' stamp: 'ar 12/24/1999 23:43'!
left
	^left! !
!ZipEncoderNode methodsFor: 'accessing' stamp: 'ar 12/25/1999 20:06'!
left: aNode
	aNode parent: self.
	left _ aNode.! !
!ZipEncoderNode methodsFor: 'accessing' stamp: 'ar 12/24/1999 23:43'!
parent
	^parent! !
!ZipEncoderNode methodsFor: 'accessing' stamp: 'ar 12/24/1999 23:43'!
parent: aNode
	parent _ aNode! !
!ZipEncoderNode methodsFor: 'accessing' stamp: 'ar 12/24/1999 23:43'!
right
	^right! !
!ZipEncoderNode methodsFor: 'accessing' stamp: 'ar 12/25/1999 20:06'!
right: aNode
	aNode parent: self.
	right _ aNode.! !
!ZipEncoderNode methodsFor: 'accessing' stamp: 'ar 12/24/1999 23:43' overrides: 16902254!
value
	^value! !
!ZipEncoderNode methodsFor: 'private' stamp: 'ar 12/26/1999 10:45'!
computeHeight
	^self isLeaf
		ifTrue:[height _ 0]
		ifFalse:[height _ (left computeHeight max: right computeHeight) + 1].! !
!ZipEncoderNode methodsFor: 'private' stamp: 'ar 12/25/1999 18:14'!
leafNodes
	self isLeaf
		ifTrue:[^Array with: self]
		ifFalse:[^left leafNodes, right leafNodes]! !
!ZipEncoderNode methodsFor: 'private' stamp: 'ar 12/26/1999 12:05'!
setBitLengthTo: bl
	bitLength _ bl! !
!ZipEncoderNode methodsFor: 'private' stamp: 'ar 12/26/1999 10:46'!
setValue: v frequency: f height: h
	value _ v.
	frequency _ f.
	height _ h.! !
!ZipEncoderNode methodsFor: 'encoding' stamp: 'jmv 3/2/2010 11:31'!
encodeBitLength: blCounts from: aTree
	| index |
	"Note: If bitLength is not nil then the tree must be broken"
	bitLength ifNotNil: [ self error:'Huffman tree is broken'].
	bitLength _ parent
		ifNil: [0]
		ifNotNil: [ parent bitLength + 1].
	self isLeaf ifTrue:[
		index _ bitLength + 1.
		blCounts at: index put: (blCounts at: index) + 1.
	] ifFalse:[
		left encodeBitLength: blCounts from: aTree.
		right encodeBitLength: blCounts from: aTree.
	]! !
!ZipEncoderNode methodsFor: 'encoding' stamp: 'ar 12/27/1999 14:27'!
rotateToHeight: maxHeight
	"Rotate the tree to achieve maxHeight depth"
	| newParent |
	height < 4 ifTrue:[^self].
	self left: (left rotateToHeight: maxHeight-1).
	self right: (right rotateToHeight: maxHeight-1).
	height _ (left height max: right height) + 1.
	height <= maxHeight ifTrue:[^self].
	(left height - right height) abs <= 2 ifTrue:[^self].
	left height < right height ifTrue:[
		right right height >= right left height ifTrue:[
			newParent _ right.
			self right: newParent left.
			newParent left: self.
		] ifFalse:[
			newParent _ right left.
			right left: newParent right.
			newParent right: right.
			self right: newParent left.
			newParent left: self.
		].
	] ifFalse:[
		left left height >= left right height ifTrue:[
			newParent _ left.
			self left: newParent right.
			newParent right: self.
		] ifFalse:[
			newParent _ left right.
			left right: newParent left.
			newParent left: left.
			self left: newParent right.
			newParent right: self.
		].
	].
	parent computeHeight.
	^parent! !
!ZipEncoderNode methodsFor: 'testing' stamp: 'ar 12/24/1999 23:17'!
isLeaf
	^left == nil! !
!ZipEncoderNode class methodsFor: 'instance creation' stamp: 'ar 12/26/1999 10:47'!
value: v frequency: f height: h
	^self new setValue: v frequency: f height: h! !
!ZipEncoderTree methodsFor: 'accessing' stamp: 'ar 12/30/1999 01:43'!
bitLengthAt: index
	^bitLengths at: index+1! !
!ZipEncoderTree methodsFor: 'accessing' stamp: 'ar 12/30/1999 01:32'!
bitLengths
	"Return an array of all bitLength values for valid codes"
	^bitLengths! !
!ZipEncoderTree methodsFor: 'accessing' stamp: 'ar 12/30/1999 01:04'!
codeAt: index
	^codes at: index+1! !
!ZipEncoderTree methodsFor: 'accessing' stamp: 'ar 12/30/1999 01:24'!
codes
	"Return an array of all valid codes"
	^codes! !
!ZipEncoderTree methodsFor: 'accessing' stamp: 'ar 12/25/1999 17:15'!
maxCode
	^maxCode! !
!ZipEncoderTree methodsFor: 'accessing' stamp: 'ar 12/25/1999 21:45'!
maxCode: aNumber
	maxCode _ aNumber.! !
!ZipEncoderTree methodsFor: 'private' stamp: 'ar 12/30/1999 14:26'!
bitLengths: blArray codes: codeArray
	bitLengths _ blArray as: WordArray.
	codes _ codeArray as: WordArray.
	self assert:[(self bitLengthAt: maxCode) > 0].! !
!ZipEncoderTree methodsFor: 'private' stamp: 'ar 12/26/1999 11:02'!
reverseBits: code length: length
	"Bit reverse the given code"
	| result bit bits |
	result _ 0.
	bits _ code.
	1 to: length do:[:i|
		bit _ bits bitAnd: 1.
		result _ result << 1 bitOr: bit.
		bits _ bits >> 1].
	^result! !
!ZipEncoderTree methodsFor: 'private' stamp: 'ar 12/30/1999 14:26'!
setValuesFrom: nodeList
	self bitLengths: (nodeList collect:[:n| n bitLength] from: 1 to: maxCode+1)
		codes: (nodeList collect:[:n| n code] from: 1 to: maxCode+1).! !
!ZipEncoderTree methodsFor: 'encoding' stamp: 'ar 12/30/1999 01:34'!
buildCodes: nodeList counts: blCounts maxDepth: depth
	"Build the codes for all nodes"
	| nextCode code node length |
	nextCode _ WordArray new: depth+1.
	code _ 0.
	1 to: depth do:[:bits|
		code _ (code + (blCounts at: bits)) << 1.
		nextCode at: bits+1 put: code].
	self assert:[(code + (blCounts at: depth+1) - 1) = (1 << depth - 1)].
	0 to: maxCode do:[:n|
		node _ nodeList at: n+1.
		length _ node bitLength.
		length = 0 ifFalse:[
			code _ nextCode at: length+1.
			node code: (self reverseBits: code length: length).
			nextCode at: length+1 put: code+1.
		].
	].! !
!ZipEncoderTree methodsFor: 'encoding' stamp: 'ar 12/26/1999 10:42'!
buildHierarchyFrom: aHeap
	"Build the node hierarchy based on the leafs in aHeap"
	| left right parent |
	[aHeap size > 1] whileTrue:[
		left _ aHeap removeFirst.
		right _ aHeap removeFirst.
		parent _ ZipEncoderNode value: -1 
			frequency: (left frequency + right frequency)
			height: (left height max: right height) + 1.
		left parent: parent.
		right parent: parent.
		parent left: left.
		parent right: right.
		aHeap add: parent].
	^aHeap removeFirst
! !
!ZipEncoderTree methodsFor: 'encoding' stamp: 'ar 12/30/1999 14:19'!
buildTree: nodeList maxDepth: depth
	"Build either the literal or the distance tree"
	| heap rootNode blCounts |
	heap _ Heap new: nodeList size // 3.
	heap sortBlock: self nodeSortBlock.
	"Find all nodes with non-zero frequency and add to heap"
	maxCode _ 0.
	nodeList do:[:dNode|
		dNode frequency = 0 ifFalse:[
			maxCode _ dNode value.
			heap add: dNode]].
	"The pkzip format requires that at least one distance code exists,
	and that at least one bit should be sent even if there is only one
	possible code. So to avoid special checks later on we force at least
	two codes of non zero frequency."
	heap size = 0 ifTrue:[
		self assert:[maxCode = 0].
		heap add: nodeList first.
		heap add: nodeList second.
		maxCode _ 1].
	heap size = 1 ifTrue:[
		nodeList first frequency = 0
			ifTrue:[heap add: nodeList first]
			ifFalse:[heap add: nodeList second].
		maxCode _ maxCode max: 1].
	rootNode _ self buildHierarchyFrom: heap.
	rootNode height > depth ifTrue:[
		rootNode _ rootNode rotateToHeight: depth.
		rootNode height > depth ifTrue:[self error:'Cannot encode tree']].
	blCounts _ WordArray new: depth+1.
	rootNode encodeBitLength: blCounts from: self.
	self buildCodes: nodeList counts: blCounts maxDepth: depth.
	self setValuesFrom: nodeList.! !
!ZipEncoderTree methodsFor: 'encoding' stamp: 'ar 12/30/1999 01:24'!
buildTreeFrom: frequencies maxDepth: depth
	"Build the receiver from the given frequency values"
	| nodeList |
	nodeList _ Array new: frequencies size.
	1 to: frequencies size do:[:i|
		nodeList at: i put: (ZipEncoderNode value: i-1 frequency: (frequencies at: i) height: 0)
	].
	self buildTree: nodeList maxDepth: depth.! !
!ZipEncoderTree methodsFor: 'encoding' stamp: 'ar 12/26/1999 10:42'!
nodeSortBlock
	^[:n1 :n2|
		n1 frequency = n2 frequency
			ifTrue:[n1 height <= n2 height]
			ifFalse:[n1 frequency <= n2 frequency]].! !
!ZipEncoderTree class methodsFor: 'instance creation' stamp: 'ar 12/30/1999 01:25'!
buildTreeFrom: frequencies maxDepth: depth
	^self new buildTreeFrom: frequencies maxDepth: depth! !
!Archive methodsFor: 'archive operations' stamp: 'nk 2/22/2001 19:09'!
addDirectory: aFileName
	^self addDirectory: aFileName as: aFileName
! !
!Archive methodsFor: 'archive operations' stamp: 'nk 12/20/2002 14:57'!
addDirectory: aFileName as: anotherFileName
	| newMember |
	newMember _ self memberClass newFromDirectory: aFileName.
	self addMember: newMember.
	newMember localFileName: anotherFileName.
	^newMember! !
!Archive methodsFor: 'archive operations' stamp: 'nk 2/21/2001 18:29'!
addFile: aFileName
	^self addFile: aFileName as: aFileName! !
!Archive methodsFor: 'archive operations' stamp: 'nk 12/20/2002 15:03'!
addFile: aFileName as: anotherFileName
	| newMember |
	newMember _ self memberClass newFromFile: aFileName.
	self addMember: newMember.
	newMember localFileName: anotherFileName.
	^newMember! !
!Archive methodsFor: 'archive operations' stamp: 'nk 2/22/2001 19:09'!
addMember: aMember
	^members addLast: aMember! !
!Archive methodsFor: 'archive operations' stamp: 'nk 12/20/2002 15:03'!
addString: aString as: aFileName
	| newMember |
	newMember _ self memberClass newFromString: aString named: aFileName.
	self addMember: newMember.
	newMember localFileName: aFileName.
	^newMember! !
!Archive methodsFor: 'archive operations' stamp: 'nk 2/24/2001 14:12'!
canWriteToFileNamed: aFileName
	"Catch attempts to overwrite existing zip file"
	^(members anySatisfy: [ :ea | ea usesFileNamed: aFileName ]) not.
! !
!Archive methodsFor: 'archive operations' stamp: 'nk 2/22/2001 07:57'!
contentsOf: aMemberOrName
	| member |
	member _ self member: aMemberOrName.
	member ifNil: [ ^nil ].
	^member contents! !
!Archive methodsFor: 'archive operations' stamp: 'pb 5/25/2016 01:06'!
extractMember: aMemberOrName
	| member |
	member _ self member: aMemberOrName.
	member ifNil: [ ^nil ].
	member extractToFileNamed: member localFileName inDirectory: DirectoryEntry currentDirectory! !
!Archive methodsFor: 'archive operations' stamp: 'nk 2/22/2001 07:57'!
extractMember: aMemberOrName toFileNamed: aFileName
	| member |
	member _ self member: aMemberOrName.
	member ifNil: [ ^nil ].
	member extractToFileNamed: aFileName! !
!Archive methodsFor: 'archive operations' stamp: 'pb 5/25/2016 01:06'!
extractMemberWithoutPath: aMemberOrName
	self extractMemberWithoutPath: aMemberOrName inDirectory: DirectoryEntry currentDirectory! !
!Archive methodsFor: 'archive operations' stamp: 'jmv 5/31/2016 10:35'!
extractMemberWithoutPath: aMemberOrName inDirectory: aDirectoryEntry
	| member |
	member _ self member: aMemberOrName.
	member ifNil: [ ^nil ].
	member extractToFileNamed: member localFileName asFileEntry name inDirectory: aDirectoryEntry! !
!Archive methodsFor: 'archive operations' stamp: 'jmv 3/2/2010 08:56'!
memberNamed: aString
	"Return the first member whose zip name or local file name matches aString, or nil"
	^members detect: [ :ea | ea fileName = aString or: [ ea localFileName = aString ]] ifNone: nil! !
!Archive methodsFor: 'archive operations' stamp: 'nk 2/21/2001 18:00'!
memberNames
	^members collect: [ :ea | ea fileName ]! !
!Archive methodsFor: 'archive operations' stamp: 'nk 2/21/2001 17:58'!
members
	^members! !
!Archive methodsFor: 'archive operations' stamp: 'nk 12/20/2002 14:50'!
membersMatching: aString
	^members select: [ :ea | (aString match: ea fileName) or: [ aString match: ea localFileName ] ]! !
!Archive methodsFor: 'archive operations' stamp: 'nk 2/21/2001 17:59'!
numberOfMembers
	^members size! !
!Archive methodsFor: 'archive operations' stamp: 'nk 2/22/2001 07:57'!
removeMember: aMemberOrName
	| member |
	member _ self member: aMemberOrName.
	member ifNotNil: [ members remove: member ].
	^member! !
!Archive methodsFor: 'archive operations' stamp: 'nk 2/22/2001 07:57'!
replaceMember: aMemberOrName with: newMember
	| member |
	member _ self member: aMemberOrName.
	member ifNotNil: [ members replaceAll: member with: newMember ].
	^member! !
!Archive methodsFor: 'archive operations' stamp: 'nk 2/22/2001 17:24'!
setContentsOf: aMemberOrName to: aString
	| newMember oldMember |
	oldMember _ self member: aMemberOrName.
	newMember _ (self memberClass newFromString: aString named: oldMember fileName)
		copyFrom: oldMember.
	self replaceMember: oldMember with: newMember.! !
!Archive methodsFor: 'archive operations' stamp: 'nk 2/21/2001 20:58'!
writeTo: aStream
	self subclassResponsibility! !
!Archive methodsFor: 'archive operations' stamp: 'pb 5/25/2016 01:35'!
writeToFileNamed: aFileName

	"Catch attempts to overwrite existing zip file"
	(self canWriteToFileNamed: aFileName)
		ifFalse: [ ^self error: (aFileName, ' is needed by one or more members in this archive') ].
	aFileName asFileEntry writeStreamDo: [ :stream |
		self writeTo: stream ]! !
!Archive methodsFor: 'initialization' stamp: 'nk 2/21/2001 17:58' overrides: 16920235!
initialize
	members _ OrderedCollection new.! !
!Archive methodsFor: 'private' stamp: 'nk 2/22/2001 07:56'!
member: aMemberOrName
	^(members includes: aMemberOrName)
		ifTrue: [ aMemberOrName ]
		ifFalse: [ self memberNamed: aMemberOrName ].! !
!Archive methodsFor: 'private' stamp: 'nk 2/21/2001 18:14'!
memberClass
	self subclassResponsibility! !
!ZipArchive methodsFor: 'initialization' stamp: 'ar 3/2/2001 18:47'!
close
	self members do:[:m| m close].! !
!ZipArchive methodsFor: 'initialization' stamp: 'nk 2/22/2001 17:20' overrides: 50525327!
initialize
	super initialize.
	writeEOCDOffset _ writeCentralDirectoryOffset _ 0.
	zipFileComment _ ''.
! !
!ZipArchive methodsFor: 'archive operations' stamp: 'jmv 7/17/2017 15:47:50'!
extractAllTo: aDirectoryEntry
	"Extract all elements to the given directory"
	Utilities informUserDuring: [ :barBlock | self extractAllTo: aDirectoryEntry informing: barBlock]! !
!ZipArchive methodsFor: 'archive operations' stamp: 'jmv 7/17/2017 15:47:41'!
extractAllTo: aDirectoryEntry informing: barBlock
	"Extract all elements to the given directory"
	^self extractAllTo: aDirectoryEntry informing: barBlock overwrite: false! !
!ZipArchive methodsFor: 'archive operations' stamp: 'jmv 7/17/2017 15:50:56'!
extractAllTo: aDirectory informing: barBlock overwrite: allOverwrite
	"Extract all elements to the given directory"
	| dir overwriteAll response |
	overwriteAll := allOverwrite.
	self members do:[:entry|
		entry isDirectory ifTrue:[
			barBlock ifNotNil:[barBlock value: 'Creating ', entry fileName].
			dir := (entry fileName findTokens:'/') 
					inject: aDirectory into:[:base :part| base / part].
			dir assureExistence.
		].
	].
	self members do:[:entry|
		entry isDirectory ifFalse:[
			barBlock ifNotNil:[barBlock value: 'Extracting ', entry fileName].
			response := entry extractInDirectory: aDirectory overwrite: overwriteAll.
			response == #retryWithOverwrite ifTrue:[
				overwriteAll := true.
				response := entry extractInDirectory: aDirectory overwrite: overwriteAll.
			].
			response == #abort ifTrue:[^self].
			response == #failed ifTrue:[
				(self confirm: 'Failed to extract ', entry fileName, '. Proceed?') ifFalse:[^self].
			].
		].
	].
! !

----STARTUP---- (15 June 2022 17:08:22) as C:\Users\andyf\Desktop\windows64\CuisUniversity-5053.image!


!classRemoval: #RoseTree stamp: 'LDMAF 6/15/2022 17:08:59'!
Object subclass: #RoseTree
	instanceVariableNames: 'parents children value'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!

!classRemoval: #ReceptiveAccount stamp: 'LDMAF 6/15/2022 17:08:59'!
BankAsset subclass: #ReceptiveAccount
	instanceVariableNames: 'transactions'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!

!classRemoval: #Portfolio stamp: 'LDMAF 6/15/2022 17:09:00'!
BankAsset subclass: #Portfolio
	instanceVariableNames: 'accounts portfolios parentPorfolios assets'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!

!classRemoval: #BankAsset stamp: 'LDMAF 6/15/2022 17:09:00'!
Object subclass: #BankAsset
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!

!classRemoval: #Withdraw stamp: 'LDMAF 6/15/2022 17:09:00'!
AccountTransaction subclass: #Withdraw
	instanceVariableNames: 'value'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!

!classRemoval: #Deposit stamp: 'LDMAF 6/15/2022 17:09:00'!
AccountTransaction subclass: #Deposit
	instanceVariableNames: 'value'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!

!classRemoval: #AccountTransaction stamp: 'LDMAF 6/15/2022 17:09:01'!
Object subclass: #AccountTransaction
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!

!classRemoval: #ReceptiveAccountTest stamp: 'LDMAF 6/15/2022 17:09:01'!
TestCase subclass: #ReceptiveAccountTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Portfolio-Ejercicio'!

!classRemoval: #MarsRover stamp: 'LDMAF 6/15/2022 17:09:08'!
Object subclass: #MarsRover
	instanceVariableNames: 'position direction'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

!classRemoval: #MarsRoverTests stamp: 'LDMAF 6/15/2022 17:09:08'!
TestCase subclass: #MarsRoverTests
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'MarsRover'!

----SNAPSHOT----(15 June 2022 17:09:13) CuisUniversity-5053.image priorSource: 4625038!

----End fileIn of C:\Users\andyf\Desktop\windows64\TusLibros-Model Ejercicio it4.st----!

----End fileIn of C:\Users\andyf\Desktop\windows64\TusLibrosREST Ejercicio it4.st----!

----End fileIn of C:\Users\andyf\Desktop\windows64\TusLibros-Tests Ejercicio it4.st----!

----End fileIn of C:\Users\andyf\Desktop\windows64\Packages\System\Collections-CompactArrays.pck.st----!

----End fileIn of C:\Users\andyf\Desktop\windows64\Packages\Features\Compression.pck.st----!

----End fileIn of C:\Users\andyf\Desktop\windows64\Packages\Features\Sound.pck.st----!

----End fileIn of C:\Users\andyf\Desktop\windows64\Packages\Features\Cryptography-DigitalSignatures.pck.st----!

----End fileIn of C:\Users\andyf\Desktop\windows64\Packages\Features\Identities-UUID.pck.st----!

----End fileIn of C:\Users\andyf\Desktop\windows64\Packages\System\Network-Kernel.pck.st----!

----End fileIn of C:\Users\andyf\Desktop\windows64\WebClient.pck.st----!
!TusLibrosSystemFacade methodsFor: 'private' stamp: 'LDMAF 6/15/2022 17:13:40'!
forkFor: aBlock with: aSemaphore
	[aBlock value. aSemaphore signal] fork.
	

! !
!TusLibrosSystemFacade methodsFor: 'private' stamp: 'LDMAF 6/15/2022 17:14:34' prior: 50526295!
bookPerformance: anItem

	| bookPerformance totalMoney totalSales semaphore|
	
	semaphore := Semaphore new.

	bookPerformance := Dictionary new.
	
	self forkFor: [totalSales := self totalSalesOf: anItem.] with: semaphore.
	totalMoney := self totalMoneyRaisedBy: anItem.
	semaphore wait.
	bookPerformance at: 'quantity' put: totalSales.
	bookPerformance at: 'total' put: totalMoney.
	bookPerformance at: 'summary' put: anItem,' was selled ',totalSales asString, ' times and raised a total amount of money equal to: ', totalMoney asString.
	
	^bookPerformance
	

! !
!TusLibrosSystemFacade methodsFor: 'private' stamp: 'LDMAF 6/15/2022 17:15:52' prior: 50526336!
storePerformance

	| totalMoney totalSales performance semaphore|
	
	semaphore := Semaphore new.	
	performance := Dictionary new.
	
	self forkFor: [totalSales := self totalSales.] with: semaphore.
	totalMoney := self totalMoneyRaised.
	semaphore wait.
	performance at: 'quantity' put: totalSales.
	performance at: 'total' put: totalMoney.
	performance at: 'summary' put: 'The store selled a total of ',totalSales asString, ' books and raised a total amount of money equal to: ', totalMoney asString.
	
	^performance
	

! !

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'LDMAF 6/15/2022 17:16:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'LDMAF 6/15/2022 17:16:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'LDMAF 6/15/2022 17:16:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'LDMAF 6/15/2022 17:16:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'LDMAF 6/15/2022 17:16:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'LDMAF 6/15/2022 17:16:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'LDMAF 6/15/2022 17:16:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'LDMAF 6/15/2022 17:16:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CheckOutReturnsTransactionIdAndImpactsCustomerPurchases stamp: 'LDMAF 6/15/2022 17:16:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10_1_CanNotCheckoutAnAlreadyCheckedOutCart stamp: 'LDMAF 6/15/2022 17:16:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'LDMAF 6/15/2022 17:16:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'LDMAF 6/15/2022 17:16:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'LDMAF 6/15/2022 17:16:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'LDMAF 6/15/2022 17:16:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'LDMAF 6/15/2022 17:16:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'LDMAF 6/15/2022 17:16:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'LDMAF 6/15/2022 17:16:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'LDMAF 6/15/2022 17:16:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'LDMAF 6/15/2022 17:16:03'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test20BookPerformanceShouldNotTakeTooLong stamp: 'LDMAF 6/15/2022 17:16:04'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test21StorePerformanceShouldNotTakeTooLong stamp: 'LDMAF 6/15/2022 17:16:05'!
PASSED!

Object subclass: #PerformanceReport
	instanceVariableNames: 'quantityBlock totalBlock summaryBlock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #PerformanceReport category: 'TusLibros-Model' stamp: 'LDMAF 6/15/2022 17:23:24'!
Object subclass: #PerformanceReport
	instanceVariableNames: 'quantityBlock totalBlock summaryBlock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

Object subclass: #PerformanceReport
	instanceVariableNames: 'quantityBlock totalBlock summaryBlock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #PerformanceReport category: 'TusLibros-Model' stamp: 'LDMAF 6/15/2022 17:24:21'!
Object subclass: #PerformanceReport
	instanceVariableNames: 'quantityBlock totalBlock summaryBlock'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!PerformanceReport class methodsFor: 'no messages' stamp: 'LDMAF 6/15/2022 17:27:13'!
reportingFor: aTusLibrosFacade
	^self new initializeWith: aTusLibrosFacade.! !

!classDefinition: #PerformanceReport category: 'TusLibros-Model' stamp: 'LDMAF 6/15/2022 17:27:41'!
Object subclass: #PerformanceReport
	instanceVariableNames: 'quantityBlock totalBlock summaryBlock facade'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!PerformanceReport methodsFor: 'no messages' stamp: 'LDMAF 6/15/2022 17:27:41'!
initializeWith: aTusLibrosFacade
	facade := aTusLibrosFacade.! !
!PerformanceReport methodsFor: 'as yet unclassified' stamp: 'LDMAF 6/15/2022 17:28:55'!
reportBookPerformanceFor: anItem
	| bookPerformance totalMoney totalSales semaphore|
	
	semaphore := Semaphore new.

	bookPerformance := Dictionary new.
	
	self forkFor: [totalSales := facade totalSalesOf: anItem.] with: semaphore.
	totalMoney := self totalMoneyRaisedBy: anItem.
	semaphore wait.
	bookPerformance at: 'quantity' put: totalSales.
	bookPerformance at: 'total' put: totalMoney.
	bookPerformance at: 'summary' put: anItem,' was selled ',totalSales asString, ' times and raised a total amount of money equal to: ', totalMoney asString.
	^bookPerformance.
	! !
!PerformanceReport methodsFor: 'as yet unclassified' stamp: 'LDMAF 6/15/2022 17:29:46' prior: 50565148!
reportBookPerformanceFor: anItem
	| bookPerformance totalMoney totalSales semaphore|
	
	semaphore := Semaphore new.

	bookPerformance := Dictionary new.
	
	facade forkFor: [totalSales := facade totalSalesOf: anItem.] with: semaphore.
	totalMoney := facade totalMoneyRaisedBy: anItem.
	semaphore wait.
	bookPerformance at: 'quantity' put: totalSales.
	bookPerformance at: 'total' put: totalMoney.
	bookPerformance at: 'summary' put: anItem,' was selled ',totalSales asString, ' times and raised a total amount of money equal to: ', totalMoney asString.
	
	^bookPerformance.
	! !
!TusLibrosSystemFacade methodsFor: 'private' stamp: 'LDMAF 6/15/2022 17:30:35' prior: 50564979!
bookPerformance: anItem
	^ (PerformanceReport reportingFor: self) reportBookPerformanceFor: anItem.
	

! !

!testRun: #TusLibrosSystemFacadeTest #test20BookPerformanceShouldNotTakeTooLong stamp: 'LDMAF 6/15/2022 17:30:44'!
PASSED!

Object subclass: #PerformanceReport
	instanceVariableNames: 'semaphore dictionary facade'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

Object subclass: #PerformanceReport
	instanceVariableNames: 'semaphoree dictionary facade'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #PerformanceReport category: 'TusLibros-Model' stamp: 'LDMAF 6/15/2022 17:35:22'!
Object subclass: #PerformanceReport
	instanceVariableNames: 'semaphoree dictionary facade'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!PerformanceReport methodsFor: 'as yet unclassified' stamp: 'LDMAF 6/15/2022 17:35:35' prior: 50565170!
reportBookPerformanceFor: anItem
	| bookPerformance totalMoney totalSales|
	
	semaphoree := Semaphore new.

	bookPerformance := Dictionary new.
	
	facade forkFor: [totalSales := facade totalSalesOf: anItem.] with: semaphoree.
	totalMoney := facade totalMoneyRaisedBy: anItem.
	semaphoree wait.
	bookPerformance at: 'quantity' put: totalSales.
	bookPerformance at: 'total' put: totalMoney.
	bookPerformance at: 'summary' put: anItem,' was selled ',totalSales asString, ' times and raised a total amount of money equal to: ', totalMoney asString.
	
	^bookPerformance.
	! !

Object subclass: #PerformanceReport
	instanceVariableNames: 'semaphore dictionary facade'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!

!classDefinition: #PerformanceReport category: 'TusLibros-Model' stamp: 'LDMAF 6/15/2022 17:35:40'!
Object subclass: #PerformanceReport
	instanceVariableNames: 'semaphore dictionary facade'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibros-Model'!
!PerformanceReport methodsFor: 'as yet unclassified' stamp: 'LDMAF 6/15/2022 17:35:47' prior: 50565222!
reportBookPerformanceFor: anItem
	| bookPerformance totalMoney totalSales|
	
	semaphore := Semaphore new.

	bookPerformance := Dictionary new.
	
	facade forkFor: [totalSales := facade totalSalesOf: anItem.] with: semaphore.
	totalMoney := facade totalMoneyRaisedBy: anItem.
	semaphore wait.
	bookPerformance at: 'quantity' put: totalSales.
	bookPerformance at: 'total' put: totalMoney.
	bookPerformance at: 'summary' put: anItem,' was selled ',totalSales asString, ' times and raised a total amount of money equal to: ', totalMoney asString.
	
	^bookPerformance.
	! !
!PerformanceReport methodsFor: 'as yet unclassified' stamp: 'LDMAF 6/15/2022 17:36:51' prior: 50565143!
initializeWith: aTusLibrosFacade
	facade := aTusLibrosFacade.
	semaphore := Semaphore new.
	dictionary := Dictionary new.! !
!PerformanceReport methodsFor: 'as yet unclassified' stamp: 'LDMAF 6/15/2022 17:37:39' prior: 50565257!
reportBookPerformanceFor: anItem
	| bookPerformance totalMoney totalSales|
	
	facade forkFor: [totalSales := facade totalSalesOf: anItem.] with: semaphore.
	totalMoney := facade totalMoneyRaisedBy: anItem.
	semaphore wait.
	dictionary at: 'quantity' put: totalSales.
	dictionary at: 'total' put: totalMoney.
	dictionary at: 'summary' put: anItem,' was selled ',totalSales asString, ' times and raised a total amount of money equal to: ', totalMoney asString.
	
	^dictionary.
	! !
!PerformanceReport methodsFor: 'as yet unclassified' stamp: 'LDMAF 6/15/2022 17:37:45' prior: 50565286!
reportBookPerformanceFor: anItem
	| totalMoney totalSales|
	
	facade forkFor: [totalSales := facade totalSalesOf: anItem.] with: semaphore.
	totalMoney := facade totalMoneyRaisedBy: anItem.
	semaphore wait.
	dictionary at: 'quantity' put: totalSales.
	dictionary at: 'total' put: totalMoney.
	dictionary at: 'summary' put: anItem,' was selled ',totalSales asString, ' times and raised a total amount of money equal to: ', totalMoney asString.
	
	^dictionary.
	! !
!PerformanceReport methodsFor: 'as yet unclassified' stamp: 'LDMAF 6/15/2022 17:39:50' prior: 50565305!
reportBookPerformanceFor: anItem
	| totalMoney totalSales|
	
	facade forkFor: [totalSales := facade totalSalesOf: anItem.] with: semaphore.
	totalMoney := facade totalMoneyRaisedBy: anItem.
	semaphore wait.
	
	self populateDictionaryWithSales: totalSales 
		totalMoney: totalMoney 
		summary: anItem,' was selled ',totalSales asString, ' times and raised a total amount of money equal to: ', totalMoney asString.
	
	^dictionary.
	! !
!PerformanceReport methodsFor: 'as yet unclassified' stamp: 'LDMAF 6/15/2022 17:40:20'!
summaryWithTotalMoney: totalMoney for: anItem andTotalSales: totalSales

	^ anItem,' was selled ',totalSales asString, ' times and raised a total amount of money equal to: ', totalMoney asString! !
!PerformanceReport methodsFor: 'as yet unclassified' stamp: 'LDMAF 6/15/2022 17:40:20' prior: 50565323!
reportBookPerformanceFor: anItem
	| totalMoney totalSales|
	
	facade forkFor: [totalSales := facade totalSalesOf: anItem.] with: semaphore.
	totalMoney := facade totalMoneyRaisedBy: anItem.
	semaphore wait.
	
	self populateDictionaryWithSales: totalSales 
		totalMoney: totalMoney 
		summary: (self summaryWithTotalMoney: totalMoney for: anItem andTotalSales: totalSales).
	
	^dictionary.
	! !
!PerformanceReport methodsFor: 'as yet unclassified' stamp: 'LDMAF 6/15/2022 17:42:29'!
populateDictionaryWithSales: totalSales money: totalMoney summary: aSummary
	! !
!PerformanceReport methodsFor: 'as yet unclassified' stamp: 'LDMAF 6/15/2022 17:42:46' prior: 50565350!
reportBookPerformanceFor: anItem
	| totalMoney totalSales|
	
	facade forkFor: [totalSales := facade totalSalesOf: anItem.] with: semaphore.
	totalMoney := facade totalMoneyRaisedBy: anItem.
	semaphore wait.
	
	self populateDictionaryWithSales: totalSales 
		money: totalMoney 
		summary: (self summaryWithTotalMoney: totalMoney for: anItem andTotalSales: totalSales).
	
	^dictionary.
	! !
!PerformanceReport methodsFor: 'as yet unclassified' stamp: 'LDMAF 6/15/2022 17:43:34' prior: 50565366!
populateDictionaryWithSales: totalSales money: totalMoney summary: aSummary
	dictionary at: 'quantity' put: totalSales.
	dictionary at: 'total' put: totalMoney.
	dictionary at: 'summary' put: aSummary.! !

!testRun: #TusLibrosSystemFacadeTest #test20BookPerformanceShouldNotTakeTooLong stamp: 'LDMAF 6/15/2022 17:43:49'!
PASSED!
!PerformanceReport methodsFor: 'as yet unclassified' stamp: 'LDMAF 6/15/2022 17:46:42'!
runInParallel: aParallelThreadBlock and: aMainThreadBlock
	[aParallelThreadBlock value. semaphore signal] fork.
	aMainThreadBlock value.
	! !
!PerformanceReport methodsFor: 'as yet unclassified' stamp: 'LDMAF 6/15/2022 17:47:42' prior: 50565372!
reportBookPerformanceFor: anItem
	| totalMoney totalSales|
	self runInParallel: [totalSales := facade totalSalesOf: anItem.] 
		and: [totalMoney := facade totalMoneyRaisedBy: anItem].
	semaphore wait.
	
	self populateDictionaryWithSales: totalSales 
		money: totalMoney 
		summary: (self summaryWithTotalMoney: totalMoney for: anItem andTotalSales: totalSales).
	
	^dictionary.
	! !

!testRun: #TusLibrosSystemFacadeTest #test20BookPerformanceShouldNotTakeTooLong stamp: 'LDMAF 6/15/2022 17:47:52'!
PASSED!
!PerformanceReport methodsFor: 'as yet unclassified' stamp: 'LDMAF 6/15/2022 17:49:40'!
reportStorePerformance
	| totalMoney totalSales|
	self runInParallel: [totalSales := facade totalSales.] 
		and: [totalMoney := facade totalMoneyRaised.].
	semaphore wait.
	
	self populateDictionaryWithSales: totalSales 
		money: totalMoney 
		summary: 'The store selled a total of ',totalSales asString, ' books and raised a total amount of money equal to: ', totalMoney asString.
	
	^dictionary.
	! !
!PerformanceReport methodsFor: 'as yet unclassified' stamp: 'LDMAF 6/15/2022 17:50:17'!
summaryWithTotalMoney: totalMoney andTotalSales: totalSales

	^ 'The store selled a total of ',totalSales asString, ' books and raised a total amount of money equal to: ', totalMoney asString! !
!PerformanceReport methodsFor: 'as yet unclassified' stamp: 'LDMAF 6/15/2022 17:50:17' prior: 50565429!
reportStorePerformance
	| totalMoney totalSales|
	self runInParallel: [totalSales := facade totalSales.] 
		and: [totalMoney := facade totalMoneyRaised.].
	semaphore wait.
	
	self populateDictionaryWithSales: totalSales 
		money: totalMoney 
		summary: (self summaryWithTotalMoney: totalMoney andTotalSales: totalSales).
	
	^dictionary.
	! !
!TusLibrosSystemFacade methodsFor: 'private' stamp: 'LDMAF 6/15/2022 17:51:00' prior: 50565000!
storePerformance
	^ (PerformanceReport reportingFor: self) reportStorePerformance.
	

! !

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'LDMAF 6/15/2022 17:51:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'LDMAF 6/15/2022 17:51:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'LDMAF 6/15/2022 17:51:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'LDMAF 6/15/2022 17:51:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'LDMAF 6/15/2022 17:51:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'LDMAF 6/15/2022 17:51:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'LDMAF 6/15/2022 17:51:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'LDMAF 6/15/2022 17:51:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CheckOutReturnsTransactionIdAndImpactsCustomerPurchases stamp: 'LDMAF 6/15/2022 17:51:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10_1_CanNotCheckoutAnAlreadyCheckedOutCart stamp: 'LDMAF 6/15/2022 17:51:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'LDMAF 6/15/2022 17:51:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'LDMAF 6/15/2022 17:51:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'LDMAF 6/15/2022 17:51:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'LDMAF 6/15/2022 17:51:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'LDMAF 6/15/2022 17:51:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'LDMAF 6/15/2022 17:51:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'LDMAF 6/15/2022 17:51:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'LDMAF 6/15/2022 17:51:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'LDMAF 6/15/2022 17:51:08'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test20BookPerformanceShouldNotTakeTooLong stamp: 'LDMAF 6/15/2022 17:51:09'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test21StorePerformanceShouldNotTakeTooLong stamp: 'LDMAF 6/15/2022 17:51:10'!
PASSED!

----SNAPSHOT----(15 June 2022 17:52:42) CuisUniversity-5053.image priorSource: 6202320!

TusLibrosServerRestInterface installForDefaultSystem!

TusLibrosClientTestWindow open!
!TusLibrosServerRestInterface methodsFor: 'rest interface' stamp: 'LDMAF 6/15/2022 18:02:42' prior: 50526998!
createCart: aRequest

	| clientId password |

	"(Delay forSeconds: 1) wait."
	
	self withFieldsOf: aRequest do: [ :requestFields |
		clientId := self clientIdFrom: requestFields.
		password := self passwordFrom: requestFields ].
	
	self 
		answer: [ | cartId | 
			cartId := systemFacade createCartFor: clientId authenticatedWith: password.
			cartId printString ]
		to: aRequest ! !
!TusLibrosServerRestInterface methodsFor: 'rest interface' stamp: 'LDMAF 6/15/2022 18:02:59' prior: 50565563!
createCart: aRequest

	| clientId password |

	(Delay forSeconds: 1) wait.
	
	self withFieldsOf: aRequest do: [ :requestFields |
		clientId := self clientIdFrom: requestFields.
		password := self passwordFrom: requestFields ].
	
	self 
		answer: [ | cartId | 
			cartId := systemFacade createCartFor: clientId authenticatedWith: password.
			cartId printString ]
		to: aRequest ! !
!TusLibrosServerRestInterface class methodsFor: 'installation' stamp: 'LDMAF 6/15/2022 18:06:40' prior: 50527102!
installForDefaultSystem

	"self installForDefaultSystem"
	
	| server port interface |
	
	interface := self on: self defaultSystem.
	
	"Esto es para poder acceder a la interface de manera global - Hernan"
	Smalltalk at: #CurrentTusLibrosRestInterface put: interface.
	
	port := 9999.
	server := WebServer reset default.
	server listenOn: port.
	
	server 
		addService: '/createCart' 
		action: [:request | interface createCart: request] fork.
	server 
		addService: '/addToCart' 
		action: [:request | interface addToCart: request ].
	server
		addService: '/listCart' 
		action: [:request | interface listCart: request ].
	server
		addService: '/checkOutCart' 
		action: [:request | interface checkOutCart: request ].
	server
		addService: '/listPurchases' 
		action: [:request | interface listPurchases: request ].
	server useDebugErrorHandler ! !
!TusLibrosServerRestInterface class methodsFor: 'installation' stamp: 'LDMAF 6/15/2022 18:08:32' prior: 50565595!
installForDefaultSystem

	"self installForDefaultSystem"
	
	| server port interface |
	
	interface := self on: self defaultSystem.
	
	"Esto es para poder acceder a la interface de manera global - Hernan"
	Smalltalk at: #CurrentTusLibrosRestInterface put: interface.
	
	port := 9999.
	server := WebServer reset default.
	server listenOn: port.
	
	server 
		addService: '/createCart' 
		action: [:request | interface createCart: request].
	server 
		addService: '/addToCart' 
		action: [:request | interface addToCart: request ].
	server
		addService: '/listCart' 
		action: [:request | interface listCart: request ].
	server
		addService: '/checkOutCart' 
		action: [:request | interface checkOutCart: request ].
	server
		addService: '/listPurchases' 
		action: [:request | interface listPurchases: request ].
	server useDebugErrorHandler ! !
!TusLibrosClientTestWindowModel methodsFor: 'buttonSelectors' stamp: 'LDMAF 6/15/2022 18:18:26' prior: 50526858!
createCart

	| newCartId |
	
	[newCartId := restInterface createCartFor: 'hernan' password: 'smalltalk'.
	cartIds add: newCartId.
	self triggerEvent: #newCartIdArrived] fork.! !
!TusLibrosClientTestWindowModel methodsFor: 'buttonSelectors' stamp: 'LDMAF 6/15/2022 18:22:21' prior: 50565656!
createCart

	| newCartId |
	
	[newCartId := restInterface createCartFor: 'hernan' password: 'smalltalk'.
	cartIds add: newCartId.
	self triggerEvent: #newCartIdArrived] fork.! !
!TusLibrosClientTestWindowModel methodsFor: 'buttonSelectors' stamp: 'LDMAF 6/15/2022 18:34:11' prior: 50526867!
listCart

	| cartId |
	
	(self isCartIdSelected) ifTrue:[
		[cartId := self selectedCartId.
		currentSelectedCartContent := restInterface listCart: cartId.
		self triggerEvent: #newCurrentSelectedCartContentArrived with: cartId] fork ].! !
!TusLibrosClientTestWindowModel methodsFor: 'threading' stamp: 'LDMAF 6/15/2022 19:11:44'!
runInSecondaryThread: aBlock
	[aBlock value] fork.! !
!TusLibrosClientTestWindowModel methodsFor: 'buttonSelectors' stamp: 'LDMAF 6/15/2022 19:13:09' prior: 50565666!
createCart

	| newCartId |
	self runInSecondaryThread: [
		newCartId := restInterface createCartFor: 'hernan' password: 'smalltalk'.
		cartIds add: newCartId.
		self triggerEvent: #newCartIdArrived].! !
!TusLibrosClientTestWindowModel methodsFor: 'buttonSelectors' stamp: 'LDMAF 6/15/2022 19:14:00' prior: 50565676!
listCart

	| cartId |
	
	(self isCartIdSelected) ifTrue:[
		self runInSecondaryThread: [
				cartId := self selectedCartId.
				currentSelectedCartContent := restInterface listCart: cartId.
				self triggerEvent: #newCurrentSelectedCartContentArrived with: cartId
			]
		].! !

WebServer reset!

WebServer reset!

TusLibrosServerRestInterface installForDefaultSystem!

TusLibrosClientTestWindow open!
!TusLibrosClientTestWindowModel methodsFor: 'buttonSelectors' stamp: 'LDMAF 6/15/2022 19:15:22' prior: 50526845!
addToCart

	| cartId bookIsbn |

	(self areCartIdAndBookSelected) ifTrue:[
		self runInSecondaryThread: [
				cartId := self selectedCartId.
				bookIsbn := self selectedBook.
				restInterface add: 1 of: bookIsbn toCartIdentifiedAs: cartId.
				self triggerEvent: #bookAddedToCart withArguments: (Array with: bookIsbn with: cartId)
			]
		]! !

----SNAPSHOT----(15 June 2022 19:18:28) CuisUniversity-5053.image priorSource: 7484967!

----SNAPSHOT----(15 June 2022 19:33:00) CuisUniversity-5053.image priorSource: 7490648!

Object subclass: #TusLibrosClientRestInterface
	instanceVariableNames: 'port queque'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibrosREST'!

!classDefinition: #TusLibrosClientRestInterface category: 'TusLibrosREST' stamp: 'LDMAF 6/15/2022 19:33:04'!
Object subclass: #TusLibrosClientRestInterface
	instanceVariableNames: 'port queque'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibrosREST'!
!TusLibrosClientRestInterface methodsFor: 'initialization' stamp: 'LDMAF 6/15/2022 19:34:22' overrides: 16920235!
initialize
	queque _ OrderedCollection new.! !

Object subclass: #TusLibrosClientRestInterface
	instanceVariableNames: 'port queue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibrosREST'!

!classDefinition: #TusLibrosClientRestInterface category: 'TusLibrosREST' stamp: 'LDMAF 6/15/2022 19:34:30'!
Object subclass: #TusLibrosClientRestInterface
	instanceVariableNames: 'port queue'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibrosREST'!
!TusLibrosClientRestInterface methodsFor: 'initialization' stamp: 'LDMAF 6/15/2022 19:34:38' prior: 50565754 overrides: 16920235!
initialize
	queue _ OrderedCollection new.! !

----SNAPSHOT----(15 June 2022 19:35:19) CuisUniversity-5053.image priorSource: 7490737!
!TusLibrosClientRestInterface methodsFor: 'initialization' stamp: 'LDMAF 6/15/2022 19:35:23' prior: 50565773 overrides: 16920235!
initialize
	queue _ OrderedCollection new.! !

(OrderedCollection with: 1 with: 2) removeFirst!

a _ (OrderedCollection with: 1 with: 2) !

a _ (OrderedCollection with: 1 with: 2) !

a _ (OrderedCollection with: 1 with: 2) 
a removeFirst!

a _ (OrderedCollection with: 1 with: 2) !

a removeFirst!

a!
!TusLibrosClientRestInterface methodsFor: 'threading' stamp: 'LDMAF 6/15/2022 19:40:28'!
startListeningForRequests
	[[true] whileTrue: [
			queue isNotEmpty: [|nextTask|
					nextTask _ queue removeFirst.
					nextTask value.
				]
		]] fork.! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 19:42:20' prior: 50526732!
createCartFor: aUser password: aPassword

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'clientId'. aUser. 'password'. aPassword}.		
	
	queue add: [resp := WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
		
	resp isSuccess 
		ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream))] 
		ifFalse:[^self error: resp content]]! !
!TusLibrosClientTestWindowModel methodsFor: 'buttonSelectors' stamp: 'NR 6/9/2022 08:13:07' prior: 50565693!
createCart

	| newCartId |
	
	newCartId := restInterface createCartFor: 'hernan' password: 'smalltalk'.
	cartIds add: newCartId.
	self triggerEvent: #newCartIdArrived! !
!TusLibrosClientTestWindowModel methodsFor: 'buttonSelectors' stamp: 'LDMAF 6/15/2022 19:44:24' prior: 50565819!
createCart
	
	restInterface createCartFor: 'hernan' password: 'smalltalk' onSuccess: [:newCartId |
			cartIds add: newCartId.
			self triggerEvent: #newCartIdArrived
		]
	! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 19:46:06'!
createCartFor: aUser password: aPassword onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'clientId'. aUser. 'password'. aPassword}.		
	
	queue add: [
			resp := WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
			aSuccessBlock value:		 (resp isSuccess 
				ifTrue:[^(WebUtils jsonDecode: ((resp content) readStream))] 
				ifFalse:[^self error: resp content])
	]! !
!TusLibrosClientRestInterface methodsFor: 'initialization' stamp: 'LDMAF 6/15/2022 19:46:27' prior: 50565782 overrides: 16920235!
initialize
	queue _ OrderedCollection new.
	self startListeningForRequests.! !

WebServer reset!

TusLibrosServerRestInterface installForDefaultSystem!

TusLibrosClientTestWindow open!
!TusLibrosClientRestInterface methodsFor: 'threading' stamp: 'LDMAF 6/15/2022 19:48:08' prior: 50565795!
startListeningForRequests
	[[true] whileTrue: [
			(queue isEmpty not) ifTrue: [|nextTask|
					nextTask _ queue removeFirst.
					nextTask value.
				]
		]] fork.! !

TusLibrosServerRestInterface installForDefaultSystem!

WebServer reset!

WebServer reset!

TusLibrosServerRestInterface installForDefaultSystem!

TusLibrosServerRestInterface installForDefaultSystem!

TusLibrosClientTestWindow open!
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 19:49:26' prior: 50565804!
createCartFor: aUser password: aPassword

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'clientId'. aUser. 'password'. aPassword}.		
	
	queue add: [resp := WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
		
	resp isSuccess 
		ifTrue:[(WebUtils jsonDecode: ((resp content) readStream))] 
		ifFalse:[self error: resp content]]! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 19:49:41' prior: 50565837!
createCartFor: aUser password: aPassword onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'clientId'. aUser. 'password'. aPassword}.		
	
	queue add: [
			resp := WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
			aSuccessBlock value:		 (resp isSuccess 
				ifTrue:[(WebUtils jsonDecode: ((resp content) readStream))] 
				ifFalse:[self error: resp content])
	]! !

WebServer reset!

WebServer reset!

WebServer reset!

TusLibrosServerRestInterface installForDefaultSystem!

TusLibrosServerRestInterface installForDefaultSystem!

TusLibrosClientTestWindow open!

WebServer reset!

----SNAPSHOT----(15 June 2022 19:52:20) CuisUniversity-5053.image priorSource: 7492045!

----QUIT----(15 June 2022 19:58:28) CuisUniversity-5053.image priorSource: 7496571!

----STARTUP---- (15 June 2022 20:00:52) as C:\Users\andyf\Desktop\windows64\CuisUniversity-5053.image!


Object subclass: #TusLibrosClientRestInterface
	instanceVariableNames: 'port queue isListeningToChanges'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibrosREST'!

!classDefinition: #TusLibrosClientRestInterface category: 'TusLibrosREST' stamp: 'LDMAF 6/15/2022 20:05:58'!
Object subclass: #TusLibrosClientRestInterface
	instanceVariableNames: 'port queue isListeningToChanges'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'TusLibrosREST'!
!TusLibrosClientRestInterface methodsFor: 'initialization' stamp: 'LDMAF 6/15/2022 20:06:16' prior: 50565855 overrides: 16920235!
initialize
	queue _ OrderedCollection new.
	self startListeningForRequests.
	isListeningToChanges _ true.! !
!TusLibrosClientRestInterface methodsFor: 'threading' stamp: 'LDMAF 6/15/2022 20:06:30' prior: 50565865!
startListeningForRequests
	[[false] whileTrue: [
			(queue isEmpty not) ifTrue: [|nextTask|
					nextTask _ queue removeFirst.
					nextTask value.
				]
		]] fork.! !
!TusLibrosClientRestInterface methodsFor: 'threading' stamp: 'LDMAF 6/15/2022 20:07:32' prior: 50565951!
startListeningForRequests
	isListeningToChanges _ true.
	[[isListeningToChanges] whileTrue: [
			(queue isEmpty not) ifTrue: [|nextTask|
					nextTask _ queue removeFirst.
					nextTask value.
				]
		]] fork.! !
!TusLibrosClientRestInterface methodsFor: 'initialization' stamp: 'LDMAF 6/15/2022 20:07:38' prior: 50565944 overrides: 16920235!
initialize
	queue _ OrderedCollection new.
	self startListeningForRequests.
	isListeningToChanges _ false.! !
!TusLibrosClientRestInterface methodsFor: 'threading' stamp: 'LDMAF 6/15/2022 20:07:58'!
stopListeningForRequests
	isListeningToChanges _ false.! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 20:14:33'!
listCart: cartId onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. }.		
	queue add: [
			resp := WebClient htmlSubmit: (self url,'/listCart') fields: fieldDict.
			aSuccessBlock value: (
				resp isSuccess 
						ifTrue: [^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection] 
						ifFalse:[^self error: resp content]
			)
		]
	
		
	! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 20:16:23'!
add: quantity of: bookIsbn toCartIdentifiedAs: cartId onSuccess: aSuccessBlock

	| fieldDict resp |

	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. 'bookIsbn'. bookIsbn. 'bookQuantity'. quantity}.		
		
	queue add: [
			resp := WebClient htmlSubmit: (self url,'/addToCart') fields: fieldDict.
			aSuccessBlock value: (resp isSuccess 
				ifTrue:[(WebUtils jsonDecode: ((resp content) readStream))]
				ifFalse:[self error: resp content])
	].
		
! !

WebServer reset!

WebServer reset!

WebServer reset!
!TusLibrosClientRestInterface methodsFor: 'initialization' stamp: 'LDMAF 6/15/2022 20:16:58' prior: 50565971 overrides: 16920235!
initialize
	queue _ OrderedCollection new.
	self startListeningForRequests.! !
!TusLibrosClientRestInterface methodsFor: 'initialization' stamp: 'LDMAF 6/15/2022 20:17:03' prior: 50566020 overrides: 16920235!
initialize
	queue _ OrderedCollection new.! !

!methodRemoval: TusLibrosClientRestInterface #stopListeningForRequests stamp: 'LDMAF 6/15/2022 20:17:11'!
stopListeningForRequests
	isListeningToChanges _ false.!
!TusLibrosClientRestInterface methodsFor: 'threading' stamp: 'LDMAF 6/15/2022 20:18:02' prior: 50565960!
startListeningForRequests
	[[queue isEmpty not] whileTrue: [|nextTask|
			nextTask _ queue removeFirst.
			nextTask value.
		]] fork.! !
!TusLibrosClientRestInterface methodsFor: 'threading' stamp: 'LDMAF 6/15/2022 20:19:33'!
addTask: aTask
	(queue isEmpty) ifTrue: [
			queue add: aTask.
			self startListeningForRequests.
		] ifFalse: [
			queue add: aTask.
		]
	
	
	! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 20:19:59' prior: 50565999!
add: quantity of: bookIsbn toCartIdentifiedAs: cartId onSuccess: aSuccessBlock

	| fieldDict resp |

	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. 'bookIsbn'. bookIsbn. 'bookQuantity'. quantity}.		
		
	self addTask: [
			resp := WebClient htmlSubmit: (self url,'/addToCart') fields: fieldDict.
			aSuccessBlock value: (resp isSuccess 
				ifTrue:[(WebUtils jsonDecode: ((resp content) readStream))]
				ifFalse:[self error: resp content])
	].
		
! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 20:20:05' prior: 50565896!
createCartFor: aUser password: aPassword onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'clientId'. aUser. 'password'. aPassword}.		
	
	self addTask: [
			resp := WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
			aSuccessBlock value:		 (resp isSuccess 
				ifTrue:[(WebUtils jsonDecode: ((resp content) readStream))] 
				ifFalse:[self error: resp content])
	]! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 20:20:20' prior: 50565983!
listCart: cartId onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. }.		
	self addTask: [
			resp := WebClient htmlSubmit: (self url,'/listCart') fields: fieldDict.
			aSuccessBlock value: (
				resp isSuccess 
						ifTrue: [^(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection] 
						ifFalse:[^self error: resp content]
			)
		]
	
		
	! !

----SNAPSHOT----(15 June 2022 20:20:42) CuisUniversity-5053.image priorSource: 7496660!

----SNAPSHOT----(15 June 2022 20:21:19) CuisUniversity-5053.image priorSource: 7502495!
!TusLibrosClientTestWindowModel methodsFor: 'buttonSelectors' stamp: 'NR 6/13/2022 07:07:36' prior: 50565720!
addToCart

	| cartId bookIsbn |

	(self areCartIdAndBookSelected) ifTrue:[
		cartId := self selectedCartId.
		bookIsbn := self selectedBook.
		restInterface add: 1 of: bookIsbn toCartIdentifiedAs: cartId.
		self triggerEvent: #bookAddedToCart withArguments: (Array with: bookIsbn with: cartId)]! !
!TusLibrosClientTestWindowModel methodsFor: 'buttonSelectors' stamp: 'LDMAF 6/15/2022 20:27:10' prior: 50566110!
addToCart

	| cartId bookIsbn |

	(self areCartIdAndBookSelected) ifTrue:[
		cartId := self selectedCartId.
		bookIsbn := self selectedBook.
		restInterface add: 1 of: bookIsbn toCartIdentifiedAs: cartId onSuccess: [
				self triggerEvent: #bookAddedToCart withArguments: (Array with: bookIsbn with: cartId)
			]
	]! !
!TusLibrosClientTestWindowModel methodsFor: 'buttonSelectors' stamp: 'NR 6/13/2022 07:08:06' prior: 50565703!
listCart

	| cartId |
	
	(self isCartIdSelected) ifTrue:[
		cartId := self selectedCartId.
		currentSelectedCartContent := restInterface listCart: cartId.
		self triggerEvent: #newCurrentSelectedCartContentArrived with: cartId ].! !
!TusLibrosClientTestWindowModel methodsFor: 'buttonSelectors' stamp: 'LDMAF 6/15/2022 20:27:38' prior: 50566137!
listCart

	| cartId |
	
	(self isCartIdSelected) ifTrue:[
		cartId := self selectedCartId.
		currentSelectedCartContent := restInterface listCart: cartId onSuccess: [
			self triggerEvent: #newCurrentSelectedCartContentArrived with: cartId ].
		].! !

----SNAPSHOT----(15 June 2022 20:28:17) CuisUniversity-5053.image priorSource: 7502584!

TusLibrosServerRestInterface installForDefaultSystem!

WebServer reset!

WebServer reset!

TusLibrosServerRestInterface installForDefaultSystem!

TusLibrosClientTestWindow open!
!TusLibrosClientTestWindowModel methodsFor: 'buttonSelectors' stamp: 'LDMAF 6/15/2022 20:31:39' prior: 50566123!
addToCart

	| cartId bookIsbn |

	(self areCartIdAndBookSelected) ifTrue:[
		cartId := self selectedCartId.
		bookIsbn := self selectedBook.
		restInterface add: 1 of: bookIsbn toCartIdentifiedAs: cartId onSuccess: [:response |
				self triggerEvent: #bookAddedToCart withArguments: (Array with: bookIsbn with: cartId)
			]
	]! !
!TusLibrosClientTestWindowModel methodsFor: 'buttonSelectors' stamp: 'LDMAF 6/15/2022 20:32:48' prior: 50566148!
listCart

	| cartId |
	
	(self isCartIdSelected) ifTrue:[
		cartId := self selectedCartId.
		currentSelectedCartContent := restInterface listCart: cartId onSuccess: [
			self triggerEvent: #newCurrentSelectedCartContentArrived with: cartId ].
		].! !
!TusLibrosClientTestWindowModel methodsFor: 'buttonSelectors' stamp: 'LDMAF 6/15/2022 20:33:35' prior: 50566182!
listCart

	| cartId |
	
	(self isCartIdSelected) ifTrue:[
		cartId := self selectedCartId.
		currentSelectedCartContent := restInterface listCart: cartId onSuccess: [:response | 
			self triggerEvent: #newCurrentSelectedCartContentArrived with: cartId ].
		].! !

WebServer reset!

WebServer reset!

TusLibrosServerRestInterface installForDefaultSystem!

TusLibrosServerRestInterface installForDefaultSystem!

TusLibrosClientTestWindow open!
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 20:35:53' prior: 50566088!
listCart: cartId onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. }.		
	self addTask: [
			resp := WebClient htmlSubmit: (self url,'/listCart') fields: fieldDict.
			aSuccessBlock value: (
				resp isSuccess 
						ifTrue: [(WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection] 
						ifFalse:[self error: resp content]
			)
		]
	
		
	! !

WebServer reset!

WebServer reset!

TusLibrosServerRestInterface installForDefaultSystem!

TusLibrosServerRestInterface installForDefaultSystem!

TusLibrosClientTestWindow open!
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 20:37:34' prior: 50566212!
listCart: cartId onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. }.		
	self addTask: [
			resp := WebClient htmlSubmit: (self url,'/listCart') fields: fieldDict.
			aSuccessBlock value: (
				resp isSuccess 
						ifTrue: [((WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection)] 
						ifFalse:[self error: resp content]
			)
		]
	
		
	! !

WebServer reset!

WebServer reset!

TusLibrosServerRestInterface installForDefaultSystem!

TusLibrosClientTestWindow open!

WebServer reset!

WebServer reset!
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 20:40:21' prior: 50566234!
listCart: cartId onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. }.		
	self addTask: [
			resp := WebClient htmlSubmit: (self url,'/listCart') fields: fieldDict.
			aSuccessBlock value: (
				(resp isSuccess) ifTrue: [((WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection)] 
						ifFalse:[self error: resp content]
			)
		]
	
		
	! !

TusLibrosServerRestInterface installForDefaultSystem!

TusLibrosServerRestInterface installForDefaultSystem!

WebServer reset!

WebServer reset!

TusLibrosClientTestWindow open!

TusLibrosServerRestInterface installForDefaultSystem!
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 20:41:48' prior: 50566256!
listCart: cartId onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. }.		
	self addTask: [
			resp := WebClient htmlSubmit: (self url,'/listCart') fields: fieldDict.
			aSuccessBlock value: (((WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection))
		]
	
		
	! !
!TusLibrosServerRestInterface methodsFor: 'rest interface' stamp: 'LDMAF 6/15/2022 20:49:06' prior: 50527013!
listCart: aRequest

	| cartId |

	(Delay forSeconds: 1) wait.
	
	self withFieldsOf: aRequest do: [ :requestFields |
		cartId := self cartIdFrom: requestFields ].
	
	self 
		answer: [(systemFacade listCartIdentifiedAs: cartId) asArray]
		to: aRequest 
! !

WebServer reset!

WebServer reset!

TusLibrosServerRestInterface installForDefaultSystem!

TusLibrosServerRestInterface installForDefaultSystem!

TusLibrosClientTestWindow open!
!TusLibrosClientTestWindowModel methodsFor: 'buttonSelectors' stamp: 'NR 6/13/2022 07:08:06' prior: 50566194!
listCart

	| cartId |
	
	(self isCartIdSelected) ifTrue:[
		cartId := self selectedCartId.
		currentSelectedCartContent := restInterface listCart: cartId.
		self triggerEvent: #newCurrentSelectedCartContentArrived with: cartId ].! !
!TusLibrosClientTestWindowModel methodsFor: 'buttonSelectors' stamp: 'LDMAF 6/15/2022 20:55:47' prior: 50566311!
listCart

	| cartId |
	
	(self isCartIdSelected) ifTrue:[
		cartId := self selectedCartId.
		restInterface listCart: cartId onSuccess: [:response | 
				currentSelectedCartContent _ response.
				self triggerEvent: #newCurrentSelectedCartContentArrived with: cartId		.
			]
		 ].! !

WebServer reset!

WebServer reset!

TusLibrosServerRestInterface installForDefaultSystem!

TusLibrosServerRestInterface installForDefaultSystem!

WebServer reset!

TusLibrosServerRestInterface installForDefaultSystem!

TusLibrosClientTestWindow open!
!TusLibrosServerRestInterface methodsFor: 'rest interface' stamp: 'NR 6/13/2022 07:11:31' prior: 50566294!
listCart: aRequest

	| cartId |

	(Delay forSeconds: 10) wait.
	
	self withFieldsOf: aRequest do: [ :requestFields |
		cartId := self cartIdFrom: requestFields ].
	
	self 
		answer: [(systemFacade listCartIdentifiedAs: cartId) asArray]
		to: aRequest 
! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 20:40:21' prior: 50566280!
listCart: cartId onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. }.		
	self addTask: [
			resp := WebClient htmlSubmit: (self url,'/listCart') fields: fieldDict.
			aSuccessBlock value: (
				(resp isSuccess) ifTrue: [((WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection)] 
						ifFalse:[self error: resp content]
			)
		]
	
		
	! !

WebServer reset!

----QUIT----(15 June 2022 21:05:14) CuisUniversity-5053.image priorSource: 7504250!

----STARTUP---- (15 June 2022 23:11:16) as C:\Users\andyf\Desktop\windows64\CuisUniversity-5053.image!

!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 23:18:15' prior: 50566355!
listCart: cartId onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. }.		
	self addTask: [
			resp := WebClient htmlSubmit: (self url,'/listCart') fields: fieldDict.
			aSuccessBlock value: ((resp isSuccess) 
				ifTrue: [((WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection)] 
				ifFalse:[self error: resp content]
			)
		]
	
		
	! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 23:19:53' prior: 50566071!
createCartFor: aUser password: aPassword onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'clientId'. aUser. 'password'. aPassword}.		
	
	self addTask: [ |path|
			path := '/createCart'.
			resp := WebClient htmlSubmit: (self url,'/createCart') fields: fieldDict.
			aSuccessBlock value:		 (resp isSuccess 
				ifTrue:[(WebUtils jsonDecode: ((resp content) readStream))] 
				ifFalse:[self error: resp content])
	]! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 23:20:20' prior: 50566395!
createCartFor: aUser password: aPassword onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'clientId'. aUser. 'password'. aPassword}.		
	
	self addTask: [ |path|
			path := '/createCart'.
			resp := WebClient htmlSubmit: (self url,path) fields: fieldDict.
			aSuccessBlock value:		 (resp isSuccess 
				ifTrue:[(WebUtils jsonDecode: ((resp content) readStream))] 
				ifFalse:[self error: resp content])
	]! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 23:21:06'!
requestWith: fieldDict from: path

	^ WebClient htmlSubmit: (self url,path) fields: fieldDict! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 23:21:06' prior: 50566413!
createCartFor: aUser password: aPassword onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'clientId'. aUser. 'password'. aPassword}.		
	
	self addTask: [ |path|
			path := '/createCart'.
			resp := self requestWith: fieldDict from: path.
			aSuccessBlock value:		 (resp isSuccess 
				ifTrue:[(WebUtils jsonDecode: ((resp content) readStream))] 
				ifFalse:[self error: resp content])
	]! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 23:21:47' prior: 50566437!
createCartFor: aUser password: aPassword onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'clientId'. aUser. 'password'. aPassword}.		
	
	self addTask: [
			resp := self requestWith: fieldDict from: '/createCart'.
			aSuccessBlock value:		 (resp isSuccess 
				ifTrue:[(WebUtils jsonDecode: ((resp content) readStream))] 
				ifFalse:[self error: resp content])
	]! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 23:25:05'!
whenFetched: resp do: aSuccessBlock

	^ aSuccessBlock value:		 (resp isSuccess 
				ifTrue:[(WebUtils jsonDecode: ((resp content) readStream))] 
				ifFalse:[self error: resp content])! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 23:25:05' prior: 50566454!
createCartFor: aUser password: aPassword onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'clientId'. aUser. 'password'. aPassword}.		
	
	self addTask: [
			resp := self requestWith: fieldDict from: '/createCart'.
			self whenFetched: resp do: aSuccessBlock
	]! !

!testRun: #CartTest #test01NewCartsAreCreatedEmpty stamp: 'LDMAF 6/15/2022 23:25:32'!
PASSED!

!testRun: #CartTest #test02CanNotAddItemsThatDoNotBelongToStore stamp: 'LDMAF 6/15/2022 23:25:32'!
PASSED!

!testRun: #CartTest #test03AfterAddingAnItemTheCartIsNotEmptyAnymore stamp: 'LDMAF 6/15/2022 23:25:32'!
PASSED!

!testRun: #CartTest #test04CanNotAddNonPositiveNumberOfItems stamp: 'LDMAF 6/15/2022 23:25:32'!
PASSED!

!testRun: #CartTest #test05CanNotAddMoreThanOneItemNotSellByTheStore stamp: 'LDMAF 6/15/2022 23:25:32'!
PASSED!

!testRun: #CartTest #test06CartRemembersAddedItems stamp: 'LDMAF 6/15/2022 23:25:32'!
PASSED!

!testRun: #CartTest #test07CartDoesNotHoldNotAddedItems stamp: 'LDMAF 6/15/2022 23:25:32'!
PASSED!

!testRun: #CartTest #test08CartRemembersTheNumberOfAddedItems stamp: 'LDMAF 6/15/2022 23:25:32'!
PASSED!

!testRun: #CashierTest #test01CanNotCheckoutAnEmptyCart stamp: 'LDMAF 6/15/2022 23:25:32'!
PASSED!

!testRun: #CashierTest #test02CalculatedTotalIsCorrect stamp: 'LDMAF 6/15/2022 23:25:32'!
PASSED!

!testRun: #CashierTest #test03CanNotCheckoutWithAnExpiredCreditCart stamp: 'LDMAF 6/15/2022 23:25:32'!
PASSED!

!testRun: #CashierTest #test04CheckoutRegistersASale stamp: 'LDMAF 6/15/2022 23:25:32'!
PASSED!

!testRun: #CashierTest #test05CashierChargesCreditCardUsingMerchantProcessor stamp: 'LDMAF 6/15/2022 23:25:32'!
PASSED!

!testRun: #CashierTest #test06CashierDoesNotSaleWhenTheCreditCardHasNoCredit stamp: 'LDMAF 6/15/2022 23:25:32'!
PASSED!

!testRun: #CreditCardTest #test01CreditCardNumberWithLessThan16DigitsIsNotValid stamp: 'LDMAF 6/15/2022 23:25:32'!
PASSED!

!testRun: #CreditCardTest #test02CreditCardNumberWithMoreThan16DigitsIsNotValid stamp: 'LDMAF 6/15/2022 23:25:32'!
PASSED!

!testRun: #CreditCardTest #test03CreditCardNumberShouldBeDigitsOnly stamp: 'LDMAF 6/15/2022 23:25:32'!
PASSED!

!testRun: #CreditCardTest #test04NameCanNotBeEmpty stamp: 'LDMAF 6/15/2022 23:25:32'!
PASSED!

!testRun: #CreditCardTest #test05IsExpiredOnNextExpirationMonth stamp: 'LDMAF 6/15/2022 23:25:33'!
PASSED!

!testRun: #CreditCardTest #test06IsNotExpiredOnExpirationMonth stamp: 'LDMAF 6/15/2022 23:25:33'!
PASSED!

!testRun: #CreditCardTest #test07CanGetCreditCardInfoFromIt stamp: 'LDMAF 6/15/2022 23:25:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test01CanCreateCartWithValidUserAndPassword stamp: 'LDMAF 6/15/2022 23:25:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test02CanNotCreateCartWithInvalidUser stamp: 'LDMAF 6/15/2022 23:25:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test03CanNotCreateCartWithInvalidPassword stamp: 'LDMAF 6/15/2022 23:25:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test04CanAddItemsToACreatedCart stamp: 'LDMAF 6/15/2022 23:25:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test05CanNotAddItemToNotCreatedCart stamp: 'LDMAF 6/15/2022 23:25:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test06CanNotAddItemNotSellByTheStore stamp: 'LDMAF 6/15/2022 23:25:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test08CanNotListCartOfInvalidCartId stamp: 'LDMAF 6/15/2022 23:25:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test09ListCartReturnsTheRightNumberOfItems stamp: 'LDMAF 6/15/2022 23:25:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10CheckOutReturnsTransactionIdAndImpactsCustomerPurchases stamp: 'LDMAF 6/15/2022 23:25:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test10_1_CanNotCheckoutAnAlreadyCheckedOutCart stamp: 'LDMAF 6/15/2022 23:25:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test11CanNotCheckoutANotCreatedCart stamp: 'LDMAF 6/15/2022 23:25:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test12CanNotCheckoutAnEmptyCart stamp: 'LDMAF 6/15/2022 23:25:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test13CanNotCheckoutWithAnExpiredCreditCard stamp: 'LDMAF 6/15/2022 23:25:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test14ListPurchasesIncludesBoughtItems stamp: 'LDMAF 6/15/2022 23:25:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test15CanNotListPurchasesOfInvalidCustomer stamp: 'LDMAF 6/15/2022 23:25:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test16CanNotListPurchasesOfValidCustomerWithInvalidPassword stamp: 'LDMAF 6/15/2022 23:25:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test17CanNotAddToCartWhenSessionIsExpired stamp: 'LDMAF 6/15/2022 23:25:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test18CanNotListCartWhenSessionIsExpired stamp: 'LDMAF 6/15/2022 23:25:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test19CanNotCheckOutCartWhenSessionIsExpired stamp: 'LDMAF 6/15/2022 23:25:33'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test20BookPerformanceShouldNotTakeTooLong stamp: 'LDMAF 6/15/2022 23:25:34'!
PASSED!

!testRun: #TusLibrosSystemFacadeTest #test21StorePerformanceShouldNotTakeTooLong stamp: 'LDMAF 6/15/2022 23:25:35'!
PASSED!
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 23:26:58' prior: 50566378!
listCart: cartId onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. }.		
	self addTask: [
			resp := self requestWith: fieldDict from: '/listCart'.

			aSuccessBlock value: ((resp isSuccess) 
				ifTrue: [((WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection)] 
				ifFalse:[self error: resp content]
			)
		]
	
		
	! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 23:27:00' prior: 50566645!
listCart: cartId onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. }.		
	self addTask: [
			resp := self requestWith: fieldDict from: '/listCart'.
			aSuccessBlock value: ((resp isSuccess) 
				ifTrue: [((WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection)] 
				ifFalse:[self error: resp content]
			)
		]
	
		
	! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 23:27:49' prior: 50566661!
listCart: cartId onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. }.		
	self addTask: [
			resp := self requestWith: fieldDict from: '/listCart'.
			self whenFetched: resp do: aSuccessBlock.
		]
	
		
	! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 23:29:46' prior: 50566677!
listCart: cartId onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. }.		
	self addTask: [
			resp := (self requestWith: fieldDict from: '/listCart') asOrderedCollection .
			self whenFetched: resp do: aSuccessBlock.
		]
	
		
	! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 23:32:37' prior: 50566689!
listCart: cartId onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. }.		
	self addTask: [
			resp := self requestWith: fieldDict from: '/listCart' .
			self whenFetched: resp do: aSuccessBlock.
		]
	
		
	! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 23:32:43' prior: 50566702!
listCart: cartId onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. }.		
	self addTask: [
			resp := (self requestWith: fieldDict from: '/listCart') asOrderedCollection .
			self whenFetched: resp do: aSuccessBlock.
		]
	
		
	! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 23:33:05' prior: 50566714!
listCart: cartId onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. }.		
	self addTask: [
			resp := self requestWith: fieldDict from: '/listCart'.
			self whenFetched: resp do: aSuccessBlock.
		]
	
		
	! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 20:40:21' prior: 50566727!
listCart: cartId onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. }.		
	self addTask: [
			resp := WebClient htmlSubmit: (self url,'/listCart') fields: fieldDict.
			aSuccessBlock value: (
				(resp isSuccess) ifTrue: [((WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection)] 
						ifFalse:[self error: resp content]
			)
		]
	
		
	! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 23:36:03' prior: 50566739!
listCart: cartId onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. }.		
	self addTask: [
			resp := self requestWith: fieldDict from: '/listCart'.
			aSuccessBlock value: (
				(resp isSuccess) ifTrue: [((WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection)] 
						ifFalse:[self error: resp content]
			)
		]
	
		
	! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 23:36:29' prior: 50566756!
listCart: cartId onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. }.		
	self addTask: [
			resp := self requestWith: fieldDict from: '/listCart'.
			aSuccessBlock value: (
				(resp isSuccess) 
					ifTrue: [((WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection)] 
					ifFalse:[self error: resp content]
			)
		]
	
		
	! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 23:38:49'!
whenFetched: resp doAsCollection: aSuccessBlock

	^ aSuccessBlock value: (
				(resp isSuccess) 
					ifTrue: [((WebUtils jsonDecode: ((resp content) readStream)) asOrderedCollection)] 
					ifFalse:[self error: resp content]
			)! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 23:38:49' prior: 50566772!
listCart: cartId onSuccess: aSuccessBlock

	| fieldDict resp |
	
	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. }.		
	self addTask: [
			resp := self requestWith: fieldDict from: '/listCart'.
			self whenFetched: resp doAsCollection: aSuccessBlock
		]
	
		
	! !
!TusLibrosClientRestInterface methodsFor: 'requests' stamp: 'LDMAF 6/15/2022 23:39:57' prior: 50566053!
add: quantity of: bookIsbn toCartIdentifiedAs: cartId onSuccess: aSuccessBlock

	| fieldDict resp |

	fieldDict := Dictionary newFromPairs: {'cartId'. cartId. 'bookIsbn'. bookIsbn. 'bookQuantity'. quantity}.		
		
	self addTask: [
			resp := self requestWith: fieldDict from: '/addToCart'. 
			self whenFetched: resp do: aSuccessBlock.
	].
		
! !

TusLibrosServerRestInterface installForDefaultSystem!

TusLibrosClientTestWindow open!
!TusLibrosServerRestInterface methodsFor: 'rest interface' stamp: 'LDMAF 6/15/2022 23:45:57' prior: 50566343!
listCart: aRequest

	| cartId |

	(Delay forSeconds: 50) wait.
	
	self withFieldsOf: aRequest do: [ :requestFields |
		cartId := self cartIdFrom: requestFields ].
	
	self 
		answer: [(systemFacade listCartIdentifiedAs: cartId) asArray]
		to: aRequest 
! !
!TusLibrosServerRestInterface methodsFor: 'rest interface' stamp: 'LDMAF 6/15/2022 23:47:11' prior: 50566828!
listCart: aRequest

	| cartId |

	(Delay forSeconds: 10) wait.
	
	self withFieldsOf: aRequest do: [ :requestFields |
		cartId := self cartIdFrom: requestFields ].
	
	self 
		answer: [(systemFacade listCartIdentifiedAs: cartId) asArray]
		to: aRequest 
! !
!TusLibrosServerRestInterface methodsFor: 'rest interface' stamp: 'LDMAF 6/15/2022 23:51:02' prior: 50566840!
listCart: aRequest

	| cartId |

	(Delay forSeconds: 60) wait.
	
	self withFieldsOf: aRequest do: [ :requestFields |
		cartId := self cartIdFrom: requestFields ].
	
	self 
		answer: [(systemFacade listCartIdentifiedAs: cartId) asArray]
		to: aRequest 
! !

WebServer reset!
!TusLibrosClientRestInterface methodsFor: 'threading' stamp: 'LDMAF 6/15/2022 23:59:48' prior: 50566045!
addTask: aTask
	"
	(queue isEmpty) ifTrue: [
			queue add: aTask.
			self startListeningForRequests.
		] ifFalse: [
			queue add: aTask.
		]"
	aTask fork.
	
	
	! !

TusLibrosServerRestInterface installForDefaultSystem!

TusLibrosClientTestWindow open!

----QUIT----(16 June 2022 00:09:57) CuisUniversity-5053.image priorSource: 7511052!